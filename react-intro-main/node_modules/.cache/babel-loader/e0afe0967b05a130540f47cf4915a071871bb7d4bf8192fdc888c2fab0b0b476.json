{"ast":null,"code":"/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n    r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n    d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = this && this.__param || function (paramIndex, decorator) {\n  return function (target, key) {\n    decorator(target, key, paramIndex);\n  };\n};\nimport { registerSingleton } from '../../../../platform/instantiation/common/extensions.js';\nimport { registerThemingParticipant } from '../../../../platform/theme/common/themeService.js';\nimport { editorHoverBorder } from '../../../../platform/theme/common/colorRegistry.js';\nimport { IHoverService } from '../../../../platform/hover/browser/hover.js';\nimport { IContextMenuService } from '../../../../platform/contextview/browser/contextView.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { HoverWidget } from './hoverWidget.js';\nimport { Disposable, DisposableStore, toDisposable } from '../../../../base/common/lifecycle.js';\nimport { addDisposableListener, EventType, getActiveElement, isAncestorOfActiveElement, isAncestor, getWindow, isHTMLElement } from '../../../../base/browser/dom.js';\nimport { IKeybindingService } from '../../../../platform/keybinding/common/keybinding.js';\nimport { StandardKeyboardEvent } from '../../../../base/browser/keyboardEvent.js';\nimport { IAccessibilityService } from '../../../../platform/accessibility/common/accessibility.js';\nimport { ILayoutService } from '../../../../platform/layout/browser/layoutService.js';\nimport { mainWindow } from '../../../../base/browser/window.js';\nimport { ContextViewHandler } from '../../../../platform/contextview/browser/contextViewService.js';\nimport { ManagedHoverWidget } from './updatableHoverWidget.js';\nimport { TimeoutTimer } from '../../../../base/common/async.js';\nlet HoverService = class HoverService extends Disposable {\n  constructor(_instantiationService, contextMenuService, _keybindingService, _layoutService, _accessibilityService) {\n    super();\n    this._instantiationService = _instantiationService;\n    this._keybindingService = _keybindingService;\n    this._layoutService = _layoutService;\n    this._accessibilityService = _accessibilityService;\n    this._managedHovers = new Map();\n    contextMenuService.onDidShowContextMenu(() => this.hideHover());\n    this._contextViewHandler = this._register(new ContextViewHandler(this._layoutService));\n  }\n  showHover(options, focus, skipLastFocusedUpdate) {\n    var _this$_currentHoverOp, _options$persistence, _options$persistence2;\n    if (getHoverOptionsIdentity(this._currentHoverOptions) === getHoverOptionsIdentity(options)) {\n      return undefined;\n    }\n    if (this._currentHover && (_this$_currentHoverOp = this._currentHoverOptions) !== null && _this$_currentHoverOp !== void 0 && (_this$_currentHoverOp = _this$_currentHoverOp.persistence) !== null && _this$_currentHoverOp !== void 0 && _this$_currentHoverOp.sticky) {\n      return undefined;\n    }\n    this._currentHoverOptions = options;\n    this._lastHoverOptions = options;\n    const trapFocus = options.trapFocus || this._accessibilityService.isScreenReaderOptimized();\n    const activeElement = getActiveElement();\n    // HACK, remove this check when #189076 is fixed\n    if (!skipLastFocusedUpdate) {\n      if (trapFocus && activeElement) {\n        if (!activeElement.classList.contains('monaco-hover')) {\n          this._lastFocusedElementBeforeOpen = activeElement;\n        }\n      } else {\n        this._lastFocusedElementBeforeOpen = undefined;\n      }\n    }\n    const hoverDisposables = new DisposableStore();\n    const hover = this._instantiationService.createInstance(HoverWidget, options);\n    if ((_options$persistence = options.persistence) !== null && _options$persistence !== void 0 && _options$persistence.sticky) {\n      hover.isLocked = true;\n    }\n    hover.onDispose(() => {\n      var _this$_currentHover;\n      const hoverWasFocused = ((_this$_currentHover = this._currentHover) === null || _this$_currentHover === void 0 ? void 0 : _this$_currentHover.domNode) && isAncestorOfActiveElement(this._currentHover.domNode);\n      if (hoverWasFocused) {\n        var _this$_lastFocusedEle;\n        // Required to handle cases such as closing the hover with the escape key\n        (_this$_lastFocusedEle = this._lastFocusedElementBeforeOpen) === null || _this$_lastFocusedEle === void 0 || _this$_lastFocusedEle.focus();\n      }\n      // Only clear the current options if it's the current hover, the current options help\n      // reduce flickering when the same hover is shown multiple times\n      if (this._currentHoverOptions === options) {\n        this._currentHoverOptions = undefined;\n      }\n      hoverDisposables.dispose();\n    }, undefined, hoverDisposables);\n    // Set the container explicitly to enable aux window support\n    if (!options.container) {\n      const targetElement = isHTMLElement(options.target) ? options.target : options.target.targetElements[0];\n      options.container = this._layoutService.getContainer(getWindow(targetElement));\n    }\n    this._contextViewHandler.showContextView(new HoverContextViewDelegate(hover, focus), options.container);\n    hover.onRequestLayout(() => this._contextViewHandler.layout(), undefined, hoverDisposables);\n    if ((_options$persistence2 = options.persistence) !== null && _options$persistence2 !== void 0 && _options$persistence2.sticky) {\n      hoverDisposables.add(addDisposableListener(getWindow(options.container).document, EventType.MOUSE_DOWN, e => {\n        if (!isAncestor(e.target, hover.domNode)) {\n          this.doHideHover();\n        }\n      }));\n    } else {\n      if ('targetElements' in options.target) {\n        for (const element of options.target.targetElements) {\n          hoverDisposables.add(addDisposableListener(element, EventType.CLICK, () => this.hideHover()));\n        }\n      } else {\n        hoverDisposables.add(addDisposableListener(options.target, EventType.CLICK, () => this.hideHover()));\n      }\n      const focusedElement = getActiveElement();\n      if (focusedElement) {\n        const focusedElementDocument = getWindow(focusedElement).document;\n        hoverDisposables.add(addDisposableListener(focusedElement, EventType.KEY_DOWN, e => {\n          var _options$persistence3;\n          return this._keyDown(e, hover, !!((_options$persistence3 = options.persistence) !== null && _options$persistence3 !== void 0 && _options$persistence3.hideOnKeyDown));\n        }));\n        hoverDisposables.add(addDisposableListener(focusedElementDocument, EventType.KEY_DOWN, e => {\n          var _options$persistence4;\n          return this._keyDown(e, hover, !!((_options$persistence4 = options.persistence) !== null && _options$persistence4 !== void 0 && _options$persistence4.hideOnKeyDown));\n        }));\n        hoverDisposables.add(addDisposableListener(focusedElement, EventType.KEY_UP, e => this._keyUp(e, hover)));\n        hoverDisposables.add(addDisposableListener(focusedElementDocument, EventType.KEY_UP, e => this._keyUp(e, hover)));\n      }\n    }\n    if ('IntersectionObserver' in mainWindow) {\n      const observer = new IntersectionObserver(e => this._intersectionChange(e, hover), {\n        threshold: 0\n      });\n      const firstTargetElement = 'targetElements' in options.target ? options.target.targetElements[0] : options.target;\n      observer.observe(firstTargetElement);\n      hoverDisposables.add(toDisposable(() => observer.disconnect()));\n    }\n    this._currentHover = hover;\n    return hover;\n  }\n  hideHover() {\n    var _this$_currentHover2;\n    if ((_this$_currentHover2 = this._currentHover) !== null && _this$_currentHover2 !== void 0 && _this$_currentHover2.isLocked || !this._currentHoverOptions) {\n      return;\n    }\n    this.doHideHover();\n  }\n  doHideHover() {\n    this._currentHover = undefined;\n    this._currentHoverOptions = undefined;\n    this._contextViewHandler.hideContextView();\n  }\n  _intersectionChange(entries, hover) {\n    const entry = entries[entries.length - 1];\n    if (!entry.isIntersecting) {\n      hover.dispose();\n    }\n  }\n  showAndFocusLastHover() {\n    if (!this._lastHoverOptions) {\n      return;\n    }\n    this.showHover(this._lastHoverOptions, true, true);\n  }\n  _keyDown(e, hover, hideOnKeyDown) {\n    var _this$_currentHoverOp2;\n    if (e.key === 'Alt') {\n      hover.isLocked = true;\n      return;\n    }\n    const event = new StandardKeyboardEvent(e);\n    const keybinding = this._keybindingService.resolveKeyboardEvent(event);\n    if (keybinding.getSingleModifierDispatchChords().some(value => !!value) || this._keybindingService.softDispatch(event, event.target).kind !== 0 /* ResultKind.NoMatchingKb */) {\n      return;\n    }\n    if (hideOnKeyDown && (!((_this$_currentHoverOp2 = this._currentHoverOptions) !== null && _this$_currentHoverOp2 !== void 0 && _this$_currentHoverOp2.trapFocus) || e.key !== 'Tab')) {\n      var _this$_lastFocusedEle2;\n      this.hideHover();\n      (_this$_lastFocusedEle2 = this._lastFocusedElementBeforeOpen) === null || _this$_lastFocusedEle2 === void 0 || _this$_lastFocusedEle2.focus();\n    }\n  }\n  _keyUp(e, hover) {\n    if (e.key === 'Alt') {\n      hover.isLocked = false;\n      // Hide if alt is released while the mouse is not over hover/target\n      if (!hover.isMouseIn) {\n        var _this$_lastFocusedEle3;\n        this.hideHover();\n        (_this$_lastFocusedEle3 = this._lastFocusedElementBeforeOpen) === null || _this$_lastFocusedEle3 === void 0 || _this$_lastFocusedEle3.focus();\n      }\n    }\n  }\n  // TODO: Investigate performance of this function. There seems to be a lot of content created\n  //       and thrown away on start up\n  setupManagedHover(hoverDelegate, targetElement, content, options) {\n    targetElement.setAttribute('custom-hover', 'true');\n    if (targetElement.title !== '') {\n      console.warn('HTML element already has a title attribute, which will conflict with the custom hover. Please remove the title attribute.');\n      console.trace('Stack trace:', targetElement.title);\n      targetElement.title = '';\n    }\n    let hoverPreparation;\n    let hoverWidget;\n    const hideHover = (disposeWidget, disposePreparation) => {\n      const hadHover = hoverWidget !== undefined;\n      if (disposeWidget) {\n        var _hoverWidget;\n        (_hoverWidget = hoverWidget) === null || _hoverWidget === void 0 || _hoverWidget.dispose();\n        hoverWidget = undefined;\n      }\n      if (disposePreparation) {\n        var _hoverPreparation;\n        (_hoverPreparation = hoverPreparation) === null || _hoverPreparation === void 0 || _hoverPreparation.dispose();\n        hoverPreparation = undefined;\n      }\n      if (hadHover) {\n        var _hoverDelegate$onDidH;\n        (_hoverDelegate$onDidH = hoverDelegate.onDidHideHover) === null || _hoverDelegate$onDidH === void 0 || _hoverDelegate$onDidH.call(hoverDelegate);\n        hoverWidget = undefined;\n      }\n    };\n    const triggerShowHover = (delay, focus, target, trapFocus) => {\n      return new TimeoutTimer(async () => {\n        if (!hoverWidget || hoverWidget.isDisposed) {\n          hoverWidget = new ManagedHoverWidget(hoverDelegate, target || targetElement, delay > 0);\n          await hoverWidget.update(typeof content === 'function' ? content() : content, focus, {\n            ...options,\n            trapFocus\n          });\n        }\n      }, delay);\n    };\n    let isMouseDown = false;\n    const mouseDownEmitter = addDisposableListener(targetElement, EventType.MOUSE_DOWN, () => {\n      isMouseDown = true;\n      hideHover(true, true);\n    }, true);\n    const mouseUpEmitter = addDisposableListener(targetElement, EventType.MOUSE_UP, () => {\n      isMouseDown = false;\n    }, true);\n    const mouseLeaveEmitter = addDisposableListener(targetElement, EventType.MOUSE_LEAVE, e => {\n      isMouseDown = false;\n      hideHover(false, e.fromElement === targetElement);\n    }, true);\n    const onMouseOver = e => {\n      if (hoverPreparation) {\n        return;\n      }\n      const toDispose = new DisposableStore();\n      const target = {\n        targetElements: [targetElement],\n        dispose: () => {}\n      };\n      if (hoverDelegate.placement === undefined || hoverDelegate.placement === 'mouse') {\n        // track the mouse position\n        const onMouseMove = e => {\n          target.x = e.x + 10;\n          if (isHTMLElement(e.target) && getHoverTargetElement(e.target, targetElement) !== targetElement) {\n            hideHover(true, true);\n          }\n        };\n        toDispose.add(addDisposableListener(targetElement, EventType.MOUSE_MOVE, onMouseMove, true));\n      }\n      hoverPreparation = toDispose;\n      if (isHTMLElement(e.target) && getHoverTargetElement(e.target, targetElement) !== targetElement) {\n        return; // Do not show hover when the mouse is over another hover target\n      }\n      toDispose.add(triggerShowHover(hoverDelegate.delay, false, target));\n    };\n    const mouseOverDomEmitter = addDisposableListener(targetElement, EventType.MOUSE_OVER, onMouseOver, true);\n    const onFocus = () => {\n      if (isMouseDown || hoverPreparation) {\n        return;\n      }\n      const target = {\n        targetElements: [targetElement],\n        dispose: () => {}\n      };\n      const toDispose = new DisposableStore();\n      const onBlur = () => hideHover(true, true);\n      toDispose.add(addDisposableListener(targetElement, EventType.BLUR, onBlur, true));\n      toDispose.add(triggerShowHover(hoverDelegate.delay, false, target));\n      hoverPreparation = toDispose;\n    };\n    // Do not show hover when focusing an input or textarea\n    let focusDomEmitter;\n    const tagName = targetElement.tagName.toLowerCase();\n    if (tagName !== 'input' && tagName !== 'textarea') {\n      focusDomEmitter = addDisposableListener(targetElement, EventType.FOCUS, onFocus, true);\n    }\n    const hover = {\n      show: focus => {\n        hideHover(false, true); // terminate a ongoing mouse over preparation\n        triggerShowHover(0, focus, undefined, focus); // show hover immediately\n      },\n      hide: () => {\n        hideHover(true, true);\n      },\n      update: async (newContent, hoverOptions) => {\n        var _hoverWidget2;\n        content = newContent;\n        await ((_hoverWidget2 = hoverWidget) === null || _hoverWidget2 === void 0 ? void 0 : _hoverWidget2.update(content, undefined, hoverOptions));\n      },\n      dispose: () => {\n        var _focusDomEmitter;\n        this._managedHovers.delete(targetElement);\n        mouseOverDomEmitter.dispose();\n        mouseLeaveEmitter.dispose();\n        mouseDownEmitter.dispose();\n        mouseUpEmitter.dispose();\n        (_focusDomEmitter = focusDomEmitter) === null || _focusDomEmitter === void 0 || _focusDomEmitter.dispose();\n        hideHover(true, true);\n      }\n    };\n    this._managedHovers.set(targetElement, hover);\n    return hover;\n  }\n  showManagedHover(target) {\n    const hover = this._managedHovers.get(target);\n    if (hover) {\n      hover.show(true);\n    }\n  }\n  dispose() {\n    this._managedHovers.forEach(hover => hover.dispose());\n    super.dispose();\n  }\n};\nHoverService = __decorate([__param(0, IInstantiationService), __param(1, IContextMenuService), __param(2, IKeybindingService), __param(3, ILayoutService), __param(4, IAccessibilityService)], HoverService);\nexport { HoverService };\nfunction getHoverOptionsIdentity(options) {\n  var _options$id;\n  if (options === undefined) {\n    return undefined;\n  }\n  return (_options$id = options === null || options === void 0 ? void 0 : options.id) !== null && _options$id !== void 0 ? _options$id : options;\n}\nclass HoverContextViewDelegate {\n  get anchorPosition() {\n    return this._hover.anchor;\n  }\n  constructor(_hover) {\n    let _focus = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n    this._hover = _hover;\n    this._focus = _focus;\n    // Render over all other context views\n    this.layer = 1;\n  }\n  render(container) {\n    this._hover.render(container);\n    if (this._focus) {\n      this._hover.focus();\n    }\n    return this._hover;\n  }\n  getAnchor() {\n    return {\n      x: this._hover.x,\n      y: this._hover.y\n    };\n  }\n  layout() {\n    this._hover.layout();\n  }\n}\nfunction getHoverTargetElement(element, stopElement) {\n  var _stopElement;\n  stopElement = (_stopElement = stopElement) !== null && _stopElement !== void 0 ? _stopElement : getWindow(element).document.body;\n  while (!element.hasAttribute('custom-hover') && element !== stopElement) {\n    element = element.parentElement;\n  }\n  return element;\n}\nregisterSingleton(IHoverService, HoverService, 1 /* InstantiationType.Delayed */);\nregisterThemingParticipant((theme, collector) => {\n  const hoverBorder = theme.getColor(editorHoverBorder);\n  if (hoverBorder) {\n    collector.addRule(\".monaco-workbench .workbench-hover .hover-row:not(:first-child):not(:empty) { border-top: 1px solid \".concat(hoverBorder.transparent(0.5), \"; }\"));\n    collector.addRule(\".monaco-workbench .workbench-hover hr { border-top: 1px solid \".concat(hoverBorder.transparent(0.5), \"; }\"));\n  }\n});","map":{"version":3,"names":["__decorate","decorators","target","key","desc","c","arguments","length","r","Object","getOwnPropertyDescriptor","d","Reflect","decorate","i","defineProperty","__param","paramIndex","decorator","registerSingleton","registerThemingParticipant","editorHoverBorder","IHoverService","IContextMenuService","IInstantiationService","HoverWidget","Disposable","DisposableStore","toDisposable","addDisposableListener","EventType","getActiveElement","isAncestorOfActiveElement","isAncestor","getWindow","isHTMLElement","IKeybindingService","StandardKeyboardEvent","IAccessibilityService","ILayoutService","mainWindow","ContextViewHandler","ManagedHoverWidget","TimeoutTimer","HoverService","constructor","_instantiationService","contextMenuService","_keybindingService","_layoutService","_accessibilityService","_managedHovers","Map","onDidShowContextMenu","hideHover","_contextViewHandler","_register","showHover","options","focus","skipLastFocusedUpdate","_this$_currentHoverOp","_options$persistence","_options$persistence2","getHoverOptionsIdentity","_currentHoverOptions","undefined","_currentHover","persistence","sticky","_lastHoverOptions","trapFocus","isScreenReaderOptimized","activeElement","classList","contains","_lastFocusedElementBeforeOpen","hoverDisposables","hover","createInstance","isLocked","onDispose","_this$_currentHover","hoverWasFocused","domNode","_this$_lastFocusedEle","dispose","container","targetElement","targetElements","getContainer","showContextView","HoverContextViewDelegate","onRequestLayout","layout","add","document","MOUSE_DOWN","e","doHideHover","element","CLICK","focusedElement","focusedElementDocument","KEY_DOWN","_options$persistence3","_keyDown","hideOnKeyDown","_options$persistence4","KEY_UP","_keyUp","observer","IntersectionObserver","_intersectionChange","threshold","firstTargetElement","observe","disconnect","_this$_currentHover2","hideContextView","entries","entry","isIntersecting","showAndFocusLastHover","_this$_currentHoverOp2","event","keybinding","resolveKeyboardEvent","getSingleModifierDispatchChords","some","value","softDispatch","kind","_this$_lastFocusedEle2","isMouseIn","_this$_lastFocusedEle3","setupManagedHover","hoverDelegate","content","setAttribute","title","console","warn","trace","hoverPreparation","hoverWidget","disposeWidget","disposePreparation","hadHover","_hoverWidget","_hoverPreparation","_hoverDelegate$onDidH","onDidHideHover","call","triggerShowHover","delay","isDisposed","update","isMouseDown","mouseDownEmitter","mouseUpEmitter","MOUSE_UP","mouseLeaveEmitter","MOUSE_LEAVE","fromElement","onMouseOver","toDispose","placement","onMouseMove","x","getHoverTargetElement","MOUSE_MOVE","mouseOverDomEmitter","MOUSE_OVER","onFocus","onBlur","BLUR","focusDomEmitter","tagName","toLowerCase","FOCUS","show","hide","newContent","hoverOptions","_hoverWidget2","_focusDomEmitter","delete","set","showManagedHover","get","forEach","_options$id","id","anchorPosition","_hover","anchor","_focus","layer","render","getAnchor","y","stopElement","_stopElement","body","hasAttribute","parentElement","theme","collector","hoverBorder","getColor","addRule","concat","transparent"],"sources":["D:/ospanel/domains/react/react-intro-main/node_modules/monaco-editor/esm/vs/editor/browser/services/hoverService/hoverService.js"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { registerSingleton } from '../../../../platform/instantiation/common/extensions.js';\nimport { registerThemingParticipant } from '../../../../platform/theme/common/themeService.js';\nimport { editorHoverBorder } from '../../../../platform/theme/common/colorRegistry.js';\nimport { IHoverService } from '../../../../platform/hover/browser/hover.js';\nimport { IContextMenuService } from '../../../../platform/contextview/browser/contextView.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { HoverWidget } from './hoverWidget.js';\nimport { Disposable, DisposableStore, toDisposable } from '../../../../base/common/lifecycle.js';\nimport { addDisposableListener, EventType, getActiveElement, isAncestorOfActiveElement, isAncestor, getWindow, isHTMLElement } from '../../../../base/browser/dom.js';\nimport { IKeybindingService } from '../../../../platform/keybinding/common/keybinding.js';\nimport { StandardKeyboardEvent } from '../../../../base/browser/keyboardEvent.js';\nimport { IAccessibilityService } from '../../../../platform/accessibility/common/accessibility.js';\nimport { ILayoutService } from '../../../../platform/layout/browser/layoutService.js';\nimport { mainWindow } from '../../../../base/browser/window.js';\nimport { ContextViewHandler } from '../../../../platform/contextview/browser/contextViewService.js';\nimport { ManagedHoverWidget } from './updatableHoverWidget.js';\nimport { TimeoutTimer } from '../../../../base/common/async.js';\nlet HoverService = class HoverService extends Disposable {\n    constructor(_instantiationService, contextMenuService, _keybindingService, _layoutService, _accessibilityService) {\n        super();\n        this._instantiationService = _instantiationService;\n        this._keybindingService = _keybindingService;\n        this._layoutService = _layoutService;\n        this._accessibilityService = _accessibilityService;\n        this._managedHovers = new Map();\n        contextMenuService.onDidShowContextMenu(() => this.hideHover());\n        this._contextViewHandler = this._register(new ContextViewHandler(this._layoutService));\n    }\n    showHover(options, focus, skipLastFocusedUpdate) {\n        if (getHoverOptionsIdentity(this._currentHoverOptions) === getHoverOptionsIdentity(options)) {\n            return undefined;\n        }\n        if (this._currentHover && this._currentHoverOptions?.persistence?.sticky) {\n            return undefined;\n        }\n        this._currentHoverOptions = options;\n        this._lastHoverOptions = options;\n        const trapFocus = options.trapFocus || this._accessibilityService.isScreenReaderOptimized();\n        const activeElement = getActiveElement();\n        // HACK, remove this check when #189076 is fixed\n        if (!skipLastFocusedUpdate) {\n            if (trapFocus && activeElement) {\n                if (!activeElement.classList.contains('monaco-hover')) {\n                    this._lastFocusedElementBeforeOpen = activeElement;\n                }\n            }\n            else {\n                this._lastFocusedElementBeforeOpen = undefined;\n            }\n        }\n        const hoverDisposables = new DisposableStore();\n        const hover = this._instantiationService.createInstance(HoverWidget, options);\n        if (options.persistence?.sticky) {\n            hover.isLocked = true;\n        }\n        hover.onDispose(() => {\n            const hoverWasFocused = this._currentHover?.domNode && isAncestorOfActiveElement(this._currentHover.domNode);\n            if (hoverWasFocused) {\n                // Required to handle cases such as closing the hover with the escape key\n                this._lastFocusedElementBeforeOpen?.focus();\n            }\n            // Only clear the current options if it's the current hover, the current options help\n            // reduce flickering when the same hover is shown multiple times\n            if (this._currentHoverOptions === options) {\n                this._currentHoverOptions = undefined;\n            }\n            hoverDisposables.dispose();\n        }, undefined, hoverDisposables);\n        // Set the container explicitly to enable aux window support\n        if (!options.container) {\n            const targetElement = isHTMLElement(options.target) ? options.target : options.target.targetElements[0];\n            options.container = this._layoutService.getContainer(getWindow(targetElement));\n        }\n        this._contextViewHandler.showContextView(new HoverContextViewDelegate(hover, focus), options.container);\n        hover.onRequestLayout(() => this._contextViewHandler.layout(), undefined, hoverDisposables);\n        if (options.persistence?.sticky) {\n            hoverDisposables.add(addDisposableListener(getWindow(options.container).document, EventType.MOUSE_DOWN, e => {\n                if (!isAncestor(e.target, hover.domNode)) {\n                    this.doHideHover();\n                }\n            }));\n        }\n        else {\n            if ('targetElements' in options.target) {\n                for (const element of options.target.targetElements) {\n                    hoverDisposables.add(addDisposableListener(element, EventType.CLICK, () => this.hideHover()));\n                }\n            }\n            else {\n                hoverDisposables.add(addDisposableListener(options.target, EventType.CLICK, () => this.hideHover()));\n            }\n            const focusedElement = getActiveElement();\n            if (focusedElement) {\n                const focusedElementDocument = getWindow(focusedElement).document;\n                hoverDisposables.add(addDisposableListener(focusedElement, EventType.KEY_DOWN, e => this._keyDown(e, hover, !!options.persistence?.hideOnKeyDown)));\n                hoverDisposables.add(addDisposableListener(focusedElementDocument, EventType.KEY_DOWN, e => this._keyDown(e, hover, !!options.persistence?.hideOnKeyDown)));\n                hoverDisposables.add(addDisposableListener(focusedElement, EventType.KEY_UP, e => this._keyUp(e, hover)));\n                hoverDisposables.add(addDisposableListener(focusedElementDocument, EventType.KEY_UP, e => this._keyUp(e, hover)));\n            }\n        }\n        if ('IntersectionObserver' in mainWindow) {\n            const observer = new IntersectionObserver(e => this._intersectionChange(e, hover), { threshold: 0 });\n            const firstTargetElement = 'targetElements' in options.target ? options.target.targetElements[0] : options.target;\n            observer.observe(firstTargetElement);\n            hoverDisposables.add(toDisposable(() => observer.disconnect()));\n        }\n        this._currentHover = hover;\n        return hover;\n    }\n    hideHover() {\n        if (this._currentHover?.isLocked || !this._currentHoverOptions) {\n            return;\n        }\n        this.doHideHover();\n    }\n    doHideHover() {\n        this._currentHover = undefined;\n        this._currentHoverOptions = undefined;\n        this._contextViewHandler.hideContextView();\n    }\n    _intersectionChange(entries, hover) {\n        const entry = entries[entries.length - 1];\n        if (!entry.isIntersecting) {\n            hover.dispose();\n        }\n    }\n    showAndFocusLastHover() {\n        if (!this._lastHoverOptions) {\n            return;\n        }\n        this.showHover(this._lastHoverOptions, true, true);\n    }\n    _keyDown(e, hover, hideOnKeyDown) {\n        if (e.key === 'Alt') {\n            hover.isLocked = true;\n            return;\n        }\n        const event = new StandardKeyboardEvent(e);\n        const keybinding = this._keybindingService.resolveKeyboardEvent(event);\n        if (keybinding.getSingleModifierDispatchChords().some(value => !!value) || this._keybindingService.softDispatch(event, event.target).kind !== 0 /* ResultKind.NoMatchingKb */) {\n            return;\n        }\n        if (hideOnKeyDown && (!this._currentHoverOptions?.trapFocus || e.key !== 'Tab')) {\n            this.hideHover();\n            this._lastFocusedElementBeforeOpen?.focus();\n        }\n    }\n    _keyUp(e, hover) {\n        if (e.key === 'Alt') {\n            hover.isLocked = false;\n            // Hide if alt is released while the mouse is not over hover/target\n            if (!hover.isMouseIn) {\n                this.hideHover();\n                this._lastFocusedElementBeforeOpen?.focus();\n            }\n        }\n    }\n    // TODO: Investigate performance of this function. There seems to be a lot of content created\n    //       and thrown away on start up\n    setupManagedHover(hoverDelegate, targetElement, content, options) {\n        targetElement.setAttribute('custom-hover', 'true');\n        if (targetElement.title !== '') {\n            console.warn('HTML element already has a title attribute, which will conflict with the custom hover. Please remove the title attribute.');\n            console.trace('Stack trace:', targetElement.title);\n            targetElement.title = '';\n        }\n        let hoverPreparation;\n        let hoverWidget;\n        const hideHover = (disposeWidget, disposePreparation) => {\n            const hadHover = hoverWidget !== undefined;\n            if (disposeWidget) {\n                hoverWidget?.dispose();\n                hoverWidget = undefined;\n            }\n            if (disposePreparation) {\n                hoverPreparation?.dispose();\n                hoverPreparation = undefined;\n            }\n            if (hadHover) {\n                hoverDelegate.onDidHideHover?.();\n                hoverWidget = undefined;\n            }\n        };\n        const triggerShowHover = (delay, focus, target, trapFocus) => {\n            return new TimeoutTimer(async () => {\n                if (!hoverWidget || hoverWidget.isDisposed) {\n                    hoverWidget = new ManagedHoverWidget(hoverDelegate, target || targetElement, delay > 0);\n                    await hoverWidget.update(typeof content === 'function' ? content() : content, focus, { ...options, trapFocus });\n                }\n            }, delay);\n        };\n        let isMouseDown = false;\n        const mouseDownEmitter = addDisposableListener(targetElement, EventType.MOUSE_DOWN, () => {\n            isMouseDown = true;\n            hideHover(true, true);\n        }, true);\n        const mouseUpEmitter = addDisposableListener(targetElement, EventType.MOUSE_UP, () => {\n            isMouseDown = false;\n        }, true);\n        const mouseLeaveEmitter = addDisposableListener(targetElement, EventType.MOUSE_LEAVE, (e) => {\n            isMouseDown = false;\n            hideHover(false, e.fromElement === targetElement);\n        }, true);\n        const onMouseOver = (e) => {\n            if (hoverPreparation) {\n                return;\n            }\n            const toDispose = new DisposableStore();\n            const target = {\n                targetElements: [targetElement],\n                dispose: () => { }\n            };\n            if (hoverDelegate.placement === undefined || hoverDelegate.placement === 'mouse') {\n                // track the mouse position\n                const onMouseMove = (e) => {\n                    target.x = e.x + 10;\n                    if ((isHTMLElement(e.target)) && getHoverTargetElement(e.target, targetElement) !== targetElement) {\n                        hideHover(true, true);\n                    }\n                };\n                toDispose.add(addDisposableListener(targetElement, EventType.MOUSE_MOVE, onMouseMove, true));\n            }\n            hoverPreparation = toDispose;\n            if ((isHTMLElement(e.target)) && getHoverTargetElement(e.target, targetElement) !== targetElement) {\n                return; // Do not show hover when the mouse is over another hover target\n            }\n            toDispose.add(triggerShowHover(hoverDelegate.delay, false, target));\n        };\n        const mouseOverDomEmitter = addDisposableListener(targetElement, EventType.MOUSE_OVER, onMouseOver, true);\n        const onFocus = () => {\n            if (isMouseDown || hoverPreparation) {\n                return;\n            }\n            const target = {\n                targetElements: [targetElement],\n                dispose: () => { }\n            };\n            const toDispose = new DisposableStore();\n            const onBlur = () => hideHover(true, true);\n            toDispose.add(addDisposableListener(targetElement, EventType.BLUR, onBlur, true));\n            toDispose.add(triggerShowHover(hoverDelegate.delay, false, target));\n            hoverPreparation = toDispose;\n        };\n        // Do not show hover when focusing an input or textarea\n        let focusDomEmitter;\n        const tagName = targetElement.tagName.toLowerCase();\n        if (tagName !== 'input' && tagName !== 'textarea') {\n            focusDomEmitter = addDisposableListener(targetElement, EventType.FOCUS, onFocus, true);\n        }\n        const hover = {\n            show: focus => {\n                hideHover(false, true); // terminate a ongoing mouse over preparation\n                triggerShowHover(0, focus, undefined, focus); // show hover immediately\n            },\n            hide: () => {\n                hideHover(true, true);\n            },\n            update: async (newContent, hoverOptions) => {\n                content = newContent;\n                await hoverWidget?.update(content, undefined, hoverOptions);\n            },\n            dispose: () => {\n                this._managedHovers.delete(targetElement);\n                mouseOverDomEmitter.dispose();\n                mouseLeaveEmitter.dispose();\n                mouseDownEmitter.dispose();\n                mouseUpEmitter.dispose();\n                focusDomEmitter?.dispose();\n                hideHover(true, true);\n            }\n        };\n        this._managedHovers.set(targetElement, hover);\n        return hover;\n    }\n    showManagedHover(target) {\n        const hover = this._managedHovers.get(target);\n        if (hover) {\n            hover.show(true);\n        }\n    }\n    dispose() {\n        this._managedHovers.forEach(hover => hover.dispose());\n        super.dispose();\n    }\n};\nHoverService = __decorate([\n    __param(0, IInstantiationService),\n    __param(1, IContextMenuService),\n    __param(2, IKeybindingService),\n    __param(3, ILayoutService),\n    __param(4, IAccessibilityService)\n], HoverService);\nexport { HoverService };\nfunction getHoverOptionsIdentity(options) {\n    if (options === undefined) {\n        return undefined;\n    }\n    return options?.id ?? options;\n}\nclass HoverContextViewDelegate {\n    get anchorPosition() {\n        return this._hover.anchor;\n    }\n    constructor(_hover, _focus = false) {\n        this._hover = _hover;\n        this._focus = _focus;\n        // Render over all other context views\n        this.layer = 1;\n    }\n    render(container) {\n        this._hover.render(container);\n        if (this._focus) {\n            this._hover.focus();\n        }\n        return this._hover;\n    }\n    getAnchor() {\n        return {\n            x: this._hover.x,\n            y: this._hover.y\n        };\n    }\n    layout() {\n        this._hover.layout();\n    }\n}\nfunction getHoverTargetElement(element, stopElement) {\n    stopElement = stopElement ?? getWindow(element).document.body;\n    while (!element.hasAttribute('custom-hover') && element !== stopElement) {\n        element = element.parentElement;\n    }\n    return element;\n}\nregisterSingleton(IHoverService, HoverService, 1 /* InstantiationType.Delayed */);\nregisterThemingParticipant((theme, collector) => {\n    const hoverBorder = theme.getColor(editorHoverBorder);\n    if (hoverBorder) {\n        collector.addRule(`.monaco-workbench .workbench-hover .hover-row:not(:first-child):not(:empty) { border-top: 1px solid ${hoverBorder.transparent(0.5)}; }`);\n        collector.addRule(`.monaco-workbench .workbench-hover hr { border-top: 1px solid ${hoverBorder.transparent(0.5)}; }`);\n    }\n});\n"],"mappings":"AAAA;AACA;AACA;AACA;AACA,IAAIA,UAAU,GAAI,IAAI,IAAI,IAAI,CAACA,UAAU,IAAK,UAAUC,UAAU,EAAEC,MAAM,EAAEC,GAAG,EAAEC,IAAI,EAAE;EACnF,IAAIC,CAAC,GAAGC,SAAS,CAACC,MAAM;IAAEC,CAAC,GAAGH,CAAC,GAAG,CAAC,GAAGH,MAAM,GAAGE,IAAI,KAAK,IAAI,GAAGA,IAAI,GAAGK,MAAM,CAACC,wBAAwB,CAACR,MAAM,EAAEC,GAAG,CAAC,GAAGC,IAAI;IAAEO,CAAC;EAC5H,IAAI,OAAOC,OAAO,KAAK,QAAQ,IAAI,OAAOA,OAAO,CAACC,QAAQ,KAAK,UAAU,EAAEL,CAAC,GAAGI,OAAO,CAACC,QAAQ,CAACZ,UAAU,EAAEC,MAAM,EAAEC,GAAG,EAAEC,IAAI,CAAC,CAAC,KAC1H,KAAK,IAAIU,CAAC,GAAGb,UAAU,CAACM,MAAM,GAAG,CAAC,EAAEO,CAAC,IAAI,CAAC,EAAEA,CAAC,EAAE,EAAE,IAAIH,CAAC,GAAGV,UAAU,CAACa,CAAC,CAAC,EAAEN,CAAC,GAAG,CAACH,CAAC,GAAG,CAAC,GAAGM,CAAC,CAACH,CAAC,CAAC,GAAGH,CAAC,GAAG,CAAC,GAAGM,CAAC,CAACT,MAAM,EAAEC,GAAG,EAAEK,CAAC,CAAC,GAAGG,CAAC,CAACT,MAAM,EAAEC,GAAG,CAAC,KAAKK,CAAC;EACjJ,OAAOH,CAAC,GAAG,CAAC,IAAIG,CAAC,IAAIC,MAAM,CAACM,cAAc,CAACb,MAAM,EAAEC,GAAG,EAAEK,CAAC,CAAC,EAAEA,CAAC;AACjE,CAAC;AACD,IAAIQ,OAAO,GAAI,IAAI,IAAI,IAAI,CAACA,OAAO,IAAK,UAAUC,UAAU,EAAEC,SAAS,EAAE;EACrE,OAAO,UAAUhB,MAAM,EAAEC,GAAG,EAAE;IAAEe,SAAS,CAAChB,MAAM,EAAEC,GAAG,EAAEc,UAAU,CAAC;EAAE,CAAC;AACzE,CAAC;AACD,SAASE,iBAAiB,QAAQ,yDAAyD;AAC3F,SAASC,0BAA0B,QAAQ,mDAAmD;AAC9F,SAASC,iBAAiB,QAAQ,oDAAoD;AACtF,SAASC,aAAa,QAAQ,6CAA6C;AAC3E,SAASC,mBAAmB,QAAQ,yDAAyD;AAC7F,SAASC,qBAAqB,QAAQ,4DAA4D;AAClG,SAASC,WAAW,QAAQ,kBAAkB;AAC9C,SAASC,UAAU,EAAEC,eAAe,EAAEC,YAAY,QAAQ,sCAAsC;AAChG,SAASC,qBAAqB,EAAEC,SAAS,EAAEC,gBAAgB,EAAEC,yBAAyB,EAAEC,UAAU,EAAEC,SAAS,EAAEC,aAAa,QAAQ,iCAAiC;AACrK,SAASC,kBAAkB,QAAQ,sDAAsD;AACzF,SAASC,qBAAqB,QAAQ,2CAA2C;AACjF,SAASC,qBAAqB,QAAQ,4DAA4D;AAClG,SAASC,cAAc,QAAQ,sDAAsD;AACrF,SAASC,UAAU,QAAQ,oCAAoC;AAC/D,SAASC,kBAAkB,QAAQ,gEAAgE;AACnG,SAASC,kBAAkB,QAAQ,2BAA2B;AAC9D,SAASC,YAAY,QAAQ,kCAAkC;AAC/D,IAAIC,YAAY,GAAG,MAAMA,YAAY,SAASlB,UAAU,CAAC;EACrDmB,WAAWA,CAACC,qBAAqB,EAAEC,kBAAkB,EAAEC,kBAAkB,EAAEC,cAAc,EAAEC,qBAAqB,EAAE;IAC9G,KAAK,CAAC,CAAC;IACP,IAAI,CAACJ,qBAAqB,GAAGA,qBAAqB;IAClD,IAAI,CAACE,kBAAkB,GAAGA,kBAAkB;IAC5C,IAAI,CAACC,cAAc,GAAGA,cAAc;IACpC,IAAI,CAACC,qBAAqB,GAAGA,qBAAqB;IAClD,IAAI,CAACC,cAAc,GAAG,IAAIC,GAAG,CAAC,CAAC;IAC/BL,kBAAkB,CAACM,oBAAoB,CAAC,MAAM,IAAI,CAACC,SAAS,CAAC,CAAC,CAAC;IAC/D,IAAI,CAACC,mBAAmB,GAAG,IAAI,CAACC,SAAS,CAAC,IAAIf,kBAAkB,CAAC,IAAI,CAACQ,cAAc,CAAC,CAAC;EAC1F;EACAQ,SAASA,CAACC,OAAO,EAAEC,KAAK,EAAEC,qBAAqB,EAAE;IAAA,IAAAC,qBAAA,EAAAC,oBAAA,EAAAC,qBAAA;IAC7C,IAAIC,uBAAuB,CAAC,IAAI,CAACC,oBAAoB,CAAC,KAAKD,uBAAuB,CAACN,OAAO,CAAC,EAAE;MACzF,OAAOQ,SAAS;IACpB;IACA,IAAI,IAAI,CAACC,aAAa,KAAAN,qBAAA,GAAI,IAAI,CAACI,oBAAoB,cAAAJ,qBAAA,gBAAAA,qBAAA,GAAzBA,qBAAA,CAA2BO,WAAW,cAAAP,qBAAA,eAAtCA,qBAAA,CAAwCQ,MAAM,EAAE;MACtE,OAAOH,SAAS;IACpB;IACA,IAAI,CAACD,oBAAoB,GAAGP,OAAO;IACnC,IAAI,CAACY,iBAAiB,GAAGZ,OAAO;IAChC,MAAMa,SAAS,GAAGb,OAAO,CAACa,SAAS,IAAI,IAAI,CAACrB,qBAAqB,CAACsB,uBAAuB,CAAC,CAAC;IAC3F,MAAMC,aAAa,GAAG1C,gBAAgB,CAAC,CAAC;IACxC;IACA,IAAI,CAAC6B,qBAAqB,EAAE;MACxB,IAAIW,SAAS,IAAIE,aAAa,EAAE;QAC5B,IAAI,CAACA,aAAa,CAACC,SAAS,CAACC,QAAQ,CAAC,cAAc,CAAC,EAAE;UACnD,IAAI,CAACC,6BAA6B,GAAGH,aAAa;QACtD;MACJ,CAAC,MACI;QACD,IAAI,CAACG,6BAA6B,GAAGV,SAAS;MAClD;IACJ;IACA,MAAMW,gBAAgB,GAAG,IAAIlD,eAAe,CAAC,CAAC;IAC9C,MAAMmD,KAAK,GAAG,IAAI,CAAChC,qBAAqB,CAACiC,cAAc,CAACtD,WAAW,EAAEiC,OAAO,CAAC;IAC7E,KAAAI,oBAAA,GAAIJ,OAAO,CAACU,WAAW,cAAAN,oBAAA,eAAnBA,oBAAA,CAAqBO,MAAM,EAAE;MAC7BS,KAAK,CAACE,QAAQ,GAAG,IAAI;IACzB;IACAF,KAAK,CAACG,SAAS,CAAC,MAAM;MAAA,IAAAC,mBAAA;MAClB,MAAMC,eAAe,GAAG,EAAAD,mBAAA,OAAI,CAACf,aAAa,cAAAe,mBAAA,uBAAlBA,mBAAA,CAAoBE,OAAO,KAAIpD,yBAAyB,CAAC,IAAI,CAACmC,aAAa,CAACiB,OAAO,CAAC;MAC5G,IAAID,eAAe,EAAE;QAAA,IAAAE,qBAAA;QACjB;QACA,CAAAA,qBAAA,OAAI,CAACT,6BAA6B,cAAAS,qBAAA,eAAlCA,qBAAA,CAAoC1B,KAAK,CAAC,CAAC;MAC/C;MACA;MACA;MACA,IAAI,IAAI,CAACM,oBAAoB,KAAKP,OAAO,EAAE;QACvC,IAAI,CAACO,oBAAoB,GAAGC,SAAS;MACzC;MACAW,gBAAgB,CAACS,OAAO,CAAC,CAAC;IAC9B,CAAC,EAAEpB,SAAS,EAAEW,gBAAgB,CAAC;IAC/B;IACA,IAAI,CAACnB,OAAO,CAAC6B,SAAS,EAAE;MACpB,MAAMC,aAAa,GAAGrD,aAAa,CAACuB,OAAO,CAACxD,MAAM,CAAC,GAAGwD,OAAO,CAACxD,MAAM,GAAGwD,OAAO,CAACxD,MAAM,CAACuF,cAAc,CAAC,CAAC,CAAC;MACvG/B,OAAO,CAAC6B,SAAS,GAAG,IAAI,CAACtC,cAAc,CAACyC,YAAY,CAACxD,SAAS,CAACsD,aAAa,CAAC,CAAC;IAClF;IACA,IAAI,CAACjC,mBAAmB,CAACoC,eAAe,CAAC,IAAIC,wBAAwB,CAACd,KAAK,EAAEnB,KAAK,CAAC,EAAED,OAAO,CAAC6B,SAAS,CAAC;IACvGT,KAAK,CAACe,eAAe,CAAC,MAAM,IAAI,CAACtC,mBAAmB,CAACuC,MAAM,CAAC,CAAC,EAAE5B,SAAS,EAAEW,gBAAgB,CAAC;IAC3F,KAAAd,qBAAA,GAAIL,OAAO,CAACU,WAAW,cAAAL,qBAAA,eAAnBA,qBAAA,CAAqBM,MAAM,EAAE;MAC7BQ,gBAAgB,CAACkB,GAAG,CAAClE,qBAAqB,CAACK,SAAS,CAACwB,OAAO,CAAC6B,SAAS,CAAC,CAACS,QAAQ,EAAElE,SAAS,CAACmE,UAAU,EAAEC,CAAC,IAAI;QACzG,IAAI,CAACjE,UAAU,CAACiE,CAAC,CAAChG,MAAM,EAAE4E,KAAK,CAACM,OAAO,CAAC,EAAE;UACtC,IAAI,CAACe,WAAW,CAAC,CAAC;QACtB;MACJ,CAAC,CAAC,CAAC;IACP,CAAC,MACI;MACD,IAAI,gBAAgB,IAAIzC,OAAO,CAACxD,MAAM,EAAE;QACpC,KAAK,MAAMkG,OAAO,IAAI1C,OAAO,CAACxD,MAAM,CAACuF,cAAc,EAAE;UACjDZ,gBAAgB,CAACkB,GAAG,CAAClE,qBAAqB,CAACuE,OAAO,EAAEtE,SAAS,CAACuE,KAAK,EAAE,MAAM,IAAI,CAAC/C,SAAS,CAAC,CAAC,CAAC,CAAC;QACjG;MACJ,CAAC,MACI;QACDuB,gBAAgB,CAACkB,GAAG,CAAClE,qBAAqB,CAAC6B,OAAO,CAACxD,MAAM,EAAE4B,SAAS,CAACuE,KAAK,EAAE,MAAM,IAAI,CAAC/C,SAAS,CAAC,CAAC,CAAC,CAAC;MACxG;MACA,MAAMgD,cAAc,GAAGvE,gBAAgB,CAAC,CAAC;MACzC,IAAIuE,cAAc,EAAE;QAChB,MAAMC,sBAAsB,GAAGrE,SAAS,CAACoE,cAAc,CAAC,CAACN,QAAQ;QACjEnB,gBAAgB,CAACkB,GAAG,CAAClE,qBAAqB,CAACyE,cAAc,EAAExE,SAAS,CAAC0E,QAAQ,EAAEN,CAAC;UAAA,IAAAO,qBAAA;UAAA,OAAI,IAAI,CAACC,QAAQ,CAACR,CAAC,EAAEpB,KAAK,EAAE,CAAC,GAAA2B,qBAAA,GAAC/C,OAAO,CAACU,WAAW,cAAAqC,qBAAA,eAAnBA,qBAAA,CAAqBE,aAAa,EAAC;QAAA,EAAC,CAAC;QACnJ9B,gBAAgB,CAACkB,GAAG,CAAClE,qBAAqB,CAAC0E,sBAAsB,EAAEzE,SAAS,CAAC0E,QAAQ,EAAEN,CAAC;UAAA,IAAAU,qBAAA;UAAA,OAAI,IAAI,CAACF,QAAQ,CAACR,CAAC,EAAEpB,KAAK,EAAE,CAAC,GAAA8B,qBAAA,GAAClD,OAAO,CAACU,WAAW,cAAAwC,qBAAA,eAAnBA,qBAAA,CAAqBD,aAAa,EAAC;QAAA,EAAC,CAAC;QAC3J9B,gBAAgB,CAACkB,GAAG,CAAClE,qBAAqB,CAACyE,cAAc,EAAExE,SAAS,CAAC+E,MAAM,EAAEX,CAAC,IAAI,IAAI,CAACY,MAAM,CAACZ,CAAC,EAAEpB,KAAK,CAAC,CAAC,CAAC;QACzGD,gBAAgB,CAACkB,GAAG,CAAClE,qBAAqB,CAAC0E,sBAAsB,EAAEzE,SAAS,CAAC+E,MAAM,EAAEX,CAAC,IAAI,IAAI,CAACY,MAAM,CAACZ,CAAC,EAAEpB,KAAK,CAAC,CAAC,CAAC;MACrH;IACJ;IACA,IAAI,sBAAsB,IAAItC,UAAU,EAAE;MACtC,MAAMuE,QAAQ,GAAG,IAAIC,oBAAoB,CAACd,CAAC,IAAI,IAAI,CAACe,mBAAmB,CAACf,CAAC,EAAEpB,KAAK,CAAC,EAAE;QAAEoC,SAAS,EAAE;MAAE,CAAC,CAAC;MACpG,MAAMC,kBAAkB,GAAG,gBAAgB,IAAIzD,OAAO,CAACxD,MAAM,GAAGwD,OAAO,CAACxD,MAAM,CAACuF,cAAc,CAAC,CAAC,CAAC,GAAG/B,OAAO,CAACxD,MAAM;MACjH6G,QAAQ,CAACK,OAAO,CAACD,kBAAkB,CAAC;MACpCtC,gBAAgB,CAACkB,GAAG,CAACnE,YAAY,CAAC,MAAMmF,QAAQ,CAACM,UAAU,CAAC,CAAC,CAAC,CAAC;IACnE;IACA,IAAI,CAAClD,aAAa,GAAGW,KAAK;IAC1B,OAAOA,KAAK;EAChB;EACAxB,SAASA,CAAA,EAAG;IAAA,IAAAgE,oBAAA;IACR,IAAI,CAAAA,oBAAA,OAAI,CAACnD,aAAa,cAAAmD,oBAAA,eAAlBA,oBAAA,CAAoBtC,QAAQ,IAAI,CAAC,IAAI,CAACf,oBAAoB,EAAE;MAC5D;IACJ;IACA,IAAI,CAACkC,WAAW,CAAC,CAAC;EACtB;EACAA,WAAWA,CAAA,EAAG;IACV,IAAI,CAAChC,aAAa,GAAGD,SAAS;IAC9B,IAAI,CAACD,oBAAoB,GAAGC,SAAS;IACrC,IAAI,CAACX,mBAAmB,CAACgE,eAAe,CAAC,CAAC;EAC9C;EACAN,mBAAmBA,CAACO,OAAO,EAAE1C,KAAK,EAAE;IAChC,MAAM2C,KAAK,GAAGD,OAAO,CAACA,OAAO,CAACjH,MAAM,GAAG,CAAC,CAAC;IACzC,IAAI,CAACkH,KAAK,CAACC,cAAc,EAAE;MACvB5C,KAAK,CAACQ,OAAO,CAAC,CAAC;IACnB;EACJ;EACAqC,qBAAqBA,CAAA,EAAG;IACpB,IAAI,CAAC,IAAI,CAACrD,iBAAiB,EAAE;MACzB;IACJ;IACA,IAAI,CAACb,SAAS,CAAC,IAAI,CAACa,iBAAiB,EAAE,IAAI,EAAE,IAAI,CAAC;EACtD;EACAoC,QAAQA,CAACR,CAAC,EAAEpB,KAAK,EAAE6B,aAAa,EAAE;IAAA,IAAAiB,sBAAA;IAC9B,IAAI1B,CAAC,CAAC/F,GAAG,KAAK,KAAK,EAAE;MACjB2E,KAAK,CAACE,QAAQ,GAAG,IAAI;MACrB;IACJ;IACA,MAAM6C,KAAK,GAAG,IAAIxF,qBAAqB,CAAC6D,CAAC,CAAC;IAC1C,MAAM4B,UAAU,GAAG,IAAI,CAAC9E,kBAAkB,CAAC+E,oBAAoB,CAACF,KAAK,CAAC;IACtE,IAAIC,UAAU,CAACE,+BAA+B,CAAC,CAAC,CAACC,IAAI,CAACC,KAAK,IAAI,CAAC,CAACA,KAAK,CAAC,IAAI,IAAI,CAAClF,kBAAkB,CAACmF,YAAY,CAACN,KAAK,EAAEA,KAAK,CAAC3H,MAAM,CAAC,CAACkI,IAAI,KAAK,CAAC,CAAC,+BAA+B;MAC3K;IACJ;IACA,IAAIzB,aAAa,KAAK,GAAAiB,sBAAA,GAAC,IAAI,CAAC3D,oBAAoB,cAAA2D,sBAAA,eAAzBA,sBAAA,CAA2BrD,SAAS,KAAI2B,CAAC,CAAC/F,GAAG,KAAK,KAAK,CAAC,EAAE;MAAA,IAAAkI,sBAAA;MAC7E,IAAI,CAAC/E,SAAS,CAAC,CAAC;MAChB,CAAA+E,sBAAA,OAAI,CAACzD,6BAA6B,cAAAyD,sBAAA,eAAlCA,sBAAA,CAAoC1E,KAAK,CAAC,CAAC;IAC/C;EACJ;EACAmD,MAAMA,CAACZ,CAAC,EAAEpB,KAAK,EAAE;IACb,IAAIoB,CAAC,CAAC/F,GAAG,KAAK,KAAK,EAAE;MACjB2E,KAAK,CAACE,QAAQ,GAAG,KAAK;MACtB;MACA,IAAI,CAACF,KAAK,CAACwD,SAAS,EAAE;QAAA,IAAAC,sBAAA;QAClB,IAAI,CAACjF,SAAS,CAAC,CAAC;QAChB,CAAAiF,sBAAA,OAAI,CAAC3D,6BAA6B,cAAA2D,sBAAA,eAAlCA,sBAAA,CAAoC5E,KAAK,CAAC,CAAC;MAC/C;IACJ;EACJ;EACA;EACA;EACA6E,iBAAiBA,CAACC,aAAa,EAAEjD,aAAa,EAAEkD,OAAO,EAAEhF,OAAO,EAAE;IAC9D8B,aAAa,CAACmD,YAAY,CAAC,cAAc,EAAE,MAAM,CAAC;IAClD,IAAInD,aAAa,CAACoD,KAAK,KAAK,EAAE,EAAE;MAC5BC,OAAO,CAACC,IAAI,CAAC,2HAA2H,CAAC;MACzID,OAAO,CAACE,KAAK,CAAC,cAAc,EAAEvD,aAAa,CAACoD,KAAK,CAAC;MAClDpD,aAAa,CAACoD,KAAK,GAAG,EAAE;IAC5B;IACA,IAAII,gBAAgB;IACpB,IAAIC,WAAW;IACf,MAAM3F,SAAS,GAAGA,CAAC4F,aAAa,EAAEC,kBAAkB,KAAK;MACrD,MAAMC,QAAQ,GAAGH,WAAW,KAAK/E,SAAS;MAC1C,IAAIgF,aAAa,EAAE;QAAA,IAAAG,YAAA;QACf,CAAAA,YAAA,GAAAJ,WAAW,cAAAI,YAAA,eAAXA,YAAA,CAAa/D,OAAO,CAAC,CAAC;QACtB2D,WAAW,GAAG/E,SAAS;MAC3B;MACA,IAAIiF,kBAAkB,EAAE;QAAA,IAAAG,iBAAA;QACpB,CAAAA,iBAAA,GAAAN,gBAAgB,cAAAM,iBAAA,eAAhBA,iBAAA,CAAkBhE,OAAO,CAAC,CAAC;QAC3B0D,gBAAgB,GAAG9E,SAAS;MAChC;MACA,IAAIkF,QAAQ,EAAE;QAAA,IAAAG,qBAAA;QACV,CAAAA,qBAAA,GAAAd,aAAa,CAACe,cAAc,cAAAD,qBAAA,eAA5BA,qBAAA,CAAAE,IAAA,CAAAhB,aAA+B,CAAC;QAChCQ,WAAW,GAAG/E,SAAS;MAC3B;IACJ,CAAC;IACD,MAAMwF,gBAAgB,GAAGA,CAACC,KAAK,EAAEhG,KAAK,EAAEzD,MAAM,EAAEqE,SAAS,KAAK;MAC1D,OAAO,IAAI5B,YAAY,CAAC,YAAY;QAChC,IAAI,CAACsG,WAAW,IAAIA,WAAW,CAACW,UAAU,EAAE;UACxCX,WAAW,GAAG,IAAIvG,kBAAkB,CAAC+F,aAAa,EAAEvI,MAAM,IAAIsF,aAAa,EAAEmE,KAAK,GAAG,CAAC,CAAC;UACvF,MAAMV,WAAW,CAACY,MAAM,CAAC,OAAOnB,OAAO,KAAK,UAAU,GAAGA,OAAO,CAAC,CAAC,GAAGA,OAAO,EAAE/E,KAAK,EAAE;YAAE,GAAGD,OAAO;YAAEa;UAAU,CAAC,CAAC;QACnH;MACJ,CAAC,EAAEoF,KAAK,CAAC;IACb,CAAC;IACD,IAAIG,WAAW,GAAG,KAAK;IACvB,MAAMC,gBAAgB,GAAGlI,qBAAqB,CAAC2D,aAAa,EAAE1D,SAAS,CAACmE,UAAU,EAAE,MAAM;MACtF6D,WAAW,GAAG,IAAI;MAClBxG,SAAS,CAAC,IAAI,EAAE,IAAI,CAAC;IACzB,CAAC,EAAE,IAAI,CAAC;IACR,MAAM0G,cAAc,GAAGnI,qBAAqB,CAAC2D,aAAa,EAAE1D,SAAS,CAACmI,QAAQ,EAAE,MAAM;MAClFH,WAAW,GAAG,KAAK;IACvB,CAAC,EAAE,IAAI,CAAC;IACR,MAAMI,iBAAiB,GAAGrI,qBAAqB,CAAC2D,aAAa,EAAE1D,SAAS,CAACqI,WAAW,EAAGjE,CAAC,IAAK;MACzF4D,WAAW,GAAG,KAAK;MACnBxG,SAAS,CAAC,KAAK,EAAE4C,CAAC,CAACkE,WAAW,KAAK5E,aAAa,CAAC;IACrD,CAAC,EAAE,IAAI,CAAC;IACR,MAAM6E,WAAW,GAAInE,CAAC,IAAK;MACvB,IAAI8C,gBAAgB,EAAE;QAClB;MACJ;MACA,MAAMsB,SAAS,GAAG,IAAI3I,eAAe,CAAC,CAAC;MACvC,MAAMzB,MAAM,GAAG;QACXuF,cAAc,EAAE,CAACD,aAAa,CAAC;QAC/BF,OAAO,EAAEA,CAAA,KAAM,CAAE;MACrB,CAAC;MACD,IAAImD,aAAa,CAAC8B,SAAS,KAAKrG,SAAS,IAAIuE,aAAa,CAAC8B,SAAS,KAAK,OAAO,EAAE;QAC9E;QACA,MAAMC,WAAW,GAAItE,CAAC,IAAK;UACvBhG,MAAM,CAACuK,CAAC,GAAGvE,CAAC,CAACuE,CAAC,GAAG,EAAE;UACnB,IAAKtI,aAAa,CAAC+D,CAAC,CAAChG,MAAM,CAAC,IAAKwK,qBAAqB,CAACxE,CAAC,CAAChG,MAAM,EAAEsF,aAAa,CAAC,KAAKA,aAAa,EAAE;YAC/FlC,SAAS,CAAC,IAAI,EAAE,IAAI,CAAC;UACzB;QACJ,CAAC;QACDgH,SAAS,CAACvE,GAAG,CAAClE,qBAAqB,CAAC2D,aAAa,EAAE1D,SAAS,CAAC6I,UAAU,EAAEH,WAAW,EAAE,IAAI,CAAC,CAAC;MAChG;MACAxB,gBAAgB,GAAGsB,SAAS;MAC5B,IAAKnI,aAAa,CAAC+D,CAAC,CAAChG,MAAM,CAAC,IAAKwK,qBAAqB,CAACxE,CAAC,CAAChG,MAAM,EAAEsF,aAAa,CAAC,KAAKA,aAAa,EAAE;QAC/F,OAAO,CAAC;MACZ;MACA8E,SAAS,CAACvE,GAAG,CAAC2D,gBAAgB,CAACjB,aAAa,CAACkB,KAAK,EAAE,KAAK,EAAEzJ,MAAM,CAAC,CAAC;IACvE,CAAC;IACD,MAAM0K,mBAAmB,GAAG/I,qBAAqB,CAAC2D,aAAa,EAAE1D,SAAS,CAAC+I,UAAU,EAAER,WAAW,EAAE,IAAI,CAAC;IACzG,MAAMS,OAAO,GAAGA,CAAA,KAAM;MAClB,IAAIhB,WAAW,IAAId,gBAAgB,EAAE;QACjC;MACJ;MACA,MAAM9I,MAAM,GAAG;QACXuF,cAAc,EAAE,CAACD,aAAa,CAAC;QAC/BF,OAAO,EAAEA,CAAA,KAAM,CAAE;MACrB,CAAC;MACD,MAAMgF,SAAS,GAAG,IAAI3I,eAAe,CAAC,CAAC;MACvC,MAAMoJ,MAAM,GAAGA,CAAA,KAAMzH,SAAS,CAAC,IAAI,EAAE,IAAI,CAAC;MAC1CgH,SAAS,CAACvE,GAAG,CAAClE,qBAAqB,CAAC2D,aAAa,EAAE1D,SAAS,CAACkJ,IAAI,EAAED,MAAM,EAAE,IAAI,CAAC,CAAC;MACjFT,SAAS,CAACvE,GAAG,CAAC2D,gBAAgB,CAACjB,aAAa,CAACkB,KAAK,EAAE,KAAK,EAAEzJ,MAAM,CAAC,CAAC;MACnE8I,gBAAgB,GAAGsB,SAAS;IAChC,CAAC;IACD;IACA,IAAIW,eAAe;IACnB,MAAMC,OAAO,GAAG1F,aAAa,CAAC0F,OAAO,CAACC,WAAW,CAAC,CAAC;IACnD,IAAID,OAAO,KAAK,OAAO,IAAIA,OAAO,KAAK,UAAU,EAAE;MAC/CD,eAAe,GAAGpJ,qBAAqB,CAAC2D,aAAa,EAAE1D,SAAS,CAACsJ,KAAK,EAAEN,OAAO,EAAE,IAAI,CAAC;IAC1F;IACA,MAAMhG,KAAK,GAAG;MACVuG,IAAI,EAAE1H,KAAK,IAAI;QACXL,SAAS,CAAC,KAAK,EAAE,IAAI,CAAC,CAAC,CAAC;QACxBoG,gBAAgB,CAAC,CAAC,EAAE/F,KAAK,EAAEO,SAAS,EAAEP,KAAK,CAAC,CAAC,CAAC;MAClD,CAAC;MACD2H,IAAI,EAAEA,CAAA,KAAM;QACRhI,SAAS,CAAC,IAAI,EAAE,IAAI,CAAC;MACzB,CAAC;MACDuG,MAAM,EAAE,MAAAA,CAAO0B,UAAU,EAAEC,YAAY,KAAK;QAAA,IAAAC,aAAA;QACxC/C,OAAO,GAAG6C,UAAU;QACpB,QAAAE,aAAA,GAAMxC,WAAW,cAAAwC,aAAA,uBAAXA,aAAA,CAAa5B,MAAM,CAACnB,OAAO,EAAExE,SAAS,EAAEsH,YAAY,CAAC;MAC/D,CAAC;MACDlG,OAAO,EAAEA,CAAA,KAAM;QAAA,IAAAoG,gBAAA;QACX,IAAI,CAACvI,cAAc,CAACwI,MAAM,CAACnG,aAAa,CAAC;QACzCoF,mBAAmB,CAACtF,OAAO,CAAC,CAAC;QAC7B4E,iBAAiB,CAAC5E,OAAO,CAAC,CAAC;QAC3ByE,gBAAgB,CAACzE,OAAO,CAAC,CAAC;QAC1B0E,cAAc,CAAC1E,OAAO,CAAC,CAAC;QACxB,CAAAoG,gBAAA,GAAAT,eAAe,cAAAS,gBAAA,eAAfA,gBAAA,CAAiBpG,OAAO,CAAC,CAAC;QAC1BhC,SAAS,CAAC,IAAI,EAAE,IAAI,CAAC;MACzB;IACJ,CAAC;IACD,IAAI,CAACH,cAAc,CAACyI,GAAG,CAACpG,aAAa,EAAEV,KAAK,CAAC;IAC7C,OAAOA,KAAK;EAChB;EACA+G,gBAAgBA,CAAC3L,MAAM,EAAE;IACrB,MAAM4E,KAAK,GAAG,IAAI,CAAC3B,cAAc,CAAC2I,GAAG,CAAC5L,MAAM,CAAC;IAC7C,IAAI4E,KAAK,EAAE;MACPA,KAAK,CAACuG,IAAI,CAAC,IAAI,CAAC;IACpB;EACJ;EACA/F,OAAOA,CAAA,EAAG;IACN,IAAI,CAACnC,cAAc,CAAC4I,OAAO,CAACjH,KAAK,IAAIA,KAAK,CAACQ,OAAO,CAAC,CAAC,CAAC;IACrD,KAAK,CAACA,OAAO,CAAC,CAAC;EACnB;AACJ,CAAC;AACD1C,YAAY,GAAG5C,UAAU,CAAC,CACtBgB,OAAO,CAAC,CAAC,EAAEQ,qBAAqB,CAAC,EACjCR,OAAO,CAAC,CAAC,EAAEO,mBAAmB,CAAC,EAC/BP,OAAO,CAAC,CAAC,EAAEoB,kBAAkB,CAAC,EAC9BpB,OAAO,CAAC,CAAC,EAAEuB,cAAc,CAAC,EAC1BvB,OAAO,CAAC,CAAC,EAAEsB,qBAAqB,CAAC,CACpC,EAAEM,YAAY,CAAC;AAChB,SAASA,YAAY;AACrB,SAASoB,uBAAuBA,CAACN,OAAO,EAAE;EAAA,IAAAsI,WAAA;EACtC,IAAItI,OAAO,KAAKQ,SAAS,EAAE;IACvB,OAAOA,SAAS;EACpB;EACA,QAAA8H,WAAA,GAAOtI,OAAO,aAAPA,OAAO,uBAAPA,OAAO,CAAEuI,EAAE,cAAAD,WAAA,cAAAA,WAAA,GAAItI,OAAO;AACjC;AACA,MAAMkC,wBAAwB,CAAC;EAC3B,IAAIsG,cAAcA,CAAA,EAAG;IACjB,OAAO,IAAI,CAACC,MAAM,CAACC,MAAM;EAC7B;EACAvJ,WAAWA,CAACsJ,MAAM,EAAkB;IAAA,IAAhBE,MAAM,GAAA/L,SAAA,CAAAC,MAAA,QAAAD,SAAA,QAAA4D,SAAA,GAAA5D,SAAA,MAAG,KAAK;IAC9B,IAAI,CAAC6L,MAAM,GAAGA,MAAM;IACpB,IAAI,CAACE,MAAM,GAAGA,MAAM;IACpB;IACA,IAAI,CAACC,KAAK,GAAG,CAAC;EAClB;EACAC,MAAMA,CAAChH,SAAS,EAAE;IACd,IAAI,CAAC4G,MAAM,CAACI,MAAM,CAAChH,SAAS,CAAC;IAC7B,IAAI,IAAI,CAAC8G,MAAM,EAAE;MACb,IAAI,CAACF,MAAM,CAACxI,KAAK,CAAC,CAAC;IACvB;IACA,OAAO,IAAI,CAACwI,MAAM;EACtB;EACAK,SAASA,CAAA,EAAG;IACR,OAAO;MACH/B,CAAC,EAAE,IAAI,CAAC0B,MAAM,CAAC1B,CAAC;MAChBgC,CAAC,EAAE,IAAI,CAACN,MAAM,CAACM;IACnB,CAAC;EACL;EACA3G,MAAMA,CAAA,EAAG;IACL,IAAI,CAACqG,MAAM,CAACrG,MAAM,CAAC,CAAC;EACxB;AACJ;AACA,SAAS4E,qBAAqBA,CAACtE,OAAO,EAAEsG,WAAW,EAAE;EAAA,IAAAC,YAAA;EACjDD,WAAW,IAAAC,YAAA,GAAGD,WAAW,cAAAC,YAAA,cAAAA,YAAA,GAAIzK,SAAS,CAACkE,OAAO,CAAC,CAACJ,QAAQ,CAAC4G,IAAI;EAC7D,OAAO,CAACxG,OAAO,CAACyG,YAAY,CAAC,cAAc,CAAC,IAAIzG,OAAO,KAAKsG,WAAW,EAAE;IACrEtG,OAAO,GAAGA,OAAO,CAAC0G,aAAa;EACnC;EACA,OAAO1G,OAAO;AAClB;AACAjF,iBAAiB,CAACG,aAAa,EAAEsB,YAAY,EAAE,CAAC,CAAC,+BAA+B,CAAC;AACjFxB,0BAA0B,CAAC,CAAC2L,KAAK,EAAEC,SAAS,KAAK;EAC7C,MAAMC,WAAW,GAAGF,KAAK,CAACG,QAAQ,CAAC7L,iBAAiB,CAAC;EACrD,IAAI4L,WAAW,EAAE;IACbD,SAAS,CAACG,OAAO,wGAAAC,MAAA,CAAwGH,WAAW,CAACI,WAAW,CAAC,GAAG,CAAC,QAAK,CAAC;IAC3JL,SAAS,CAACG,OAAO,kEAAAC,MAAA,CAAkEH,WAAW,CAACI,WAAW,CAAC,GAAG,CAAC,QAAK,CAAC;EACzH;AACJ,CAAC,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}