{"ast":null,"code":"var _InlineCompletionsController;\n/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n    r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n    d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = this && this.__param || function (paramIndex, decorator) {\n  return function (target, key) {\n    decorator(target, key, paramIndex);\n  };\n};\nvar InlineCompletionsController_1;\nimport { createStyleSheetFromObservable } from '../../../../../base/browser/domObservable.js';\nimport { alert } from '../../../../../base/browser/ui/aria/aria.js';\nimport { timeout } from '../../../../../base/common/async.js';\nimport { cancelOnDispose } from '../../../../../base/common/cancellation.js';\nimport { Disposable, toDisposable } from '../../../../../base/common/lifecycle.js';\nimport { autorun, constObservable, derived, observableFromEvent, observableSignal, observableValue, transaction, waitForState } from '../../../../../base/common/observable.js';\nimport { derivedDisposable } from '../../../../../base/common/observableInternal/derived.js';\nimport { derivedObservableWithCache, mapObservableArrayCached } from '../../../../../base/common/observableInternal/utils.js';\nimport { isUndefined } from '../../../../../base/common/types.js';\nimport { CoreEditingCommands } from '../../../../browser/coreCommands.js';\nimport { observableCodeEditor, reactToChange, reactToChangeWithStore } from '../../../../browser/observableCodeEditor.js';\nimport { Position } from '../../../../common/core/position.js';\nimport { ILanguageFeatureDebounceService } from '../../../../common/services/languageFeatureDebounce.js';\nimport { ILanguageFeaturesService } from '../../../../common/services/languageFeatures.js';\nimport { inlineSuggestCommitId } from './commandIds.js';\nimport { GhostTextView } from '../view/ghostTextView.js';\nimport { InlineCompletionContextKeys } from './inlineCompletionContextKeys.js';\nimport { InlineCompletionsHintsWidget, InlineSuggestionHintsContentWidget } from '../hintsWidget/inlineCompletionsHintsWidget.js';\nimport { InlineCompletionsModel } from '../model/inlineCompletionsModel.js';\nimport { SuggestWidgetAdaptor } from '../model/suggestWidgetAdaptor.js';\nimport { localize } from '../../../../../nls.js';\nimport { IAccessibilityService } from '../../../../../platform/accessibility/common/accessibility.js';\nimport { AccessibilitySignal, IAccessibilitySignalService } from '../../../../../platform/accessibilitySignal/browser/accessibilitySignalService.js';\nimport { ICommandService } from '../../../../../platform/commands/common/commands.js';\nimport { IConfigurationService } from '../../../../../platform/configuration/common/configuration.js';\nimport { IContextKeyService } from '../../../../../platform/contextkey/common/contextkey.js';\nimport { IInstantiationService } from '../../../../../platform/instantiation/common/instantiation.js';\nimport { IKeybindingService } from '../../../../../platform/keybinding/common/keybinding.js';\nlet InlineCompletionsController = (_InlineCompletionsController = class InlineCompletionsController extends Disposable {\n  static get(editor) {\n    return editor.getContribution(InlineCompletionsController_1.ID);\n  }\n  constructor(editor, _instantiationService, _contextKeyService, _configurationService, _commandService, _debounceService, _languageFeaturesService, _accessibilitySignalService, _keybindingService, _accessibilityService) {\n    super();\n    this.editor = editor;\n    this._instantiationService = _instantiationService;\n    this._contextKeyService = _contextKeyService;\n    this._configurationService = _configurationService;\n    this._commandService = _commandService;\n    this._debounceService = _debounceService;\n    this._languageFeaturesService = _languageFeaturesService;\n    this._accessibilitySignalService = _accessibilitySignalService;\n    this._keybindingService = _keybindingService;\n    this._accessibilityService = _accessibilityService;\n    this._editorObs = observableCodeEditor(this.editor);\n    this._positions = derived(this, reader => {\n      var _this$_editorObs$sele, _this$_editorObs$sele2;\n      return (_this$_editorObs$sele = (_this$_editorObs$sele2 = this._editorObs.selections.read(reader)) === null || _this$_editorObs$sele2 === void 0 ? void 0 : _this$_editorObs$sele2.map(s => s.getEndPosition())) !== null && _this$_editorObs$sele !== void 0 ? _this$_editorObs$sele : [new Position(1, 1)];\n    });\n    this._suggestWidgetAdaptor = this._register(new SuggestWidgetAdaptor(this.editor, () => {\n      var _this$model$get;\n      this._editorObs.forceUpdate();\n      return (_this$model$get = this.model.get()) === null || _this$model$get === void 0 || (_this$model$get = _this$model$get.selectedInlineCompletion.get()) === null || _this$model$get === void 0 ? void 0 : _this$model$get.toSingleTextEdit(undefined);\n    }, item => this._editorObs.forceUpdate(_tx => {\n      var _this$model$get2;\n      /** @description InlineCompletionsController.handleSuggestAccepted */\n      (_this$model$get2 = this.model.get()) === null || _this$model$get2 === void 0 || _this$model$get2.handleSuggestAccepted(item);\n    })));\n    this._suggestWidgetSelectedItem = observableFromEvent(this, cb => this._suggestWidgetAdaptor.onDidSelectedItemChange(() => {\n      this._editorObs.forceUpdate(_tx => cb(undefined));\n    }), () => this._suggestWidgetAdaptor.selectedItem);\n    this._enabledInConfig = observableFromEvent(this, this.editor.onDidChangeConfiguration, () => this.editor.getOption(62 /* EditorOption.inlineSuggest */).enabled);\n    this._isScreenReaderEnabled = observableFromEvent(this, this._accessibilityService.onDidChangeScreenReaderOptimized, () => this._accessibilityService.isScreenReaderOptimized());\n    this._editorDictationInProgress = observableFromEvent(this, this._contextKeyService.onDidChangeContext, () => this._contextKeyService.getContext(this.editor.getDomNode()).getValue('editorDictation.inProgress') === true);\n    this._enabled = derived(this, reader => this._enabledInConfig.read(reader) && (!this._isScreenReaderEnabled.read(reader) || !this._editorDictationInProgress.read(reader)));\n    this._debounceValue = this._debounceService.for(this._languageFeaturesService.inlineCompletionsProvider, 'InlineCompletionsDebounce', {\n      min: 50,\n      max: 50\n    });\n    this.model = derivedDisposable(this, reader => {\n      if (this._editorObs.isReadonly.read(reader)) {\n        return undefined;\n      }\n      const textModel = this._editorObs.model.read(reader);\n      if (!textModel) {\n        return undefined;\n      }\n      const model = this._instantiationService.createInstance(InlineCompletionsModel, textModel, this._suggestWidgetSelectedItem, this._editorObs.versionId, this._positions, this._debounceValue, observableFromEvent(this.editor.onDidChangeConfiguration, () => this.editor.getOption(119 /* EditorOption.suggest */).preview), observableFromEvent(this.editor.onDidChangeConfiguration, () => this.editor.getOption(119 /* EditorOption.suggest */).previewMode), observableFromEvent(this.editor.onDidChangeConfiguration, () => this.editor.getOption(62 /* EditorOption.inlineSuggest */).mode), this._enabled);\n      return model;\n    }).recomputeInitiallyAndOnChange(this._store);\n    this._ghostTexts = derived(this, reader => {\n      var _model$ghostTexts$rea;\n      const model = this.model.read(reader);\n      return (_model$ghostTexts$rea = model === null || model === void 0 ? void 0 : model.ghostTexts.read(reader)) !== null && _model$ghostTexts$rea !== void 0 ? _model$ghostTexts$rea : [];\n    });\n    this._stablizedGhostTexts = convertItemsToStableObservables(this._ghostTexts, this._store);\n    this._ghostTextWidgets = mapObservableArrayCached(this, this._stablizedGhostTexts, (ghostText, store) => store.add(this._instantiationService.createInstance(GhostTextView, this.editor, {\n      ghostText: ghostText,\n      minReservedLineCount: constObservable(0),\n      targetTextModel: this.model.map(v => v === null || v === void 0 ? void 0 : v.textModel)\n    }))).recomputeInitiallyAndOnChange(this._store);\n    this._playAccessibilitySignal = observableSignal(this);\n    this._fontFamily = observableFromEvent(this, this.editor.onDidChangeConfiguration, () => this.editor.getOption(62 /* EditorOption.inlineSuggest */).fontFamily);\n    this._register(new InlineCompletionContextKeys(this._contextKeyService, this.model));\n    this._register(reactToChange(this._editorObs.onDidType, (_value, _changes) => {\n      if (this._enabled.get()) {\n        var _this$model$get3;\n        (_this$model$get3 = this.model.get()) === null || _this$model$get3 === void 0 || _this$model$get3.trigger();\n      }\n    }));\n    this._register(this._commandService.onDidExecuteCommand(e => {\n      // These commands don't trigger onDidType.\n      const commands = new Set([CoreEditingCommands.Tab.id, CoreEditingCommands.DeleteLeft.id, CoreEditingCommands.DeleteRight.id, inlineSuggestCommitId, 'acceptSelectedSuggestion']);\n      if (commands.has(e.commandId) && editor.hasTextFocus() && this._enabled.get()) {\n        this._editorObs.forceUpdate(tx => {\n          var _this$model$get4;\n          /** @description onDidExecuteCommand */\n          (_this$model$get4 = this.model.get()) === null || _this$model$get4 === void 0 || _this$model$get4.trigger(tx);\n        });\n      }\n    }));\n    this._register(reactToChange(this._editorObs.selections, (_value, changes) => {\n      if (changes.some(e => e.reason === 3 /* CursorChangeReason.Explicit */ || e.source === 'api')) {\n        var _this$model$get5;\n        (_this$model$get5 = this.model.get()) === null || _this$model$get5 === void 0 || _this$model$get5.stop();\n      }\n    }));\n    this._register(this.editor.onDidBlurEditorWidget(() => {\n      // This is a hidden setting very useful for debugging\n      if (this._contextKeyService.getContextKeyValue('accessibleViewIsShown') || this._configurationService.getValue('editor.inlineSuggest.keepOnBlur') || editor.getOption(62 /* EditorOption.inlineSuggest */).keepOnBlur || InlineSuggestionHintsContentWidget.dropDownVisible) {\n        return;\n      }\n      transaction(tx => {\n        var _this$model$get6;\n        /** @description InlineCompletionsController.onDidBlurEditorWidget */\n        (_this$model$get6 = this.model.get()) === null || _this$model$get6 === void 0 || _this$model$get6.stop(tx);\n      });\n    }));\n    this._register(autorun(reader => {\n      var _this$model$read;\n      /** @description InlineCompletionsController.forceRenderingAbove */\n      const state = (_this$model$read = this.model.read(reader)) === null || _this$model$read === void 0 ? void 0 : _this$model$read.state.read(reader);\n      if (state !== null && state !== void 0 && state.suggestItem) {\n        if (state.primaryGhostText.lineCount >= 2) {\n          this._suggestWidgetAdaptor.forceRenderingAbove();\n        }\n      } else {\n        this._suggestWidgetAdaptor.stopForceRenderingAbove();\n      }\n    }));\n    this._register(toDisposable(() => {\n      this._suggestWidgetAdaptor.stopForceRenderingAbove();\n    }));\n    const currentInlineCompletionBySemanticId = derivedObservableWithCache(this, (reader, last) => {\n      var _state$inlineCompleti;\n      const model = this.model.read(reader);\n      const state = model === null || model === void 0 ? void 0 : model.state.read(reader);\n      if (this._suggestWidgetSelectedItem.get()) {\n        return last;\n      }\n      return state === null || state === void 0 || (_state$inlineCompleti = state.inlineCompletion) === null || _state$inlineCompleti === void 0 ? void 0 : _state$inlineCompleti.semanticId;\n    });\n    this._register(reactToChangeWithStore(derived(reader => {\n      this._playAccessibilitySignal.read(reader);\n      currentInlineCompletionBySemanticId.read(reader);\n      return {};\n    }), async (_value, _deltas, store) => {\n      /** @description InlineCompletionsController.playAccessibilitySignalAndReadSuggestion */\n      const model = this.model.get();\n      const state = model === null || model === void 0 ? void 0 : model.state.get();\n      if (!state || !model) {\n        return;\n      }\n      const lineText = model.textModel.getLineContent(state.primaryGhostText.lineNumber);\n      await timeout(50, cancelOnDispose(store));\n      await waitForState(this._suggestWidgetSelectedItem, isUndefined, () => false, cancelOnDispose(store));\n      await this._accessibilitySignalService.playSignal(AccessibilitySignal.inlineSuggestion);\n      if (this.editor.getOption(8 /* EditorOption.screenReaderAnnounceInlineSuggestion */)) {\n        this._provideScreenReaderUpdate(state.primaryGhostText.renderForScreenReader(lineText));\n      }\n    }));\n    this._register(new InlineCompletionsHintsWidget(this.editor, this.model, this._instantiationService));\n    this._register(createStyleSheetFromObservable(derived(reader => {\n      const fontFamily = this._fontFamily.read(reader);\n      if (fontFamily === '' || fontFamily === 'default') {\n        return '';\n      }\n      return \"\\n.monaco-editor .ghost-text-decoration,\\n.monaco-editor .ghost-text-decoration-preview,\\n.monaco-editor .ghost-text {\\n\\tfont-family: \".concat(fontFamily, \";\\n}\");\n    })));\n    // TODO@hediet\n    this._register(this._configurationService.onDidChangeConfiguration(e => {\n      if (e.affectsConfiguration('accessibility.verbosity.inlineCompletions')) {\n        this.editor.updateOptions({\n          inlineCompletionsAccessibilityVerbose: this._configurationService.getValue('accessibility.verbosity.inlineCompletions')\n        });\n      }\n    }));\n    this.editor.updateOptions({\n      inlineCompletionsAccessibilityVerbose: this._configurationService.getValue('accessibility.verbosity.inlineCompletions')\n    });\n  }\n  playAccessibilitySignal(tx) {\n    this._playAccessibilitySignal.trigger(tx);\n  }\n  _provideScreenReaderUpdate(content) {\n    const accessibleViewShowing = this._contextKeyService.getContextKeyValue('accessibleViewIsShown');\n    const accessibleViewKeybinding = this._keybindingService.lookupKeybinding('editor.action.accessibleView');\n    let hint;\n    if (!accessibleViewShowing && accessibleViewKeybinding && this.editor.getOption(150 /* EditorOption.inlineCompletionsAccessibilityVerbose */)) {\n      hint = localize('showAccessibleViewHint', \"Inspect this in the accessible view ({0})\", accessibleViewKeybinding.getAriaLabel());\n    }\n    alert(hint ? content + ', ' + hint : content);\n  }\n  shouldShowHoverAt(range) {\n    var _this$model$get7;\n    const ghostText = (_this$model$get7 = this.model.get()) === null || _this$model$get7 === void 0 ? void 0 : _this$model$get7.primaryGhostText.get();\n    if (ghostText) {\n      return ghostText.parts.some(p => range.containsPosition(new Position(ghostText.lineNumber, p.column)));\n    }\n    return false;\n  }\n  shouldShowHoverAtViewZone(viewZoneId) {\n    var _this$_ghostTextWidge, _this$_ghostTextWidge2;\n    return (_this$_ghostTextWidge = (_this$_ghostTextWidge2 = this._ghostTextWidgets.get()[0]) === null || _this$_ghostTextWidge2 === void 0 ? void 0 : _this$_ghostTextWidge2.ownsViewZone(viewZoneId)) !== null && _this$_ghostTextWidge !== void 0 ? _this$_ghostTextWidge : false;\n  }\n}, InlineCompletionsController_1 = _InlineCompletionsController, _InlineCompletionsController.ID = 'editor.contrib.inlineCompletionsController', _InlineCompletionsController);\nInlineCompletionsController = InlineCompletionsController_1 = __decorate([__param(1, IInstantiationService), __param(2, IContextKeyService), __param(3, IConfigurationService), __param(4, ICommandService), __param(5, ILanguageFeatureDebounceService), __param(6, ILanguageFeaturesService), __param(7, IAccessibilitySignalService), __param(8, IKeybindingService), __param(9, IAccessibilityService)], InlineCompletionsController);\nexport { InlineCompletionsController };\nfunction convertItemsToStableObservables(items, store) {\n  const result = observableValue('result', []);\n  const innerObservables = [];\n  store.add(autorun(reader => {\n    const itemsValue = items.read(reader);\n    transaction(tx => {\n      if (itemsValue.length !== innerObservables.length) {\n        innerObservables.length = itemsValue.length;\n        for (let i = 0; i < innerObservables.length; i++) {\n          if (!innerObservables[i]) {\n            innerObservables[i] = observableValue('item', itemsValue[i]);\n          }\n        }\n        result.set([...innerObservables], tx);\n      }\n      innerObservables.forEach((o, i) => o.set(itemsValue[i], tx));\n    });\n  }));\n  return result;\n}","map":{"version":3,"names":["__decorate","decorators","target","key","desc","c","arguments","length","r","Object","getOwnPropertyDescriptor","d","Reflect","decorate","i","defineProperty","__param","paramIndex","decorator","InlineCompletionsController_1","createStyleSheetFromObservable","alert","timeout","cancelOnDispose","Disposable","toDisposable","autorun","constObservable","derived","observableFromEvent","observableSignal","observableValue","transaction","waitForState","derivedDisposable","derivedObservableWithCache","mapObservableArrayCached","isUndefined","CoreEditingCommands","observableCodeEditor","reactToChange","reactToChangeWithStore","Position","ILanguageFeatureDebounceService","ILanguageFeaturesService","inlineSuggestCommitId","GhostTextView","InlineCompletionContextKeys","InlineCompletionsHintsWidget","InlineSuggestionHintsContentWidget","InlineCompletionsModel","SuggestWidgetAdaptor","localize","IAccessibilityService","AccessibilitySignal","IAccessibilitySignalService","ICommandService","IConfigurationService","IContextKeyService","IInstantiationService","IKeybindingService","InlineCompletionsController","_InlineCompletionsController","get","editor","getContribution","ID","constructor","_instantiationService","_contextKeyService","_configurationService","_commandService","_debounceService","_languageFeaturesService","_accessibilitySignalService","_keybindingService","_accessibilityService","_editorObs","_positions","reader","_this$_editorObs$sele","_this$_editorObs$sele2","selections","read","map","s","getEndPosition","_suggestWidgetAdaptor","_register","_this$model$get","forceUpdate","model","selectedInlineCompletion","toSingleTextEdit","undefined","item","_tx","_this$model$get2","handleSuggestAccepted","_suggestWidgetSelectedItem","cb","onDidSelectedItemChange","selectedItem","_enabledInConfig","onDidChangeConfiguration","getOption","enabled","_isScreenReaderEnabled","onDidChangeScreenReaderOptimized","isScreenReaderOptimized","_editorDictationInProgress","onDidChangeContext","getContext","getDomNode","getValue","_enabled","_debounceValue","for","inlineCompletionsProvider","min","max","isReadonly","textModel","createInstance","versionId","preview","previewMode","mode","recomputeInitiallyAndOnChange","_store","_ghostTexts","_model$ghostTexts$rea","ghostTexts","_stablizedGhostTexts","convertItemsToStableObservables","_ghostTextWidgets","ghostText","store","add","minReservedLineCount","targetTextModel","v","_playAccessibilitySignal","_fontFamily","fontFamily","onDidType","_value","_changes","_this$model$get3","trigger","onDidExecuteCommand","e","commands","Set","Tab","id","DeleteLeft","DeleteRight","has","commandId","hasTextFocus","tx","_this$model$get4","changes","some","reason","source","_this$model$get5","stop","onDidBlurEditorWidget","getContextKeyValue","keepOnBlur","dropDownVisible","_this$model$get6","_this$model$read","state","suggestItem","primaryGhostText","lineCount","forceRenderingAbove","stopForceRenderingAbove","currentInlineCompletionBySemanticId","last","_state$inlineCompleti","inlineCompletion","semanticId","_deltas","lineText","getLineContent","lineNumber","playSignal","inlineSuggestion","_provideScreenReaderUpdate","renderForScreenReader","concat","affectsConfiguration","updateOptions","inlineCompletionsAccessibilityVerbose","playAccessibilitySignal","content","accessibleViewShowing","accessibleViewKeybinding","lookupKeybinding","hint","getAriaLabel","shouldShowHoverAt","range","_this$model$get7","parts","p","containsPosition","column","shouldShowHoverAtViewZone","viewZoneId","_this$_ghostTextWidge","_this$_ghostTextWidge2","ownsViewZone","items","result","innerObservables","itemsValue","set","forEach","o"],"sources":["D:/ospanel/domains/react/react-intro-main/node_modules/monaco-editor/esm/vs/editor/contrib/inlineCompletions/browser/controller/inlineCompletionsController.js"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar InlineCompletionsController_1;\nimport { createStyleSheetFromObservable } from '../../../../../base/browser/domObservable.js';\nimport { alert } from '../../../../../base/browser/ui/aria/aria.js';\nimport { timeout } from '../../../../../base/common/async.js';\nimport { cancelOnDispose } from '../../../../../base/common/cancellation.js';\nimport { Disposable, toDisposable } from '../../../../../base/common/lifecycle.js';\nimport { autorun, constObservable, derived, observableFromEvent, observableSignal, observableValue, transaction, waitForState } from '../../../../../base/common/observable.js';\nimport { derivedDisposable } from '../../../../../base/common/observableInternal/derived.js';\nimport { derivedObservableWithCache, mapObservableArrayCached } from '../../../../../base/common/observableInternal/utils.js';\nimport { isUndefined } from '../../../../../base/common/types.js';\nimport { CoreEditingCommands } from '../../../../browser/coreCommands.js';\nimport { observableCodeEditor, reactToChange, reactToChangeWithStore } from '../../../../browser/observableCodeEditor.js';\nimport { Position } from '../../../../common/core/position.js';\nimport { ILanguageFeatureDebounceService } from '../../../../common/services/languageFeatureDebounce.js';\nimport { ILanguageFeaturesService } from '../../../../common/services/languageFeatures.js';\nimport { inlineSuggestCommitId } from './commandIds.js';\nimport { GhostTextView } from '../view/ghostTextView.js';\nimport { InlineCompletionContextKeys } from './inlineCompletionContextKeys.js';\nimport { InlineCompletionsHintsWidget, InlineSuggestionHintsContentWidget } from '../hintsWidget/inlineCompletionsHintsWidget.js';\nimport { InlineCompletionsModel } from '../model/inlineCompletionsModel.js';\nimport { SuggestWidgetAdaptor } from '../model/suggestWidgetAdaptor.js';\nimport { localize } from '../../../../../nls.js';\nimport { IAccessibilityService } from '../../../../../platform/accessibility/common/accessibility.js';\nimport { AccessibilitySignal, IAccessibilitySignalService } from '../../../../../platform/accessibilitySignal/browser/accessibilitySignalService.js';\nimport { ICommandService } from '../../../../../platform/commands/common/commands.js';\nimport { IConfigurationService } from '../../../../../platform/configuration/common/configuration.js';\nimport { IContextKeyService } from '../../../../../platform/contextkey/common/contextkey.js';\nimport { IInstantiationService } from '../../../../../platform/instantiation/common/instantiation.js';\nimport { IKeybindingService } from '../../../../../platform/keybinding/common/keybinding.js';\nlet InlineCompletionsController = class InlineCompletionsController extends Disposable {\n    static { InlineCompletionsController_1 = this; }\n    static { this.ID = 'editor.contrib.inlineCompletionsController'; }\n    static get(editor) {\n        return editor.getContribution(InlineCompletionsController_1.ID);\n    }\n    constructor(editor, _instantiationService, _contextKeyService, _configurationService, _commandService, _debounceService, _languageFeaturesService, _accessibilitySignalService, _keybindingService, _accessibilityService) {\n        super();\n        this.editor = editor;\n        this._instantiationService = _instantiationService;\n        this._contextKeyService = _contextKeyService;\n        this._configurationService = _configurationService;\n        this._commandService = _commandService;\n        this._debounceService = _debounceService;\n        this._languageFeaturesService = _languageFeaturesService;\n        this._accessibilitySignalService = _accessibilitySignalService;\n        this._keybindingService = _keybindingService;\n        this._accessibilityService = _accessibilityService;\n        this._editorObs = observableCodeEditor(this.editor);\n        this._positions = derived(this, reader => this._editorObs.selections.read(reader)?.map(s => s.getEndPosition()) ?? [new Position(1, 1)]);\n        this._suggestWidgetAdaptor = this._register(new SuggestWidgetAdaptor(this.editor, () => {\n            this._editorObs.forceUpdate();\n            return this.model.get()?.selectedInlineCompletion.get()?.toSingleTextEdit(undefined);\n        }, (item) => this._editorObs.forceUpdate(_tx => {\n            /** @description InlineCompletionsController.handleSuggestAccepted */\n            this.model.get()?.handleSuggestAccepted(item);\n        })));\n        this._suggestWidgetSelectedItem = observableFromEvent(this, cb => this._suggestWidgetAdaptor.onDidSelectedItemChange(() => {\n            this._editorObs.forceUpdate(_tx => cb(undefined));\n        }), () => this._suggestWidgetAdaptor.selectedItem);\n        this._enabledInConfig = observableFromEvent(this, this.editor.onDidChangeConfiguration, () => this.editor.getOption(62 /* EditorOption.inlineSuggest */).enabled);\n        this._isScreenReaderEnabled = observableFromEvent(this, this._accessibilityService.onDidChangeScreenReaderOptimized, () => this._accessibilityService.isScreenReaderOptimized());\n        this._editorDictationInProgress = observableFromEvent(this, this._contextKeyService.onDidChangeContext, () => this._contextKeyService.getContext(this.editor.getDomNode()).getValue('editorDictation.inProgress') === true);\n        this._enabled = derived(this, reader => this._enabledInConfig.read(reader) && (!this._isScreenReaderEnabled.read(reader) || !this._editorDictationInProgress.read(reader)));\n        this._debounceValue = this._debounceService.for(this._languageFeaturesService.inlineCompletionsProvider, 'InlineCompletionsDebounce', { min: 50, max: 50 });\n        this.model = derivedDisposable(this, reader => {\n            if (this._editorObs.isReadonly.read(reader)) {\n                return undefined;\n            }\n            const textModel = this._editorObs.model.read(reader);\n            if (!textModel) {\n                return undefined;\n            }\n            const model = this._instantiationService.createInstance(InlineCompletionsModel, textModel, this._suggestWidgetSelectedItem, this._editorObs.versionId, this._positions, this._debounceValue, observableFromEvent(this.editor.onDidChangeConfiguration, () => this.editor.getOption(119 /* EditorOption.suggest */).preview), observableFromEvent(this.editor.onDidChangeConfiguration, () => this.editor.getOption(119 /* EditorOption.suggest */).previewMode), observableFromEvent(this.editor.onDidChangeConfiguration, () => this.editor.getOption(62 /* EditorOption.inlineSuggest */).mode), this._enabled);\n            return model;\n        }).recomputeInitiallyAndOnChange(this._store);\n        this._ghostTexts = derived(this, (reader) => {\n            const model = this.model.read(reader);\n            return model?.ghostTexts.read(reader) ?? [];\n        });\n        this._stablizedGhostTexts = convertItemsToStableObservables(this._ghostTexts, this._store);\n        this._ghostTextWidgets = mapObservableArrayCached(this, this._stablizedGhostTexts, (ghostText, store) => store.add(this._instantiationService.createInstance(GhostTextView, this.editor, {\n            ghostText: ghostText,\n            minReservedLineCount: constObservable(0),\n            targetTextModel: this.model.map(v => v?.textModel),\n        }))).recomputeInitiallyAndOnChange(this._store);\n        this._playAccessibilitySignal = observableSignal(this);\n        this._fontFamily = observableFromEvent(this, this.editor.onDidChangeConfiguration, () => this.editor.getOption(62 /* EditorOption.inlineSuggest */).fontFamily);\n        this._register(new InlineCompletionContextKeys(this._contextKeyService, this.model));\n        this._register(reactToChange(this._editorObs.onDidType, (_value, _changes) => {\n            if (this._enabled.get()) {\n                this.model.get()?.trigger();\n            }\n        }));\n        this._register(this._commandService.onDidExecuteCommand((e) => {\n            // These commands don't trigger onDidType.\n            const commands = new Set([\n                CoreEditingCommands.Tab.id,\n                CoreEditingCommands.DeleteLeft.id,\n                CoreEditingCommands.DeleteRight.id,\n                inlineSuggestCommitId,\n                'acceptSelectedSuggestion',\n            ]);\n            if (commands.has(e.commandId) && editor.hasTextFocus() && this._enabled.get()) {\n                this._editorObs.forceUpdate(tx => {\n                    /** @description onDidExecuteCommand */\n                    this.model.get()?.trigger(tx);\n                });\n            }\n        }));\n        this._register(reactToChange(this._editorObs.selections, (_value, changes) => {\n            if (changes.some(e => e.reason === 3 /* CursorChangeReason.Explicit */ || e.source === 'api')) {\n                this.model.get()?.stop();\n            }\n        }));\n        this._register(this.editor.onDidBlurEditorWidget(() => {\n            // This is a hidden setting very useful for debugging\n            if (this._contextKeyService.getContextKeyValue('accessibleViewIsShown')\n                || this._configurationService.getValue('editor.inlineSuggest.keepOnBlur')\n                || editor.getOption(62 /* EditorOption.inlineSuggest */).keepOnBlur\n                || InlineSuggestionHintsContentWidget.dropDownVisible) {\n                return;\n            }\n            transaction(tx => {\n                /** @description InlineCompletionsController.onDidBlurEditorWidget */\n                this.model.get()?.stop(tx);\n            });\n        }));\n        this._register(autorun(reader => {\n            /** @description InlineCompletionsController.forceRenderingAbove */\n            const state = this.model.read(reader)?.state.read(reader);\n            if (state?.suggestItem) {\n                if (state.primaryGhostText.lineCount >= 2) {\n                    this._suggestWidgetAdaptor.forceRenderingAbove();\n                }\n            }\n            else {\n                this._suggestWidgetAdaptor.stopForceRenderingAbove();\n            }\n        }));\n        this._register(toDisposable(() => {\n            this._suggestWidgetAdaptor.stopForceRenderingAbove();\n        }));\n        const currentInlineCompletionBySemanticId = derivedObservableWithCache(this, (reader, last) => {\n            const model = this.model.read(reader);\n            const state = model?.state.read(reader);\n            if (this._suggestWidgetSelectedItem.get()) {\n                return last;\n            }\n            return state?.inlineCompletion?.semanticId;\n        });\n        this._register(reactToChangeWithStore(derived(reader => {\n            this._playAccessibilitySignal.read(reader);\n            currentInlineCompletionBySemanticId.read(reader);\n            return {};\n        }), async (_value, _deltas, store) => {\n            /** @description InlineCompletionsController.playAccessibilitySignalAndReadSuggestion */\n            const model = this.model.get();\n            const state = model?.state.get();\n            if (!state || !model) {\n                return;\n            }\n            const lineText = model.textModel.getLineContent(state.primaryGhostText.lineNumber);\n            await timeout(50, cancelOnDispose(store));\n            await waitForState(this._suggestWidgetSelectedItem, isUndefined, () => false, cancelOnDispose(store));\n            await this._accessibilitySignalService.playSignal(AccessibilitySignal.inlineSuggestion);\n            if (this.editor.getOption(8 /* EditorOption.screenReaderAnnounceInlineSuggestion */)) {\n                this._provideScreenReaderUpdate(state.primaryGhostText.renderForScreenReader(lineText));\n            }\n        }));\n        this._register(new InlineCompletionsHintsWidget(this.editor, this.model, this._instantiationService));\n        this._register(createStyleSheetFromObservable(derived(reader => {\n            const fontFamily = this._fontFamily.read(reader);\n            if (fontFamily === '' || fontFamily === 'default') {\n                return '';\n            }\n            return `\n.monaco-editor .ghost-text-decoration,\n.monaco-editor .ghost-text-decoration-preview,\n.monaco-editor .ghost-text {\n\tfont-family: ${fontFamily};\n}`;\n        })));\n        // TODO@hediet\n        this._register(this._configurationService.onDidChangeConfiguration(e => {\n            if (e.affectsConfiguration('accessibility.verbosity.inlineCompletions')) {\n                this.editor.updateOptions({ inlineCompletionsAccessibilityVerbose: this._configurationService.getValue('accessibility.verbosity.inlineCompletions') });\n            }\n        }));\n        this.editor.updateOptions({ inlineCompletionsAccessibilityVerbose: this._configurationService.getValue('accessibility.verbosity.inlineCompletions') });\n    }\n    playAccessibilitySignal(tx) {\n        this._playAccessibilitySignal.trigger(tx);\n    }\n    _provideScreenReaderUpdate(content) {\n        const accessibleViewShowing = this._contextKeyService.getContextKeyValue('accessibleViewIsShown');\n        const accessibleViewKeybinding = this._keybindingService.lookupKeybinding('editor.action.accessibleView');\n        let hint;\n        if (!accessibleViewShowing && accessibleViewKeybinding && this.editor.getOption(150 /* EditorOption.inlineCompletionsAccessibilityVerbose */)) {\n            hint = localize('showAccessibleViewHint', \"Inspect this in the accessible view ({0})\", accessibleViewKeybinding.getAriaLabel());\n        }\n        alert(hint ? content + ', ' + hint : content);\n    }\n    shouldShowHoverAt(range) {\n        const ghostText = this.model.get()?.primaryGhostText.get();\n        if (ghostText) {\n            return ghostText.parts.some(p => range.containsPosition(new Position(ghostText.lineNumber, p.column)));\n        }\n        return false;\n    }\n    shouldShowHoverAtViewZone(viewZoneId) {\n        return this._ghostTextWidgets.get()[0]?.ownsViewZone(viewZoneId) ?? false;\n    }\n};\nInlineCompletionsController = InlineCompletionsController_1 = __decorate([\n    __param(1, IInstantiationService),\n    __param(2, IContextKeyService),\n    __param(3, IConfigurationService),\n    __param(4, ICommandService),\n    __param(5, ILanguageFeatureDebounceService),\n    __param(6, ILanguageFeaturesService),\n    __param(7, IAccessibilitySignalService),\n    __param(8, IKeybindingService),\n    __param(9, IAccessibilityService)\n], InlineCompletionsController);\nexport { InlineCompletionsController };\nfunction convertItemsToStableObservables(items, store) {\n    const result = observableValue('result', []);\n    const innerObservables = [];\n    store.add(autorun(reader => {\n        const itemsValue = items.read(reader);\n        transaction(tx => {\n            if (itemsValue.length !== innerObservables.length) {\n                innerObservables.length = itemsValue.length;\n                for (let i = 0; i < innerObservables.length; i++) {\n                    if (!innerObservables[i]) {\n                        innerObservables[i] = observableValue('item', itemsValue[i]);\n                    }\n                }\n                result.set([...innerObservables], tx);\n            }\n            innerObservables.forEach((o, i) => o.set(itemsValue[i], tx));\n        });\n    }));\n    return result;\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}