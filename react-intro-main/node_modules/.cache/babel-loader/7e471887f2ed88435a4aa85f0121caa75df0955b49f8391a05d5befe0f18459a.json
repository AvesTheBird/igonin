{"ast":null,"code":"/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { onUnexpectedError, transformErrorForSerialization } from '../errors.js';\nimport { Emitter } from '../event.js';\nimport { Disposable } from '../lifecycle.js';\nimport { FileAccess } from '../network.js';\nimport { isWeb } from '../platform.js';\nimport * as strings from '../strings.js';\n// ESM-comment-begin\n// const isESM = false;\n// ESM-comment-end\n// ESM-uncomment-begin\nconst isESM = true;\n// ESM-uncomment-end\nconst DEFAULT_CHANNEL = 'default';\nconst INITIALIZE = '$initialize';\nlet webWorkerWarningLogged = false;\nexport function logOnceWebWorkerWarning(err) {\n  if (!isWeb) {\n    // running tests\n    return;\n  }\n  if (!webWorkerWarningLogged) {\n    webWorkerWarningLogged = true;\n    console.warn('Could not create web worker(s). Falling back to loading web worker code in main thread, which might cause UI freezes. Please see https://github.com/microsoft/monaco-editor#faq');\n  }\n  console.warn(err.message);\n}\nclass RequestMessage {\n  constructor(vsWorker, req, channel, method, args) {\n    this.vsWorker = vsWorker;\n    this.req = req;\n    this.channel = channel;\n    this.method = method;\n    this.args = args;\n    this.type = 0 /* MessageType.Request */;\n  }\n}\nclass ReplyMessage {\n  constructor(vsWorker, seq, res, err) {\n    this.vsWorker = vsWorker;\n    this.seq = seq;\n    this.res = res;\n    this.err = err;\n    this.type = 1 /* MessageType.Reply */;\n  }\n}\nclass SubscribeEventMessage {\n  constructor(vsWorker, req, channel, eventName, arg) {\n    this.vsWorker = vsWorker;\n    this.req = req;\n    this.channel = channel;\n    this.eventName = eventName;\n    this.arg = arg;\n    this.type = 2 /* MessageType.SubscribeEvent */;\n  }\n}\nclass EventMessage {\n  constructor(vsWorker, req, event) {\n    this.vsWorker = vsWorker;\n    this.req = req;\n    this.event = event;\n    this.type = 3 /* MessageType.Event */;\n  }\n}\nclass UnsubscribeEventMessage {\n  constructor(vsWorker, req) {\n    this.vsWorker = vsWorker;\n    this.req = req;\n    this.type = 4 /* MessageType.UnsubscribeEvent */;\n  }\n}\nclass SimpleWorkerProtocol {\n  constructor(handler) {\n    this._workerId = -1;\n    this._handler = handler;\n    this._lastSentReq = 0;\n    this._pendingReplies = Object.create(null);\n    this._pendingEmitters = new Map();\n    this._pendingEvents = new Map();\n  }\n  setWorkerId(workerId) {\n    this._workerId = workerId;\n  }\n  sendMessage(channel, method, args) {\n    const req = String(++this._lastSentReq);\n    return new Promise((resolve, reject) => {\n      this._pendingReplies[req] = {\n        resolve: resolve,\n        reject: reject\n      };\n      this._send(new RequestMessage(this._workerId, req, channel, method, args));\n    });\n  }\n  listen(channel, eventName, arg) {\n    let req = null;\n    const emitter = new Emitter({\n      onWillAddFirstListener: () => {\n        req = String(++this._lastSentReq);\n        this._pendingEmitters.set(req, emitter);\n        this._send(new SubscribeEventMessage(this._workerId, req, channel, eventName, arg));\n      },\n      onDidRemoveLastListener: () => {\n        this._pendingEmitters.delete(req);\n        this._send(new UnsubscribeEventMessage(this._workerId, req));\n        req = null;\n      }\n    });\n    return emitter.event;\n  }\n  handleMessage(message) {\n    if (!message || !message.vsWorker) {\n      return;\n    }\n    if (this._workerId !== -1 && message.vsWorker !== this._workerId) {\n      return;\n    }\n    this._handleMessage(message);\n  }\n  createProxyToRemoteChannel(channel, sendMessageBarrier) {\n    var _this = this;\n    const handler = {\n      get: (target, name) => {\n        if (typeof name === 'string' && !target[name]) {\n          if (propertyIsDynamicEvent(name)) {\n            // onDynamic...\n            target[name] = arg => {\n              return this.listen(channel, name, arg);\n            };\n          } else if (propertyIsEvent(name)) {\n            // on...\n            target[name] = this.listen(channel, name, undefined);\n          } else if (name.charCodeAt(0) === 36 /* CharCode.DollarSign */) {\n            // $...\n            target[name] = async function () {\n              await (sendMessageBarrier === null || sendMessageBarrier === void 0 ? void 0 : sendMessageBarrier());\n              for (var _len = arguments.length, myArgs = new Array(_len), _key = 0; _key < _len; _key++) {\n                myArgs[_key] = arguments[_key];\n              }\n              return _this.sendMessage(channel, name, myArgs);\n            };\n          }\n        }\n        return target[name];\n      }\n    };\n    return new Proxy(Object.create(null), handler);\n  }\n  _handleMessage(msg) {\n    switch (msg.type) {\n      case 1 /* MessageType.Reply */:\n        return this._handleReplyMessage(msg);\n      case 0 /* MessageType.Request */:\n        return this._handleRequestMessage(msg);\n      case 2 /* MessageType.SubscribeEvent */:\n        return this._handleSubscribeEventMessage(msg);\n      case 3 /* MessageType.Event */:\n        return this._handleEventMessage(msg);\n      case 4 /* MessageType.UnsubscribeEvent */:\n        return this._handleUnsubscribeEventMessage(msg);\n    }\n  }\n  _handleReplyMessage(replyMessage) {\n    if (!this._pendingReplies[replyMessage.seq]) {\n      console.warn('Got reply to unknown seq');\n      return;\n    }\n    const reply = this._pendingReplies[replyMessage.seq];\n    delete this._pendingReplies[replyMessage.seq];\n    if (replyMessage.err) {\n      let err = replyMessage.err;\n      if (replyMessage.err.$isError) {\n        err = new Error();\n        err.name = replyMessage.err.name;\n        err.message = replyMessage.err.message;\n        err.stack = replyMessage.err.stack;\n      }\n      reply.reject(err);\n      return;\n    }\n    reply.resolve(replyMessage.res);\n  }\n  _handleRequestMessage(requestMessage) {\n    const req = requestMessage.req;\n    const result = this._handler.handleMessage(requestMessage.channel, requestMessage.method, requestMessage.args);\n    result.then(r => {\n      this._send(new ReplyMessage(this._workerId, req, r, undefined));\n    }, e => {\n      if (e.detail instanceof Error) {\n        // Loading errors have a detail property that points to the actual error\n        e.detail = transformErrorForSerialization(e.detail);\n      }\n      this._send(new ReplyMessage(this._workerId, req, undefined, transformErrorForSerialization(e)));\n    });\n  }\n  _handleSubscribeEventMessage(msg) {\n    const req = msg.req;\n    const disposable = this._handler.handleEvent(msg.channel, msg.eventName, msg.arg)(event => {\n      this._send(new EventMessage(this._workerId, req, event));\n    });\n    this._pendingEvents.set(req, disposable);\n  }\n  _handleEventMessage(msg) {\n    if (!this._pendingEmitters.has(msg.req)) {\n      console.warn('Got event for unknown req');\n      return;\n    }\n    this._pendingEmitters.get(msg.req).fire(msg.event);\n  }\n  _handleUnsubscribeEventMessage(msg) {\n    if (!this._pendingEvents.has(msg.req)) {\n      console.warn('Got unsubscribe for unknown req');\n      return;\n    }\n    this._pendingEvents.get(msg.req).dispose();\n    this._pendingEvents.delete(msg.req);\n  }\n  _send(msg) {\n    const transfer = [];\n    if (msg.type === 0 /* MessageType.Request */) {\n      for (let i = 0; i < msg.args.length; i++) {\n        if (msg.args[i] instanceof ArrayBuffer) {\n          transfer.push(msg.args[i]);\n        }\n      }\n    } else if (msg.type === 1 /* MessageType.Reply */) {\n      if (msg.res instanceof ArrayBuffer) {\n        transfer.push(msg.res);\n      }\n    }\n    this._handler.sendMessage(msg, transfer);\n  }\n}\n/**\n * Main thread side\n */\nexport class SimpleWorkerClient extends Disposable {\n  constructor(workerFactory, workerDescriptor) {\n    super();\n    this._localChannels = new Map();\n    this._worker = this._register(workerFactory.create({\n      amdModuleId: 'vs/base/common/worker/simpleWorker',\n      esmModuleLocation: workerDescriptor.esmModuleLocation,\n      label: workerDescriptor.label\n    }, msg => {\n      this._protocol.handleMessage(msg);\n    }, err => {\n      // in Firefox, web workers fail lazily :(\n      // we will reject the proxy\n      onUnexpectedError(err);\n    }));\n    this._protocol = new SimpleWorkerProtocol({\n      sendMessage: (msg, transfer) => {\n        this._worker.postMessage(msg, transfer);\n      },\n      handleMessage: (channel, method, args) => {\n        return this._handleMessage(channel, method, args);\n      },\n      handleEvent: (channel, eventName, arg) => {\n        return this._handleEvent(channel, eventName, arg);\n      }\n    });\n    this._protocol.setWorkerId(this._worker.getId());\n    // Gather loader configuration\n    let loaderConfiguration = null;\n    const globalRequire = globalThis.require;\n    if (typeof globalRequire !== 'undefined' && typeof globalRequire.getConfig === 'function') {\n      // Get the configuration from the Monaco AMD Loader\n      loaderConfiguration = globalRequire.getConfig();\n    } else if (typeof globalThis.requirejs !== 'undefined') {\n      // Get the configuration from requirejs\n      loaderConfiguration = globalThis.requirejs.s.contexts._.config;\n    }\n    // Send initialize message\n    this._onModuleLoaded = this._protocol.sendMessage(DEFAULT_CHANNEL, INITIALIZE, [this._worker.getId(), JSON.parse(JSON.stringify(loaderConfiguration)), workerDescriptor.amdModuleId]);\n    this.proxy = this._protocol.createProxyToRemoteChannel(DEFAULT_CHANNEL, async () => {\n      await this._onModuleLoaded;\n    });\n    this._onModuleLoaded.catch(e => {\n      this._onError('Worker failed to load ' + workerDescriptor.amdModuleId, e);\n    });\n  }\n  _handleMessage(channelName, method, args) {\n    const channel = this._localChannels.get(channelName);\n    if (!channel) {\n      return Promise.reject(new Error(\"Missing channel \".concat(channelName, \" on main thread\")));\n    }\n    if (typeof channel[method] !== 'function') {\n      return Promise.reject(new Error(\"Missing method \".concat(method, \" on main thread channel \").concat(channelName)));\n    }\n    try {\n      return Promise.resolve(channel[method].apply(channel, args));\n    } catch (e) {\n      return Promise.reject(e);\n    }\n  }\n  _handleEvent(channelName, eventName, arg) {\n    const channel = this._localChannels.get(channelName);\n    if (!channel) {\n      throw new Error(\"Missing channel \".concat(channelName, \" on main thread\"));\n    }\n    if (propertyIsDynamicEvent(eventName)) {\n      const event = channel[eventName].call(channel, arg);\n      if (typeof event !== 'function') {\n        throw new Error(\"Missing dynamic event \".concat(eventName, \" on main thread channel \").concat(channelName, \".\"));\n      }\n      return event;\n    }\n    if (propertyIsEvent(eventName)) {\n      const event = channel[eventName];\n      if (typeof event !== 'function') {\n        throw new Error(\"Missing event \".concat(eventName, \" on main thread channel \").concat(channelName, \".\"));\n      }\n      return event;\n    }\n    throw new Error(\"Malformed event name \".concat(eventName));\n  }\n  setChannel(channel, handler) {\n    this._localChannels.set(channel, handler);\n  }\n  _onError(message, error) {\n    console.error(message);\n    console.info(error);\n  }\n}\nfunction propertyIsEvent(name) {\n  // Assume a property is an event if it has a form of \"onSomething\"\n  return name[0] === 'o' && name[1] === 'n' && strings.isUpperAsciiLetter(name.charCodeAt(2));\n}\nfunction propertyIsDynamicEvent(name) {\n  // Assume a property is a dynamic event (a method that returns an event) if it has a form of \"onDynamicSomething\"\n  return /^onDynamic/.test(name) && strings.isUpperAsciiLetter(name.charCodeAt(9));\n}\n/**\n * Worker side\n */\nexport class SimpleWorkerServer {\n  constructor(postMessage, requestHandlerFactory) {\n    this._localChannels = new Map();\n    this._remoteChannels = new Map();\n    this._requestHandlerFactory = requestHandlerFactory;\n    this._requestHandler = null;\n    this._protocol = new SimpleWorkerProtocol({\n      sendMessage: (msg, transfer) => {\n        postMessage(msg, transfer);\n      },\n      handleMessage: (channel, method, args) => this._handleMessage(channel, method, args),\n      handleEvent: (channel, eventName, arg) => this._handleEvent(channel, eventName, arg)\n    });\n  }\n  onmessage(msg) {\n    this._protocol.handleMessage(msg);\n  }\n  _handleMessage(channel, method, args) {\n    if (channel === DEFAULT_CHANNEL && method === INITIALIZE) {\n      return this.initialize(args[0], args[1], args[2]);\n    }\n    const requestHandler = channel === DEFAULT_CHANNEL ? this._requestHandler : this._localChannels.get(channel);\n    if (!requestHandler) {\n      return Promise.reject(new Error(\"Missing channel \".concat(channel, \" on worker thread\")));\n    }\n    if (typeof requestHandler[method] !== 'function') {\n      return Promise.reject(new Error(\"Missing method \".concat(method, \" on worker thread channel \").concat(channel)));\n    }\n    try {\n      return Promise.resolve(requestHandler[method].apply(requestHandler, args));\n    } catch (e) {\n      return Promise.reject(e);\n    }\n  }\n  _handleEvent(channel, eventName, arg) {\n    const requestHandler = channel === DEFAULT_CHANNEL ? this._requestHandler : this._localChannels.get(channel);\n    if (!requestHandler) {\n      throw new Error(\"Missing channel \".concat(channel, \" on worker thread\"));\n    }\n    if (propertyIsDynamicEvent(eventName)) {\n      const event = requestHandler[eventName].call(requestHandler, arg);\n      if (typeof event !== 'function') {\n        throw new Error(\"Missing dynamic event \".concat(eventName, \" on request handler.\"));\n      }\n      return event;\n    }\n    if (propertyIsEvent(eventName)) {\n      const event = requestHandler[eventName];\n      if (typeof event !== 'function') {\n        throw new Error(\"Missing event \".concat(eventName, \" on request handler.\"));\n      }\n      return event;\n    }\n    throw new Error(\"Malformed event name \".concat(eventName));\n  }\n  getChannel(channel) {\n    if (!this._remoteChannels.has(channel)) {\n      const inst = this._protocol.createProxyToRemoteChannel(channel);\n      this._remoteChannels.set(channel, inst);\n    }\n    return this._remoteChannels.get(channel);\n  }\n  async initialize(workerId, loaderConfig, moduleId) {\n    this._protocol.setWorkerId(workerId);\n    if (this._requestHandlerFactory) {\n      // static request handler\n      this._requestHandler = this._requestHandlerFactory(this);\n      return;\n    }\n    if (loaderConfig) {\n      // Remove 'baseUrl', handling it is beyond scope for now\n      if (typeof loaderConfig.baseUrl !== 'undefined') {\n        delete loaderConfig['baseUrl'];\n      }\n      if (typeof loaderConfig.paths !== 'undefined') {\n        if (typeof loaderConfig.paths.vs !== 'undefined') {\n          delete loaderConfig.paths['vs'];\n        }\n      }\n      if (typeof loaderConfig.trustedTypesPolicy !== 'undefined') {\n        // don't use, it has been destroyed during serialize\n        delete loaderConfig['trustedTypesPolicy'];\n      }\n      // Since this is in a web worker, enable catching errors\n      loaderConfig.catchError = true;\n      globalThis.require.config(loaderConfig);\n    }\n    if (isESM) {\n      const url = FileAccess.asBrowserUri(\"\".concat(moduleId, \".js\")).toString(true);\n      return import(\"\".concat(url)).then(module => {\n        this._requestHandler = module.create(this);\n        if (!this._requestHandler) {\n          throw new Error(\"No RequestHandler!\");\n        }\n      });\n    }\n    return new Promise((resolve, reject) => {\n      // Use the global require to be sure to get the global config\n      // ESM-comment-begin\n      // \t\t\tconst req = (globalThis.require || require);\n      // ESM-comment-end\n      // ESM-uncomment-begin\n      const req = globalThis.require;\n      // ESM-uncomment-end\n      req([moduleId], module => {\n        this._requestHandler = module.create(this);\n        if (!this._requestHandler) {\n          reject(new Error(\"No RequestHandler!\"));\n          return;\n        }\n        resolve();\n      }, reject);\n    });\n  }\n}\n/**\n * Defines the worker entry point. Must be exported and named `create`.\n * @skipMangle\n */\nexport function create(postMessage) {\n  return new SimpleWorkerServer(postMessage, null);\n}","map":{"version":3,"names":["onUnexpectedError","transformErrorForSerialization","Emitter","Disposable","FileAccess","isWeb","strings","isESM","DEFAULT_CHANNEL","INITIALIZE","webWorkerWarningLogged","logOnceWebWorkerWarning","err","console","warn","message","RequestMessage","constructor","vsWorker","req","channel","method","args","type","ReplyMessage","seq","res","SubscribeEventMessage","eventName","arg","EventMessage","event","UnsubscribeEventMessage","SimpleWorkerProtocol","handler","_workerId","_handler","_lastSentReq","_pendingReplies","Object","create","_pendingEmitters","Map","_pendingEvents","setWorkerId","workerId","sendMessage","String","Promise","resolve","reject","_send","listen","emitter","onWillAddFirstListener","set","onDidRemoveLastListener","delete","handleMessage","_handleMessage","createProxyToRemoteChannel","sendMessageBarrier","_this","get","target","name","propertyIsDynamicEvent","propertyIsEvent","undefined","charCodeAt","_len","arguments","length","myArgs","Array","_key","Proxy","msg","_handleReplyMessage","_handleRequestMessage","_handleSubscribeEventMessage","_handleEventMessage","_handleUnsubscribeEventMessage","replyMessage","reply","$isError","Error","stack","requestMessage","result","then","r","e","detail","disposable","handleEvent","has","fire","dispose","transfer","i","ArrayBuffer","push","SimpleWorkerClient","workerFactory","workerDescriptor","_localChannels","_worker","_register","amdModuleId","esmModuleLocation","label","_protocol","postMessage","_handleEvent","getId","loaderConfiguration","globalRequire","globalThis","require","getConfig","requirejs","s","contexts","_","config","_onModuleLoaded","JSON","parse","stringify","proxy","catch","_onError","channelName","concat","apply","call","setChannel","error","info","isUpperAsciiLetter","test","SimpleWorkerServer","requestHandlerFactory","_remoteChannels","_requestHandlerFactory","_requestHandler","onmessage","initialize","requestHandler","getChannel","inst","loaderConfig","moduleId","baseUrl","paths","vs","trustedTypesPolicy","catchError","url","asBrowserUri","toString","module"],"sources":["D:/ospanel/domains/react/react-intro-main/node_modules/monaco-editor/esm/vs/base/common/worker/simpleWorker.js"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { onUnexpectedError, transformErrorForSerialization } from '../errors.js';\nimport { Emitter } from '../event.js';\nimport { Disposable } from '../lifecycle.js';\nimport { FileAccess } from '../network.js';\nimport { isWeb } from '../platform.js';\nimport * as strings from '../strings.js';\n// ESM-comment-begin\n// const isESM = false;\n// ESM-comment-end\n// ESM-uncomment-begin\nconst isESM = true;\n// ESM-uncomment-end\nconst DEFAULT_CHANNEL = 'default';\nconst INITIALIZE = '$initialize';\nlet webWorkerWarningLogged = false;\nexport function logOnceWebWorkerWarning(err) {\n    if (!isWeb) {\n        // running tests\n        return;\n    }\n    if (!webWorkerWarningLogged) {\n        webWorkerWarningLogged = true;\n        console.warn('Could not create web worker(s). Falling back to loading web worker code in main thread, which might cause UI freezes. Please see https://github.com/microsoft/monaco-editor#faq');\n    }\n    console.warn(err.message);\n}\nclass RequestMessage {\n    constructor(vsWorker, req, channel, method, args) {\n        this.vsWorker = vsWorker;\n        this.req = req;\n        this.channel = channel;\n        this.method = method;\n        this.args = args;\n        this.type = 0 /* MessageType.Request */;\n    }\n}\nclass ReplyMessage {\n    constructor(vsWorker, seq, res, err) {\n        this.vsWorker = vsWorker;\n        this.seq = seq;\n        this.res = res;\n        this.err = err;\n        this.type = 1 /* MessageType.Reply */;\n    }\n}\nclass SubscribeEventMessage {\n    constructor(vsWorker, req, channel, eventName, arg) {\n        this.vsWorker = vsWorker;\n        this.req = req;\n        this.channel = channel;\n        this.eventName = eventName;\n        this.arg = arg;\n        this.type = 2 /* MessageType.SubscribeEvent */;\n    }\n}\nclass EventMessage {\n    constructor(vsWorker, req, event) {\n        this.vsWorker = vsWorker;\n        this.req = req;\n        this.event = event;\n        this.type = 3 /* MessageType.Event */;\n    }\n}\nclass UnsubscribeEventMessage {\n    constructor(vsWorker, req) {\n        this.vsWorker = vsWorker;\n        this.req = req;\n        this.type = 4 /* MessageType.UnsubscribeEvent */;\n    }\n}\nclass SimpleWorkerProtocol {\n    constructor(handler) {\n        this._workerId = -1;\n        this._handler = handler;\n        this._lastSentReq = 0;\n        this._pendingReplies = Object.create(null);\n        this._pendingEmitters = new Map();\n        this._pendingEvents = new Map();\n    }\n    setWorkerId(workerId) {\n        this._workerId = workerId;\n    }\n    sendMessage(channel, method, args) {\n        const req = String(++this._lastSentReq);\n        return new Promise((resolve, reject) => {\n            this._pendingReplies[req] = {\n                resolve: resolve,\n                reject: reject\n            };\n            this._send(new RequestMessage(this._workerId, req, channel, method, args));\n        });\n    }\n    listen(channel, eventName, arg) {\n        let req = null;\n        const emitter = new Emitter({\n            onWillAddFirstListener: () => {\n                req = String(++this._lastSentReq);\n                this._pendingEmitters.set(req, emitter);\n                this._send(new SubscribeEventMessage(this._workerId, req, channel, eventName, arg));\n            },\n            onDidRemoveLastListener: () => {\n                this._pendingEmitters.delete(req);\n                this._send(new UnsubscribeEventMessage(this._workerId, req));\n                req = null;\n            }\n        });\n        return emitter.event;\n    }\n    handleMessage(message) {\n        if (!message || !message.vsWorker) {\n            return;\n        }\n        if (this._workerId !== -1 && message.vsWorker !== this._workerId) {\n            return;\n        }\n        this._handleMessage(message);\n    }\n    createProxyToRemoteChannel(channel, sendMessageBarrier) {\n        const handler = {\n            get: (target, name) => {\n                if (typeof name === 'string' && !target[name]) {\n                    if (propertyIsDynamicEvent(name)) { // onDynamic...\n                        target[name] = (arg) => {\n                            return this.listen(channel, name, arg);\n                        };\n                    }\n                    else if (propertyIsEvent(name)) { // on...\n                        target[name] = this.listen(channel, name, undefined);\n                    }\n                    else if (name.charCodeAt(0) === 36 /* CharCode.DollarSign */) { // $...\n                        target[name] = async (...myArgs) => {\n                            await sendMessageBarrier?.();\n                            return this.sendMessage(channel, name, myArgs);\n                        };\n                    }\n                }\n                return target[name];\n            }\n        };\n        return new Proxy(Object.create(null), handler);\n    }\n    _handleMessage(msg) {\n        switch (msg.type) {\n            case 1 /* MessageType.Reply */:\n                return this._handleReplyMessage(msg);\n            case 0 /* MessageType.Request */:\n                return this._handleRequestMessage(msg);\n            case 2 /* MessageType.SubscribeEvent */:\n                return this._handleSubscribeEventMessage(msg);\n            case 3 /* MessageType.Event */:\n                return this._handleEventMessage(msg);\n            case 4 /* MessageType.UnsubscribeEvent */:\n                return this._handleUnsubscribeEventMessage(msg);\n        }\n    }\n    _handleReplyMessage(replyMessage) {\n        if (!this._pendingReplies[replyMessage.seq]) {\n            console.warn('Got reply to unknown seq');\n            return;\n        }\n        const reply = this._pendingReplies[replyMessage.seq];\n        delete this._pendingReplies[replyMessage.seq];\n        if (replyMessage.err) {\n            let err = replyMessage.err;\n            if (replyMessage.err.$isError) {\n                err = new Error();\n                err.name = replyMessage.err.name;\n                err.message = replyMessage.err.message;\n                err.stack = replyMessage.err.stack;\n            }\n            reply.reject(err);\n            return;\n        }\n        reply.resolve(replyMessage.res);\n    }\n    _handleRequestMessage(requestMessage) {\n        const req = requestMessage.req;\n        const result = this._handler.handleMessage(requestMessage.channel, requestMessage.method, requestMessage.args);\n        result.then((r) => {\n            this._send(new ReplyMessage(this._workerId, req, r, undefined));\n        }, (e) => {\n            if (e.detail instanceof Error) {\n                // Loading errors have a detail property that points to the actual error\n                e.detail = transformErrorForSerialization(e.detail);\n            }\n            this._send(new ReplyMessage(this._workerId, req, undefined, transformErrorForSerialization(e)));\n        });\n    }\n    _handleSubscribeEventMessage(msg) {\n        const req = msg.req;\n        const disposable = this._handler.handleEvent(msg.channel, msg.eventName, msg.arg)((event) => {\n            this._send(new EventMessage(this._workerId, req, event));\n        });\n        this._pendingEvents.set(req, disposable);\n    }\n    _handleEventMessage(msg) {\n        if (!this._pendingEmitters.has(msg.req)) {\n            console.warn('Got event for unknown req');\n            return;\n        }\n        this._pendingEmitters.get(msg.req).fire(msg.event);\n    }\n    _handleUnsubscribeEventMessage(msg) {\n        if (!this._pendingEvents.has(msg.req)) {\n            console.warn('Got unsubscribe for unknown req');\n            return;\n        }\n        this._pendingEvents.get(msg.req).dispose();\n        this._pendingEvents.delete(msg.req);\n    }\n    _send(msg) {\n        const transfer = [];\n        if (msg.type === 0 /* MessageType.Request */) {\n            for (let i = 0; i < msg.args.length; i++) {\n                if (msg.args[i] instanceof ArrayBuffer) {\n                    transfer.push(msg.args[i]);\n                }\n            }\n        }\n        else if (msg.type === 1 /* MessageType.Reply */) {\n            if (msg.res instanceof ArrayBuffer) {\n                transfer.push(msg.res);\n            }\n        }\n        this._handler.sendMessage(msg, transfer);\n    }\n}\n/**\n * Main thread side\n */\nexport class SimpleWorkerClient extends Disposable {\n    constructor(workerFactory, workerDescriptor) {\n        super();\n        this._localChannels = new Map();\n        this._worker = this._register(workerFactory.create({\n            amdModuleId: 'vs/base/common/worker/simpleWorker',\n            esmModuleLocation: workerDescriptor.esmModuleLocation,\n            label: workerDescriptor.label\n        }, (msg) => {\n            this._protocol.handleMessage(msg);\n        }, (err) => {\n            // in Firefox, web workers fail lazily :(\n            // we will reject the proxy\n            onUnexpectedError(err);\n        }));\n        this._protocol = new SimpleWorkerProtocol({\n            sendMessage: (msg, transfer) => {\n                this._worker.postMessage(msg, transfer);\n            },\n            handleMessage: (channel, method, args) => {\n                return this._handleMessage(channel, method, args);\n            },\n            handleEvent: (channel, eventName, arg) => {\n                return this._handleEvent(channel, eventName, arg);\n            }\n        });\n        this._protocol.setWorkerId(this._worker.getId());\n        // Gather loader configuration\n        let loaderConfiguration = null;\n        const globalRequire = globalThis.require;\n        if (typeof globalRequire !== 'undefined' && typeof globalRequire.getConfig === 'function') {\n            // Get the configuration from the Monaco AMD Loader\n            loaderConfiguration = globalRequire.getConfig();\n        }\n        else if (typeof globalThis.requirejs !== 'undefined') {\n            // Get the configuration from requirejs\n            loaderConfiguration = globalThis.requirejs.s.contexts._.config;\n        }\n        // Send initialize message\n        this._onModuleLoaded = this._protocol.sendMessage(DEFAULT_CHANNEL, INITIALIZE, [\n            this._worker.getId(),\n            JSON.parse(JSON.stringify(loaderConfiguration)),\n            workerDescriptor.amdModuleId,\n        ]);\n        this.proxy = this._protocol.createProxyToRemoteChannel(DEFAULT_CHANNEL, async () => { await this._onModuleLoaded; });\n        this._onModuleLoaded.catch((e) => {\n            this._onError('Worker failed to load ' + workerDescriptor.amdModuleId, e);\n        });\n    }\n    _handleMessage(channelName, method, args) {\n        const channel = this._localChannels.get(channelName);\n        if (!channel) {\n            return Promise.reject(new Error(`Missing channel ${channelName} on main thread`));\n        }\n        if (typeof channel[method] !== 'function') {\n            return Promise.reject(new Error(`Missing method ${method} on main thread channel ${channelName}`));\n        }\n        try {\n            return Promise.resolve(channel[method].apply(channel, args));\n        }\n        catch (e) {\n            return Promise.reject(e);\n        }\n    }\n    _handleEvent(channelName, eventName, arg) {\n        const channel = this._localChannels.get(channelName);\n        if (!channel) {\n            throw new Error(`Missing channel ${channelName} on main thread`);\n        }\n        if (propertyIsDynamicEvent(eventName)) {\n            const event = channel[eventName].call(channel, arg);\n            if (typeof event !== 'function') {\n                throw new Error(`Missing dynamic event ${eventName} on main thread channel ${channelName}.`);\n            }\n            return event;\n        }\n        if (propertyIsEvent(eventName)) {\n            const event = channel[eventName];\n            if (typeof event !== 'function') {\n                throw new Error(`Missing event ${eventName} on main thread channel ${channelName}.`);\n            }\n            return event;\n        }\n        throw new Error(`Malformed event name ${eventName}`);\n    }\n    setChannel(channel, handler) {\n        this._localChannels.set(channel, handler);\n    }\n    _onError(message, error) {\n        console.error(message);\n        console.info(error);\n    }\n}\nfunction propertyIsEvent(name) {\n    // Assume a property is an event if it has a form of \"onSomething\"\n    return name[0] === 'o' && name[1] === 'n' && strings.isUpperAsciiLetter(name.charCodeAt(2));\n}\nfunction propertyIsDynamicEvent(name) {\n    // Assume a property is a dynamic event (a method that returns an event) if it has a form of \"onDynamicSomething\"\n    return /^onDynamic/.test(name) && strings.isUpperAsciiLetter(name.charCodeAt(9));\n}\n/**\n * Worker side\n */\nexport class SimpleWorkerServer {\n    constructor(postMessage, requestHandlerFactory) {\n        this._localChannels = new Map();\n        this._remoteChannels = new Map();\n        this._requestHandlerFactory = requestHandlerFactory;\n        this._requestHandler = null;\n        this._protocol = new SimpleWorkerProtocol({\n            sendMessage: (msg, transfer) => {\n                postMessage(msg, transfer);\n            },\n            handleMessage: (channel, method, args) => this._handleMessage(channel, method, args),\n            handleEvent: (channel, eventName, arg) => this._handleEvent(channel, eventName, arg)\n        });\n    }\n    onmessage(msg) {\n        this._protocol.handleMessage(msg);\n    }\n    _handleMessage(channel, method, args) {\n        if (channel === DEFAULT_CHANNEL && method === INITIALIZE) {\n            return this.initialize(args[0], args[1], args[2]);\n        }\n        const requestHandler = (channel === DEFAULT_CHANNEL ? this._requestHandler : this._localChannels.get(channel));\n        if (!requestHandler) {\n            return Promise.reject(new Error(`Missing channel ${channel} on worker thread`));\n        }\n        if (typeof requestHandler[method] !== 'function') {\n            return Promise.reject(new Error(`Missing method ${method} on worker thread channel ${channel}`));\n        }\n        try {\n            return Promise.resolve(requestHandler[method].apply(requestHandler, args));\n        }\n        catch (e) {\n            return Promise.reject(e);\n        }\n    }\n    _handleEvent(channel, eventName, arg) {\n        const requestHandler = (channel === DEFAULT_CHANNEL ? this._requestHandler : this._localChannels.get(channel));\n        if (!requestHandler) {\n            throw new Error(`Missing channel ${channel} on worker thread`);\n        }\n        if (propertyIsDynamicEvent(eventName)) {\n            const event = requestHandler[eventName].call(requestHandler, arg);\n            if (typeof event !== 'function') {\n                throw new Error(`Missing dynamic event ${eventName} on request handler.`);\n            }\n            return event;\n        }\n        if (propertyIsEvent(eventName)) {\n            const event = requestHandler[eventName];\n            if (typeof event !== 'function') {\n                throw new Error(`Missing event ${eventName} on request handler.`);\n            }\n            return event;\n        }\n        throw new Error(`Malformed event name ${eventName}`);\n    }\n    getChannel(channel) {\n        if (!this._remoteChannels.has(channel)) {\n            const inst = this._protocol.createProxyToRemoteChannel(channel);\n            this._remoteChannels.set(channel, inst);\n        }\n        return this._remoteChannels.get(channel);\n    }\n    async initialize(workerId, loaderConfig, moduleId) {\n        this._protocol.setWorkerId(workerId);\n        if (this._requestHandlerFactory) {\n            // static request handler\n            this._requestHandler = this._requestHandlerFactory(this);\n            return;\n        }\n        if (loaderConfig) {\n            // Remove 'baseUrl', handling it is beyond scope for now\n            if (typeof loaderConfig.baseUrl !== 'undefined') {\n                delete loaderConfig['baseUrl'];\n            }\n            if (typeof loaderConfig.paths !== 'undefined') {\n                if (typeof loaderConfig.paths.vs !== 'undefined') {\n                    delete loaderConfig.paths['vs'];\n                }\n            }\n            if (typeof loaderConfig.trustedTypesPolicy !== 'undefined') {\n                // don't use, it has been destroyed during serialize\n                delete loaderConfig['trustedTypesPolicy'];\n            }\n            // Since this is in a web worker, enable catching errors\n            loaderConfig.catchError = true;\n            globalThis.require.config(loaderConfig);\n        }\n        if (isESM) {\n            const url = FileAccess.asBrowserUri(`${moduleId}.js`).toString(true);\n            return import(`${url}`).then((module) => {\n                this._requestHandler = module.create(this);\n                if (!this._requestHandler) {\n                    throw new Error(`No RequestHandler!`);\n                }\n            });\n        }\n        return new Promise((resolve, reject) => {\n            // Use the global require to be sure to get the global config\n            // ESM-comment-begin\n            // \t\t\tconst req = (globalThis.require || require);\n            // ESM-comment-end\n            // ESM-uncomment-begin\n            const req = globalThis.require;\n            // ESM-uncomment-end\n            req([moduleId], (module) => {\n                this._requestHandler = module.create(this);\n                if (!this._requestHandler) {\n                    reject(new Error(`No RequestHandler!`));\n                    return;\n                }\n                resolve();\n            }, reject);\n        });\n    }\n}\n/**\n * Defines the worker entry point. Must be exported and named `create`.\n * @skipMangle\n */\nexport function create(postMessage) {\n    return new SimpleWorkerServer(postMessage, null);\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}