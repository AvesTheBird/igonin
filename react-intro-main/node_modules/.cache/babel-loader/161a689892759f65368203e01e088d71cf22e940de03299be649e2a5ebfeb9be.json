{"ast":null,"code":"/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n    r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n    d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = this && this.__param || function (paramIndex, decorator) {\n  return function (target, key) {\n    decorator(target, key, paramIndex);\n  };\n};\nimport * as dom from '../../../../base/browser/dom.js';\nimport { asArray, compareBy, numberComparator } from '../../../../base/common/arrays.js';\nimport { CancellationTokenSource } from '../../../../base/common/cancellation.js';\nimport { isEmptyMarkdownString, MarkdownString } from '../../../../base/common/htmlContent.js';\nimport { DisposableStore, toDisposable } from '../../../../base/common/lifecycle.js';\nimport { MarkdownRenderer } from '../../../browser/widget/markdownRenderer/browser/markdownRenderer.js';\nimport { DECREASE_HOVER_VERBOSITY_ACTION_ID, INCREASE_HOVER_VERBOSITY_ACTION_ID } from './hoverActionIds.js';\nimport { Range } from '../../../common/core/range.js';\nimport { ILanguageService } from '../../../common/languages/language.js';\nimport { RenderedHoverParts } from './hoverTypes.js';\nimport * as nls from '../../../../nls.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nimport { IOpenerService } from '../../../../platform/opener/common/opener.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { HoverVerbosityAction } from '../../../common/languages.js';\nimport { registerIcon } from '../../../../platform/theme/common/iconRegistry.js';\nimport { Codicon } from '../../../../base/common/codicons.js';\nimport { ThemeIcon } from '../../../../base/common/themables.js';\nimport { onUnexpectedExternalError } from '../../../../base/common/errors.js';\nimport { IKeybindingService } from '../../../../platform/keybinding/common/keybinding.js';\nimport { ClickAction, KeyDownAction } from '../../../../base/browser/ui/hover/hoverWidget.js';\nimport { IHoverService, WorkbenchHoverDelegate } from '../../../../platform/hover/browser/hover.js';\nimport { AsyncIterableObject } from '../../../../base/common/async.js';\nimport { getHoverProviderResultsAsAsyncIterable } from './getHover.js';\nimport { ICommandService } from '../../../../platform/commands/common/commands.js';\nconst $ = dom.$;\nconst increaseHoverVerbosityIcon = registerIcon('hover-increase-verbosity', Codicon.add, nls.localize('increaseHoverVerbosity', 'Icon for increaseing hover verbosity.'));\nconst decreaseHoverVerbosityIcon = registerIcon('hover-decrease-verbosity', Codicon.remove, nls.localize('decreaseHoverVerbosity', 'Icon for decreasing hover verbosity.'));\nexport class MarkdownHover {\n  constructor(owner, range, contents, isBeforeContent, ordinal) {\n    let source = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : undefined;\n    this.owner = owner;\n    this.range = range;\n    this.contents = contents;\n    this.isBeforeContent = isBeforeContent;\n    this.ordinal = ordinal;\n    this.source = source;\n  }\n  isValidForHoverAnchor(anchor) {\n    return anchor.type === 1 /* HoverAnchorType.Range */ && this.range.startColumn <= anchor.range.startColumn && this.range.endColumn >= anchor.range.endColumn;\n  }\n}\nclass HoverSource {\n  constructor(hover, hoverProvider, hoverPosition) {\n    this.hover = hover;\n    this.hoverProvider = hoverProvider;\n    this.hoverPosition = hoverPosition;\n  }\n  supportsVerbosityAction(hoverVerbosityAction) {\n    var _this$hover$canIncrea, _this$hover$canDecrea;\n    switch (hoverVerbosityAction) {\n      case HoverVerbosityAction.Increase:\n        return (_this$hover$canIncrea = this.hover.canIncreaseVerbosity) !== null && _this$hover$canIncrea !== void 0 ? _this$hover$canIncrea : false;\n      case HoverVerbosityAction.Decrease:\n        return (_this$hover$canDecrea = this.hover.canDecreaseVerbosity) !== null && _this$hover$canDecrea !== void 0 ? _this$hover$canDecrea : false;\n    }\n  }\n}\nlet MarkdownHoverParticipant = class MarkdownHoverParticipant {\n  constructor(_editor, _languageService, _openerService, _configurationService, _languageFeaturesService, _keybindingService, _hoverService, _commandService) {\n    this._editor = _editor;\n    this._languageService = _languageService;\n    this._openerService = _openerService;\n    this._configurationService = _configurationService;\n    this._languageFeaturesService = _languageFeaturesService;\n    this._keybindingService = _keybindingService;\n    this._hoverService = _hoverService;\n    this._commandService = _commandService;\n    this.hoverOrdinal = 3;\n  }\n  createLoadingMessage(anchor) {\n    return new MarkdownHover(this, anchor.range, [new MarkdownString().appendText(nls.localize('modesContentHover.loading', \"Loading...\"))], false, 2000);\n  }\n  computeSync(anchor, lineDecorations) {\n    if (!this._editor.hasModel() || anchor.type !== 1 /* HoverAnchorType.Range */) {\n      return [];\n    }\n    const model = this._editor.getModel();\n    const lineNumber = anchor.range.startLineNumber;\n    const maxColumn = model.getLineMaxColumn(lineNumber);\n    const result = [];\n    let index = 1000;\n    const lineLength = model.getLineLength(lineNumber);\n    const languageId = model.getLanguageIdAtPosition(anchor.range.startLineNumber, anchor.range.startColumn);\n    const stopRenderingLineAfter = this._editor.getOption(118 /* EditorOption.stopRenderingLineAfter */);\n    const maxTokenizationLineLength = this._configurationService.getValue('editor.maxTokenizationLineLength', {\n      overrideIdentifier: languageId\n    });\n    let stopRenderingMessage = false;\n    if (stopRenderingLineAfter >= 0 && lineLength > stopRenderingLineAfter && anchor.range.startColumn >= stopRenderingLineAfter) {\n      stopRenderingMessage = true;\n      result.push(new MarkdownHover(this, anchor.range, [{\n        value: nls.localize('stopped rendering', \"Rendering paused for long line for performance reasons. This can be configured via `editor.stopRenderingLineAfter`.\")\n      }], false, index++));\n    }\n    if (!stopRenderingMessage && typeof maxTokenizationLineLength === 'number' && lineLength >= maxTokenizationLineLength) {\n      result.push(new MarkdownHover(this, anchor.range, [{\n        value: nls.localize('too many characters', \"Tokenization is skipped for long lines for performance reasons. This can be configured via `editor.maxTokenizationLineLength`.\")\n      }], false, index++));\n    }\n    let isBeforeContent = false;\n    for (const d of lineDecorations) {\n      const startColumn = d.range.startLineNumber === lineNumber ? d.range.startColumn : 1;\n      const endColumn = d.range.endLineNumber === lineNumber ? d.range.endColumn : maxColumn;\n      const hoverMessage = d.options.hoverMessage;\n      if (!hoverMessage || isEmptyMarkdownString(hoverMessage)) {\n        continue;\n      }\n      if (d.options.beforeContentClassName) {\n        isBeforeContent = true;\n      }\n      const range = new Range(anchor.range.startLineNumber, startColumn, anchor.range.startLineNumber, endColumn);\n      result.push(new MarkdownHover(this, range, asArray(hoverMessage), isBeforeContent, index++));\n    }\n    return result;\n  }\n  computeAsync(anchor, lineDecorations, token) {\n    if (!this._editor.hasModel() || anchor.type !== 1 /* HoverAnchorType.Range */) {\n      return AsyncIterableObject.EMPTY;\n    }\n    const model = this._editor.getModel();\n    const hoverProviderRegistry = this._languageFeaturesService.hoverProvider;\n    if (!hoverProviderRegistry.has(model)) {\n      return AsyncIterableObject.EMPTY;\n    }\n    const markdownHovers = this._getMarkdownHovers(hoverProviderRegistry, model, anchor, token);\n    return markdownHovers;\n  }\n  _getMarkdownHovers(hoverProviderRegistry, model, anchor, token) {\n    const position = anchor.range.getStartPosition();\n    const hoverProviderResults = getHoverProviderResultsAsAsyncIterable(hoverProviderRegistry, model, position, token);\n    const markdownHovers = hoverProviderResults.filter(item => !isEmptyMarkdownString(item.hover.contents)).map(item => {\n      const range = item.hover.range ? Range.lift(item.hover.range) : anchor.range;\n      const hoverSource = new HoverSource(item.hover, item.provider, position);\n      return new MarkdownHover(this, range, item.hover.contents, false, item.ordinal, hoverSource);\n    });\n    return markdownHovers;\n  }\n  renderHoverParts(context, hoverParts) {\n    this._renderedHoverParts = new MarkdownRenderedHoverParts(hoverParts, context.fragment, this, this._editor, this._languageService, this._openerService, this._commandService, this._keybindingService, this._hoverService, this._configurationService, context.onContentsChanged);\n    return this._renderedHoverParts;\n  }\n  updateMarkdownHoverVerbosityLevel(action, index, focus) {\n    var _this$_renderedHoverP;\n    return Promise.resolve((_this$_renderedHoverP = this._renderedHoverParts) === null || _this$_renderedHoverP === void 0 ? void 0 : _this$_renderedHoverP.updateMarkdownHoverPartVerbosityLevel(action, index, focus));\n  }\n};\nMarkdownHoverParticipant = __decorate([__param(1, ILanguageService), __param(2, IOpenerService), __param(3, IConfigurationService), __param(4, ILanguageFeaturesService), __param(5, IKeybindingService), __param(6, IHoverService), __param(7, ICommandService)], MarkdownHoverParticipant);\nexport { MarkdownHoverParticipant };\nclass RenderedMarkdownHoverPart {\n  constructor(hoverPart, hoverElement, disposables) {\n    this.hoverPart = hoverPart;\n    this.hoverElement = hoverElement;\n    this.disposables = disposables;\n  }\n  dispose() {\n    this.disposables.dispose();\n  }\n}\nclass MarkdownRenderedHoverParts {\n  constructor(hoverParts, hoverPartsContainer, _hoverParticipant, _editor, _languageService, _openerService, _commandService, _keybindingService, _hoverService, _configurationService, _onFinishedRendering) {\n    this._hoverParticipant = _hoverParticipant;\n    this._editor = _editor;\n    this._languageService = _languageService;\n    this._openerService = _openerService;\n    this._commandService = _commandService;\n    this._keybindingService = _keybindingService;\n    this._hoverService = _hoverService;\n    this._configurationService = _configurationService;\n    this._onFinishedRendering = _onFinishedRendering;\n    this._ongoingHoverOperations = new Map();\n    this._disposables = new DisposableStore();\n    this.renderedHoverParts = this._renderHoverParts(hoverParts, hoverPartsContainer, this._onFinishedRendering);\n    this._disposables.add(toDisposable(() => {\n      this.renderedHoverParts.forEach(renderedHoverPart => {\n        renderedHoverPart.dispose();\n      });\n      this._ongoingHoverOperations.forEach(operation => {\n        operation.tokenSource.dispose(true);\n      });\n    }));\n  }\n  _renderHoverParts(hoverParts, hoverPartsContainer, onFinishedRendering) {\n    hoverParts.sort(compareBy(hover => hover.ordinal, numberComparator));\n    return hoverParts.map(hoverPart => {\n      const renderedHoverPart = this._renderHoverPart(hoverPart, onFinishedRendering);\n      hoverPartsContainer.appendChild(renderedHoverPart.hoverElement);\n      return renderedHoverPart;\n    });\n  }\n  _renderHoverPart(hoverPart, onFinishedRendering) {\n    const renderedMarkdownPart = this._renderMarkdownHover(hoverPart, onFinishedRendering);\n    const renderedMarkdownElement = renderedMarkdownPart.hoverElement;\n    const hoverSource = hoverPart.source;\n    const disposables = new DisposableStore();\n    disposables.add(renderedMarkdownPart);\n    if (!hoverSource) {\n      return new RenderedMarkdownHoverPart(hoverPart, renderedMarkdownElement, disposables);\n    }\n    const canIncreaseVerbosity = hoverSource.supportsVerbosityAction(HoverVerbosityAction.Increase);\n    const canDecreaseVerbosity = hoverSource.supportsVerbosityAction(HoverVerbosityAction.Decrease);\n    if (!canIncreaseVerbosity && !canDecreaseVerbosity) {\n      return new RenderedMarkdownHoverPart(hoverPart, renderedMarkdownElement, disposables);\n    }\n    const actionsContainer = $('div.verbosity-actions');\n    renderedMarkdownElement.prepend(actionsContainer);\n    disposables.add(this._renderHoverExpansionAction(actionsContainer, HoverVerbosityAction.Increase, canIncreaseVerbosity));\n    disposables.add(this._renderHoverExpansionAction(actionsContainer, HoverVerbosityAction.Decrease, canDecreaseVerbosity));\n    return new RenderedMarkdownHoverPart(hoverPart, renderedMarkdownElement, disposables);\n  }\n  _renderMarkdownHover(markdownHover, onFinishedRendering) {\n    const renderedMarkdownHover = renderMarkdownInContainer(this._editor, markdownHover, this._languageService, this._openerService, onFinishedRendering);\n    return renderedMarkdownHover;\n  }\n  _renderHoverExpansionAction(container, action, actionEnabled) {\n    const store = new DisposableStore();\n    const isActionIncrease = action === HoverVerbosityAction.Increase;\n    const actionElement = dom.append(container, $(ThemeIcon.asCSSSelector(isActionIncrease ? increaseHoverVerbosityIcon : decreaseHoverVerbosityIcon)));\n    actionElement.tabIndex = 0;\n    const hoverDelegate = new WorkbenchHoverDelegate('mouse', false, {\n      target: container,\n      position: {\n        hoverPosition: 0 /* HoverPosition.LEFT */\n      }\n    }, this._configurationService, this._hoverService);\n    store.add(this._hoverService.setupManagedHover(hoverDelegate, actionElement, labelForHoverVerbosityAction(this._keybindingService, action)));\n    if (!actionEnabled) {\n      actionElement.classList.add('disabled');\n      return store;\n    }\n    actionElement.classList.add('enabled');\n    const actionFunction = () => this._commandService.executeCommand(action === HoverVerbosityAction.Increase ? INCREASE_HOVER_VERBOSITY_ACTION_ID : DECREASE_HOVER_VERBOSITY_ACTION_ID);\n    store.add(new ClickAction(actionElement, actionFunction));\n    store.add(new KeyDownAction(actionElement, actionFunction, [3 /* KeyCode.Enter */, 10 /* KeyCode.Space */]));\n    return store;\n  }\n  async updateMarkdownHoverPartVerbosityLevel(action, index) {\n    let focus = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;\n    const model = this._editor.getModel();\n    if (!model) {\n      return undefined;\n    }\n    const hoverRenderedPart = this._getRenderedHoverPartAtIndex(index);\n    const hoverSource = hoverRenderedPart === null || hoverRenderedPart === void 0 ? void 0 : hoverRenderedPart.hoverPart.source;\n    if (!hoverRenderedPart || !(hoverSource !== null && hoverSource !== void 0 && hoverSource.supportsVerbosityAction(action))) {\n      return undefined;\n    }\n    const newHover = await this._fetchHover(hoverSource, model, action);\n    if (!newHover) {\n      return undefined;\n    }\n    const newHoverSource = new HoverSource(newHover, hoverSource.hoverProvider, hoverSource.hoverPosition);\n    const initialHoverPart = hoverRenderedPart.hoverPart;\n    const newHoverPart = new MarkdownHover(this._hoverParticipant, initialHoverPart.range, newHover.contents, initialHoverPart.isBeforeContent, initialHoverPart.ordinal, newHoverSource);\n    const newHoverRenderedPart = this._renderHoverPart(newHoverPart, this._onFinishedRendering);\n    this._replaceRenderedHoverPartAtIndex(index, newHoverRenderedPart, newHoverPart);\n    if (focus) {\n      this._focusOnHoverPartWithIndex(index);\n    }\n    return {\n      hoverPart: newHoverPart,\n      hoverElement: newHoverRenderedPart.hoverElement\n    };\n  }\n  async _fetchHover(hoverSource, model, action) {\n    let verbosityDelta = action === HoverVerbosityAction.Increase ? 1 : -1;\n    const provider = hoverSource.hoverProvider;\n    const ongoingHoverOperation = this._ongoingHoverOperations.get(provider);\n    if (ongoingHoverOperation) {\n      ongoingHoverOperation.tokenSource.cancel();\n      verbosityDelta += ongoingHoverOperation.verbosityDelta;\n    }\n    const tokenSource = new CancellationTokenSource();\n    this._ongoingHoverOperations.set(provider, {\n      verbosityDelta,\n      tokenSource\n    });\n    const context = {\n      verbosityRequest: {\n        verbosityDelta,\n        previousHover: hoverSource.hover\n      }\n    };\n    let hover;\n    try {\n      hover = await Promise.resolve(provider.provideHover(model, hoverSource.hoverPosition, tokenSource.token, context));\n    } catch (e) {\n      onUnexpectedExternalError(e);\n    }\n    tokenSource.dispose();\n    this._ongoingHoverOperations.delete(provider);\n    return hover;\n  }\n  _replaceRenderedHoverPartAtIndex(index, renderedHoverPart, hoverPart) {\n    if (index >= this.renderedHoverParts.length || index < 0) {\n      return;\n    }\n    const currentRenderedHoverPart = this.renderedHoverParts[index];\n    const currentRenderedMarkdown = currentRenderedHoverPart.hoverElement;\n    const renderedMarkdown = renderedHoverPart.hoverElement;\n    const renderedChildrenElements = Array.from(renderedMarkdown.children);\n    currentRenderedMarkdown.replaceChildren(...renderedChildrenElements);\n    const newRenderedHoverPart = new RenderedMarkdownHoverPart(hoverPart, currentRenderedMarkdown, renderedHoverPart.disposables);\n    currentRenderedMarkdown.focus();\n    currentRenderedHoverPart.dispose();\n    this.renderedHoverParts[index] = newRenderedHoverPart;\n  }\n  _focusOnHoverPartWithIndex(index) {\n    this.renderedHoverParts[index].hoverElement.focus();\n  }\n  _getRenderedHoverPartAtIndex(index) {\n    return this.renderedHoverParts[index];\n  }\n  dispose() {\n    this._disposables.dispose();\n  }\n}\nexport function renderMarkdownHovers(context, markdownHovers, editor, languageService, openerService) {\n  // Sort hover parts to keep them stable since they might come in async, out-of-order\n  markdownHovers.sort(compareBy(hover => hover.ordinal, numberComparator));\n  const renderedHoverParts = [];\n  for (const markdownHover of markdownHovers) {\n    renderedHoverParts.push(renderMarkdownInContainer(editor, markdownHover, languageService, openerService, context.onContentsChanged));\n  }\n  return new RenderedHoverParts(renderedHoverParts);\n}\nfunction renderMarkdownInContainer(editor, markdownHover, languageService, openerService, onFinishedRendering) {\n  const disposables = new DisposableStore();\n  const renderedMarkdown = $('div.hover-row');\n  const renderedMarkdownContents = $('div.hover-row-contents');\n  renderedMarkdown.appendChild(renderedMarkdownContents);\n  const markdownStrings = markdownHover.contents;\n  for (const markdownString of markdownStrings) {\n    if (isEmptyMarkdownString(markdownString)) {\n      continue;\n    }\n    const markdownHoverElement = $('div.markdown-hover');\n    const hoverContentsElement = dom.append(markdownHoverElement, $('div.hover-contents'));\n    const renderer = disposables.add(new MarkdownRenderer({\n      editor\n    }, languageService, openerService));\n    disposables.add(renderer.onDidRenderAsync(() => {\n      hoverContentsElement.className = 'hover-contents code-hover-contents';\n      onFinishedRendering();\n    }));\n    const renderedContents = disposables.add(renderer.render(markdownString));\n    hoverContentsElement.appendChild(renderedContents.element);\n    renderedMarkdownContents.appendChild(markdownHoverElement);\n  }\n  const renderedHoverPart = {\n    hoverPart: markdownHover,\n    hoverElement: renderedMarkdown,\n    dispose() {\n      disposables.dispose();\n    }\n  };\n  return renderedHoverPart;\n}\nexport function labelForHoverVerbosityAction(keybindingService, action) {\n  switch (action) {\n    case HoverVerbosityAction.Increase:\n      {\n        const kb = keybindingService.lookupKeybinding(INCREASE_HOVER_VERBOSITY_ACTION_ID);\n        return kb ? nls.localize('increaseVerbosityWithKb', \"Increase Hover Verbosity ({0})\", kb.getLabel()) : nls.localize('increaseVerbosity', \"Increase Hover Verbosity\");\n      }\n    case HoverVerbosityAction.Decrease:\n      {\n        const kb = keybindingService.lookupKeybinding(DECREASE_HOVER_VERBOSITY_ACTION_ID);\n        return kb ? nls.localize('decreaseVerbosityWithKb', \"Decrease Hover Verbosity ({0})\", kb.getLabel()) : nls.localize('decreaseVerbosity', \"Decrease Hover Verbosity\");\n      }\n  }\n}","map":{"version":3,"names":["__decorate","decorators","target","key","desc","c","arguments","length","r","Object","getOwnPropertyDescriptor","d","Reflect","decorate","i","defineProperty","__param","paramIndex","decorator","dom","asArray","compareBy","numberComparator","CancellationTokenSource","isEmptyMarkdownString","MarkdownString","DisposableStore","toDisposable","MarkdownRenderer","DECREASE_HOVER_VERBOSITY_ACTION_ID","INCREASE_HOVER_VERBOSITY_ACTION_ID","Range","ILanguageService","RenderedHoverParts","nls","IConfigurationService","IOpenerService","ILanguageFeaturesService","HoverVerbosityAction","registerIcon","Codicon","ThemeIcon","onUnexpectedExternalError","IKeybindingService","ClickAction","KeyDownAction","IHoverService","WorkbenchHoverDelegate","AsyncIterableObject","getHoverProviderResultsAsAsyncIterable","ICommandService","$","increaseHoverVerbosityIcon","add","localize","decreaseHoverVerbosityIcon","remove","MarkdownHover","constructor","owner","range","contents","isBeforeContent","ordinal","source","undefined","isValidForHoverAnchor","anchor","type","startColumn","endColumn","HoverSource","hover","hoverProvider","hoverPosition","supportsVerbosityAction","hoverVerbosityAction","_this$hover$canIncrea","_this$hover$canDecrea","Increase","canIncreaseVerbosity","Decrease","canDecreaseVerbosity","MarkdownHoverParticipant","_editor","_languageService","_openerService","_configurationService","_languageFeaturesService","_keybindingService","_hoverService","_commandService","hoverOrdinal","createLoadingMessage","appendText","computeSync","lineDecorations","hasModel","model","getModel","lineNumber","startLineNumber","maxColumn","getLineMaxColumn","result","index","lineLength","getLineLength","languageId","getLanguageIdAtPosition","stopRenderingLineAfter","getOption","maxTokenizationLineLength","getValue","overrideIdentifier","stopRenderingMessage","push","value","endLineNumber","hoverMessage","options","beforeContentClassName","computeAsync","token","EMPTY","hoverProviderRegistry","has","markdownHovers","_getMarkdownHovers","position","getStartPosition","hoverProviderResults","filter","item","map","lift","hoverSource","provider","renderHoverParts","context","hoverParts","_renderedHoverParts","MarkdownRenderedHoverParts","fragment","onContentsChanged","updateMarkdownHoverVerbosityLevel","action","focus","_this$_renderedHoverP","Promise","resolve","updateMarkdownHoverPartVerbosityLevel","RenderedMarkdownHoverPart","hoverPart","hoverElement","disposables","dispose","hoverPartsContainer","_hoverParticipant","_onFinishedRendering","_ongoingHoverOperations","Map","_disposables","renderedHoverParts","_renderHoverParts","forEach","renderedHoverPart","operation","tokenSource","onFinishedRendering","sort","_renderHoverPart","appendChild","renderedMarkdownPart","_renderMarkdownHover","renderedMarkdownElement","actionsContainer","prepend","_renderHoverExpansionAction","markdownHover","renderedMarkdownHover","renderMarkdownInContainer","container","actionEnabled","store","isActionIncrease","actionElement","append","asCSSSelector","tabIndex","hoverDelegate","setupManagedHover","labelForHoverVerbosityAction","classList","actionFunction","executeCommand","hoverRenderedPart","_getRenderedHoverPartAtIndex","newHover","_fetchHover","newHoverSource","initialHoverPart","newHoverPart","newHoverRenderedPart","_replaceRenderedHoverPartAtIndex","_focusOnHoverPartWithIndex","verbosityDelta","ongoingHoverOperation","get","cancel","set","verbosityRequest","previousHover","provideHover","e","delete","currentRenderedHoverPart","currentRenderedMarkdown","renderedMarkdown","renderedChildrenElements","Array","from","children","replaceChildren","newRenderedHoverPart","renderMarkdownHovers","editor","languageService","openerService","renderedMarkdownContents","markdownStrings","markdownString","markdownHoverElement","hoverContentsElement","renderer","onDidRenderAsync","className","renderedContents","render","element","keybindingService","kb","lookupKeybinding","getLabel"],"sources":["D:/ospanel/domains/react/react-intro-main/node_modules/monaco-editor/esm/vs/editor/contrib/hover/browser/markdownHoverParticipant.js"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport * as dom from '../../../../base/browser/dom.js';\nimport { asArray, compareBy, numberComparator } from '../../../../base/common/arrays.js';\nimport { CancellationTokenSource } from '../../../../base/common/cancellation.js';\nimport { isEmptyMarkdownString, MarkdownString } from '../../../../base/common/htmlContent.js';\nimport { DisposableStore, toDisposable } from '../../../../base/common/lifecycle.js';\nimport { MarkdownRenderer } from '../../../browser/widget/markdownRenderer/browser/markdownRenderer.js';\nimport { DECREASE_HOVER_VERBOSITY_ACTION_ID, INCREASE_HOVER_VERBOSITY_ACTION_ID } from './hoverActionIds.js';\nimport { Range } from '../../../common/core/range.js';\nimport { ILanguageService } from '../../../common/languages/language.js';\nimport { RenderedHoverParts } from './hoverTypes.js';\nimport * as nls from '../../../../nls.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nimport { IOpenerService } from '../../../../platform/opener/common/opener.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { HoverVerbosityAction } from '../../../common/languages.js';\nimport { registerIcon } from '../../../../platform/theme/common/iconRegistry.js';\nimport { Codicon } from '../../../../base/common/codicons.js';\nimport { ThemeIcon } from '../../../../base/common/themables.js';\nimport { onUnexpectedExternalError } from '../../../../base/common/errors.js';\nimport { IKeybindingService } from '../../../../platform/keybinding/common/keybinding.js';\nimport { ClickAction, KeyDownAction } from '../../../../base/browser/ui/hover/hoverWidget.js';\nimport { IHoverService, WorkbenchHoverDelegate } from '../../../../platform/hover/browser/hover.js';\nimport { AsyncIterableObject } from '../../../../base/common/async.js';\nimport { getHoverProviderResultsAsAsyncIterable } from './getHover.js';\nimport { ICommandService } from '../../../../platform/commands/common/commands.js';\nconst $ = dom.$;\nconst increaseHoverVerbosityIcon = registerIcon('hover-increase-verbosity', Codicon.add, nls.localize('increaseHoverVerbosity', 'Icon for increaseing hover verbosity.'));\nconst decreaseHoverVerbosityIcon = registerIcon('hover-decrease-verbosity', Codicon.remove, nls.localize('decreaseHoverVerbosity', 'Icon for decreasing hover verbosity.'));\nexport class MarkdownHover {\n    constructor(owner, range, contents, isBeforeContent, ordinal, source = undefined) {\n        this.owner = owner;\n        this.range = range;\n        this.contents = contents;\n        this.isBeforeContent = isBeforeContent;\n        this.ordinal = ordinal;\n        this.source = source;\n    }\n    isValidForHoverAnchor(anchor) {\n        return (anchor.type === 1 /* HoverAnchorType.Range */\n            && this.range.startColumn <= anchor.range.startColumn\n            && this.range.endColumn >= anchor.range.endColumn);\n    }\n}\nclass HoverSource {\n    constructor(hover, hoverProvider, hoverPosition) {\n        this.hover = hover;\n        this.hoverProvider = hoverProvider;\n        this.hoverPosition = hoverPosition;\n    }\n    supportsVerbosityAction(hoverVerbosityAction) {\n        switch (hoverVerbosityAction) {\n            case HoverVerbosityAction.Increase:\n                return this.hover.canIncreaseVerbosity ?? false;\n            case HoverVerbosityAction.Decrease:\n                return this.hover.canDecreaseVerbosity ?? false;\n        }\n    }\n}\nlet MarkdownHoverParticipant = class MarkdownHoverParticipant {\n    constructor(_editor, _languageService, _openerService, _configurationService, _languageFeaturesService, _keybindingService, _hoverService, _commandService) {\n        this._editor = _editor;\n        this._languageService = _languageService;\n        this._openerService = _openerService;\n        this._configurationService = _configurationService;\n        this._languageFeaturesService = _languageFeaturesService;\n        this._keybindingService = _keybindingService;\n        this._hoverService = _hoverService;\n        this._commandService = _commandService;\n        this.hoverOrdinal = 3;\n    }\n    createLoadingMessage(anchor) {\n        return new MarkdownHover(this, anchor.range, [new MarkdownString().appendText(nls.localize('modesContentHover.loading', \"Loading...\"))], false, 2000);\n    }\n    computeSync(anchor, lineDecorations) {\n        if (!this._editor.hasModel() || anchor.type !== 1 /* HoverAnchorType.Range */) {\n            return [];\n        }\n        const model = this._editor.getModel();\n        const lineNumber = anchor.range.startLineNumber;\n        const maxColumn = model.getLineMaxColumn(lineNumber);\n        const result = [];\n        let index = 1000;\n        const lineLength = model.getLineLength(lineNumber);\n        const languageId = model.getLanguageIdAtPosition(anchor.range.startLineNumber, anchor.range.startColumn);\n        const stopRenderingLineAfter = this._editor.getOption(118 /* EditorOption.stopRenderingLineAfter */);\n        const maxTokenizationLineLength = this._configurationService.getValue('editor.maxTokenizationLineLength', {\n            overrideIdentifier: languageId\n        });\n        let stopRenderingMessage = false;\n        if (stopRenderingLineAfter >= 0 && lineLength > stopRenderingLineAfter && anchor.range.startColumn >= stopRenderingLineAfter) {\n            stopRenderingMessage = true;\n            result.push(new MarkdownHover(this, anchor.range, [{\n                    value: nls.localize('stopped rendering', \"Rendering paused for long line for performance reasons. This can be configured via `editor.stopRenderingLineAfter`.\")\n                }], false, index++));\n        }\n        if (!stopRenderingMessage && typeof maxTokenizationLineLength === 'number' && lineLength >= maxTokenizationLineLength) {\n            result.push(new MarkdownHover(this, anchor.range, [{\n                    value: nls.localize('too many characters', \"Tokenization is skipped for long lines for performance reasons. This can be configured via `editor.maxTokenizationLineLength`.\")\n                }], false, index++));\n        }\n        let isBeforeContent = false;\n        for (const d of lineDecorations) {\n            const startColumn = (d.range.startLineNumber === lineNumber) ? d.range.startColumn : 1;\n            const endColumn = (d.range.endLineNumber === lineNumber) ? d.range.endColumn : maxColumn;\n            const hoverMessage = d.options.hoverMessage;\n            if (!hoverMessage || isEmptyMarkdownString(hoverMessage)) {\n                continue;\n            }\n            if (d.options.beforeContentClassName) {\n                isBeforeContent = true;\n            }\n            const range = new Range(anchor.range.startLineNumber, startColumn, anchor.range.startLineNumber, endColumn);\n            result.push(new MarkdownHover(this, range, asArray(hoverMessage), isBeforeContent, index++));\n        }\n        return result;\n    }\n    computeAsync(anchor, lineDecorations, token) {\n        if (!this._editor.hasModel() || anchor.type !== 1 /* HoverAnchorType.Range */) {\n            return AsyncIterableObject.EMPTY;\n        }\n        const model = this._editor.getModel();\n        const hoverProviderRegistry = this._languageFeaturesService.hoverProvider;\n        if (!hoverProviderRegistry.has(model)) {\n            return AsyncIterableObject.EMPTY;\n        }\n        const markdownHovers = this._getMarkdownHovers(hoverProviderRegistry, model, anchor, token);\n        return markdownHovers;\n    }\n    _getMarkdownHovers(hoverProviderRegistry, model, anchor, token) {\n        const position = anchor.range.getStartPosition();\n        const hoverProviderResults = getHoverProviderResultsAsAsyncIterable(hoverProviderRegistry, model, position, token);\n        const markdownHovers = hoverProviderResults.filter(item => !isEmptyMarkdownString(item.hover.contents))\n            .map(item => {\n            const range = item.hover.range ? Range.lift(item.hover.range) : anchor.range;\n            const hoverSource = new HoverSource(item.hover, item.provider, position);\n            return new MarkdownHover(this, range, item.hover.contents, false, item.ordinal, hoverSource);\n        });\n        return markdownHovers;\n    }\n    renderHoverParts(context, hoverParts) {\n        this._renderedHoverParts = new MarkdownRenderedHoverParts(hoverParts, context.fragment, this, this._editor, this._languageService, this._openerService, this._commandService, this._keybindingService, this._hoverService, this._configurationService, context.onContentsChanged);\n        return this._renderedHoverParts;\n    }\n    updateMarkdownHoverVerbosityLevel(action, index, focus) {\n        return Promise.resolve(this._renderedHoverParts?.updateMarkdownHoverPartVerbosityLevel(action, index, focus));\n    }\n};\nMarkdownHoverParticipant = __decorate([\n    __param(1, ILanguageService),\n    __param(2, IOpenerService),\n    __param(3, IConfigurationService),\n    __param(4, ILanguageFeaturesService),\n    __param(5, IKeybindingService),\n    __param(6, IHoverService),\n    __param(7, ICommandService)\n], MarkdownHoverParticipant);\nexport { MarkdownHoverParticipant };\nclass RenderedMarkdownHoverPart {\n    constructor(hoverPart, hoverElement, disposables) {\n        this.hoverPart = hoverPart;\n        this.hoverElement = hoverElement;\n        this.disposables = disposables;\n    }\n    dispose() {\n        this.disposables.dispose();\n    }\n}\nclass MarkdownRenderedHoverParts {\n    constructor(hoverParts, hoverPartsContainer, _hoverParticipant, _editor, _languageService, _openerService, _commandService, _keybindingService, _hoverService, _configurationService, _onFinishedRendering) {\n        this._hoverParticipant = _hoverParticipant;\n        this._editor = _editor;\n        this._languageService = _languageService;\n        this._openerService = _openerService;\n        this._commandService = _commandService;\n        this._keybindingService = _keybindingService;\n        this._hoverService = _hoverService;\n        this._configurationService = _configurationService;\n        this._onFinishedRendering = _onFinishedRendering;\n        this._ongoingHoverOperations = new Map();\n        this._disposables = new DisposableStore();\n        this.renderedHoverParts = this._renderHoverParts(hoverParts, hoverPartsContainer, this._onFinishedRendering);\n        this._disposables.add(toDisposable(() => {\n            this.renderedHoverParts.forEach(renderedHoverPart => {\n                renderedHoverPart.dispose();\n            });\n            this._ongoingHoverOperations.forEach(operation => {\n                operation.tokenSource.dispose(true);\n            });\n        }));\n    }\n    _renderHoverParts(hoverParts, hoverPartsContainer, onFinishedRendering) {\n        hoverParts.sort(compareBy(hover => hover.ordinal, numberComparator));\n        return hoverParts.map(hoverPart => {\n            const renderedHoverPart = this._renderHoverPart(hoverPart, onFinishedRendering);\n            hoverPartsContainer.appendChild(renderedHoverPart.hoverElement);\n            return renderedHoverPart;\n        });\n    }\n    _renderHoverPart(hoverPart, onFinishedRendering) {\n        const renderedMarkdownPart = this._renderMarkdownHover(hoverPart, onFinishedRendering);\n        const renderedMarkdownElement = renderedMarkdownPart.hoverElement;\n        const hoverSource = hoverPart.source;\n        const disposables = new DisposableStore();\n        disposables.add(renderedMarkdownPart);\n        if (!hoverSource) {\n            return new RenderedMarkdownHoverPart(hoverPart, renderedMarkdownElement, disposables);\n        }\n        const canIncreaseVerbosity = hoverSource.supportsVerbosityAction(HoverVerbosityAction.Increase);\n        const canDecreaseVerbosity = hoverSource.supportsVerbosityAction(HoverVerbosityAction.Decrease);\n        if (!canIncreaseVerbosity && !canDecreaseVerbosity) {\n            return new RenderedMarkdownHoverPart(hoverPart, renderedMarkdownElement, disposables);\n        }\n        const actionsContainer = $('div.verbosity-actions');\n        renderedMarkdownElement.prepend(actionsContainer);\n        disposables.add(this._renderHoverExpansionAction(actionsContainer, HoverVerbosityAction.Increase, canIncreaseVerbosity));\n        disposables.add(this._renderHoverExpansionAction(actionsContainer, HoverVerbosityAction.Decrease, canDecreaseVerbosity));\n        return new RenderedMarkdownHoverPart(hoverPart, renderedMarkdownElement, disposables);\n    }\n    _renderMarkdownHover(markdownHover, onFinishedRendering) {\n        const renderedMarkdownHover = renderMarkdownInContainer(this._editor, markdownHover, this._languageService, this._openerService, onFinishedRendering);\n        return renderedMarkdownHover;\n    }\n    _renderHoverExpansionAction(container, action, actionEnabled) {\n        const store = new DisposableStore();\n        const isActionIncrease = action === HoverVerbosityAction.Increase;\n        const actionElement = dom.append(container, $(ThemeIcon.asCSSSelector(isActionIncrease ? increaseHoverVerbosityIcon : decreaseHoverVerbosityIcon)));\n        actionElement.tabIndex = 0;\n        const hoverDelegate = new WorkbenchHoverDelegate('mouse', false, { target: container, position: { hoverPosition: 0 /* HoverPosition.LEFT */ } }, this._configurationService, this._hoverService);\n        store.add(this._hoverService.setupManagedHover(hoverDelegate, actionElement, labelForHoverVerbosityAction(this._keybindingService, action)));\n        if (!actionEnabled) {\n            actionElement.classList.add('disabled');\n            return store;\n        }\n        actionElement.classList.add('enabled');\n        const actionFunction = () => this._commandService.executeCommand(action === HoverVerbosityAction.Increase ? INCREASE_HOVER_VERBOSITY_ACTION_ID : DECREASE_HOVER_VERBOSITY_ACTION_ID);\n        store.add(new ClickAction(actionElement, actionFunction));\n        store.add(new KeyDownAction(actionElement, actionFunction, [3 /* KeyCode.Enter */, 10 /* KeyCode.Space */]));\n        return store;\n    }\n    async updateMarkdownHoverPartVerbosityLevel(action, index, focus = true) {\n        const model = this._editor.getModel();\n        if (!model) {\n            return undefined;\n        }\n        const hoverRenderedPart = this._getRenderedHoverPartAtIndex(index);\n        const hoverSource = hoverRenderedPart?.hoverPart.source;\n        if (!hoverRenderedPart || !hoverSource?.supportsVerbosityAction(action)) {\n            return undefined;\n        }\n        const newHover = await this._fetchHover(hoverSource, model, action);\n        if (!newHover) {\n            return undefined;\n        }\n        const newHoverSource = new HoverSource(newHover, hoverSource.hoverProvider, hoverSource.hoverPosition);\n        const initialHoverPart = hoverRenderedPart.hoverPart;\n        const newHoverPart = new MarkdownHover(this._hoverParticipant, initialHoverPart.range, newHover.contents, initialHoverPart.isBeforeContent, initialHoverPart.ordinal, newHoverSource);\n        const newHoverRenderedPart = this._renderHoverPart(newHoverPart, this._onFinishedRendering);\n        this._replaceRenderedHoverPartAtIndex(index, newHoverRenderedPart, newHoverPart);\n        if (focus) {\n            this._focusOnHoverPartWithIndex(index);\n        }\n        return {\n            hoverPart: newHoverPart,\n            hoverElement: newHoverRenderedPart.hoverElement\n        };\n    }\n    async _fetchHover(hoverSource, model, action) {\n        let verbosityDelta = action === HoverVerbosityAction.Increase ? 1 : -1;\n        const provider = hoverSource.hoverProvider;\n        const ongoingHoverOperation = this._ongoingHoverOperations.get(provider);\n        if (ongoingHoverOperation) {\n            ongoingHoverOperation.tokenSource.cancel();\n            verbosityDelta += ongoingHoverOperation.verbosityDelta;\n        }\n        const tokenSource = new CancellationTokenSource();\n        this._ongoingHoverOperations.set(provider, { verbosityDelta, tokenSource });\n        const context = { verbosityRequest: { verbosityDelta, previousHover: hoverSource.hover } };\n        let hover;\n        try {\n            hover = await Promise.resolve(provider.provideHover(model, hoverSource.hoverPosition, tokenSource.token, context));\n        }\n        catch (e) {\n            onUnexpectedExternalError(e);\n        }\n        tokenSource.dispose();\n        this._ongoingHoverOperations.delete(provider);\n        return hover;\n    }\n    _replaceRenderedHoverPartAtIndex(index, renderedHoverPart, hoverPart) {\n        if (index >= this.renderedHoverParts.length || index < 0) {\n            return;\n        }\n        const currentRenderedHoverPart = this.renderedHoverParts[index];\n        const currentRenderedMarkdown = currentRenderedHoverPart.hoverElement;\n        const renderedMarkdown = renderedHoverPart.hoverElement;\n        const renderedChildrenElements = Array.from(renderedMarkdown.children);\n        currentRenderedMarkdown.replaceChildren(...renderedChildrenElements);\n        const newRenderedHoverPart = new RenderedMarkdownHoverPart(hoverPart, currentRenderedMarkdown, renderedHoverPart.disposables);\n        currentRenderedMarkdown.focus();\n        currentRenderedHoverPart.dispose();\n        this.renderedHoverParts[index] = newRenderedHoverPart;\n    }\n    _focusOnHoverPartWithIndex(index) {\n        this.renderedHoverParts[index].hoverElement.focus();\n    }\n    _getRenderedHoverPartAtIndex(index) {\n        return this.renderedHoverParts[index];\n    }\n    dispose() {\n        this._disposables.dispose();\n    }\n}\nexport function renderMarkdownHovers(context, markdownHovers, editor, languageService, openerService) {\n    // Sort hover parts to keep them stable since they might come in async, out-of-order\n    markdownHovers.sort(compareBy(hover => hover.ordinal, numberComparator));\n    const renderedHoverParts = [];\n    for (const markdownHover of markdownHovers) {\n        renderedHoverParts.push(renderMarkdownInContainer(editor, markdownHover, languageService, openerService, context.onContentsChanged));\n    }\n    return new RenderedHoverParts(renderedHoverParts);\n}\nfunction renderMarkdownInContainer(editor, markdownHover, languageService, openerService, onFinishedRendering) {\n    const disposables = new DisposableStore();\n    const renderedMarkdown = $('div.hover-row');\n    const renderedMarkdownContents = $('div.hover-row-contents');\n    renderedMarkdown.appendChild(renderedMarkdownContents);\n    const markdownStrings = markdownHover.contents;\n    for (const markdownString of markdownStrings) {\n        if (isEmptyMarkdownString(markdownString)) {\n            continue;\n        }\n        const markdownHoverElement = $('div.markdown-hover');\n        const hoverContentsElement = dom.append(markdownHoverElement, $('div.hover-contents'));\n        const renderer = disposables.add(new MarkdownRenderer({ editor }, languageService, openerService));\n        disposables.add(renderer.onDidRenderAsync(() => {\n            hoverContentsElement.className = 'hover-contents code-hover-contents';\n            onFinishedRendering();\n        }));\n        const renderedContents = disposables.add(renderer.render(markdownString));\n        hoverContentsElement.appendChild(renderedContents.element);\n        renderedMarkdownContents.appendChild(markdownHoverElement);\n    }\n    const renderedHoverPart = {\n        hoverPart: markdownHover,\n        hoverElement: renderedMarkdown,\n        dispose() { disposables.dispose(); }\n    };\n    return renderedHoverPart;\n}\nexport function labelForHoverVerbosityAction(keybindingService, action) {\n    switch (action) {\n        case HoverVerbosityAction.Increase: {\n            const kb = keybindingService.lookupKeybinding(INCREASE_HOVER_VERBOSITY_ACTION_ID);\n            return kb ?\n                nls.localize('increaseVerbosityWithKb', \"Increase Hover Verbosity ({0})\", kb.getLabel()) :\n                nls.localize('increaseVerbosity', \"Increase Hover Verbosity\");\n        }\n        case HoverVerbosityAction.Decrease: {\n            const kb = keybindingService.lookupKeybinding(DECREASE_HOVER_VERBOSITY_ACTION_ID);\n            return kb ?\n                nls.localize('decreaseVerbosityWithKb', \"Decrease Hover Verbosity ({0})\", kb.getLabel()) :\n                nls.localize('decreaseVerbosity', \"Decrease Hover Verbosity\");\n        }\n    }\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}