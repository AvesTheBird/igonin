{"ast":null,"code":"/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n    r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n    d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nimport { asCssValueWithDefault, createStyleSheet, EventHelper, getActiveElement, getWindow, isHTMLElement, isMouseEvent } from '../../dom.js';\nimport { DomEmitter } from '../../event.js';\nimport { StandardKeyboardEvent } from '../../keyboardEvent.js';\nimport { Gesture } from '../../touch.js';\nimport { alert } from '../aria/aria.js';\nimport { CombinedSpliceable } from './splice.js';\nimport { binarySearch, firstOrDefault, range } from '../../../common/arrays.js';\nimport { timeout } from '../../../common/async.js';\nimport { Color } from '../../../common/color.js';\nimport { memoize } from '../../../common/decorators.js';\nimport { Emitter, Event, EventBufferer } from '../../../common/event.js';\nimport { matchesFuzzy2, matchesPrefix } from '../../../common/filters.js';\nimport { DisposableStore, dispose } from '../../../common/lifecycle.js';\nimport { clamp } from '../../../common/numbers.js';\nimport * as platform from '../../../common/platform.js';\nimport { isNumber } from '../../../common/types.js';\nimport './list.css';\nimport { ListError } from './list.js';\nimport { ListView } from './listView.js';\nimport { StandardMouseEvent } from '../../mouseEvent.js';\nimport { autorun, constObservable } from '../../../common/observable.js';\nclass TraitRenderer {\n  constructor(trait) {\n    this.trait = trait;\n    this.renderedElements = [];\n  }\n  get templateId() {\n    return \"template:\".concat(this.trait.name);\n  }\n  renderTemplate(container) {\n    return container;\n  }\n  renderElement(element, index, templateData) {\n    const renderedElementIndex = this.renderedElements.findIndex(el => el.templateData === templateData);\n    if (renderedElementIndex >= 0) {\n      const rendered = this.renderedElements[renderedElementIndex];\n      this.trait.unrender(templateData);\n      rendered.index = index;\n    } else {\n      const rendered = {\n        index,\n        templateData\n      };\n      this.renderedElements.push(rendered);\n    }\n    this.trait.renderIndex(index, templateData);\n  }\n  splice(start, deleteCount, insertCount) {\n    const rendered = [];\n    for (const renderedElement of this.renderedElements) {\n      if (renderedElement.index < start) {\n        rendered.push(renderedElement);\n      } else if (renderedElement.index >= start + deleteCount) {\n        rendered.push({\n          index: renderedElement.index + insertCount - deleteCount,\n          templateData: renderedElement.templateData\n        });\n      }\n    }\n    this.renderedElements = rendered;\n  }\n  renderIndexes(indexes) {\n    for (const {\n      index,\n      templateData\n    } of this.renderedElements) {\n      if (indexes.indexOf(index) > -1) {\n        this.trait.renderIndex(index, templateData);\n      }\n    }\n  }\n  disposeTemplate(templateData) {\n    const index = this.renderedElements.findIndex(el => el.templateData === templateData);\n    if (index < 0) {\n      return;\n    }\n    this.renderedElements.splice(index, 1);\n  }\n}\nclass Trait {\n  get name() {\n    return this._trait;\n  }\n  get renderer() {\n    return new TraitRenderer(this);\n  }\n  constructor(_trait) {\n    this._trait = _trait;\n    this.indexes = [];\n    this.sortedIndexes = [];\n    this._onChange = new Emitter();\n    this.onChange = this._onChange.event;\n  }\n  splice(start, deleteCount, elements) {\n    const diff = elements.length - deleteCount;\n    const end = start + deleteCount;\n    const sortedIndexes = [];\n    let i = 0;\n    while (i < this.sortedIndexes.length && this.sortedIndexes[i] < start) {\n      sortedIndexes.push(this.sortedIndexes[i++]);\n    }\n    for (let j = 0; j < elements.length; j++) {\n      if (elements[j]) {\n        sortedIndexes.push(j + start);\n      }\n    }\n    while (i < this.sortedIndexes.length && this.sortedIndexes[i] >= end) {\n      sortedIndexes.push(this.sortedIndexes[i++] + diff);\n    }\n    this.renderer.splice(start, deleteCount, elements.length);\n    this._set(sortedIndexes, sortedIndexes);\n  }\n  renderIndex(index, container) {\n    container.classList.toggle(this._trait, this.contains(index));\n  }\n  unrender(container) {\n    container.classList.remove(this._trait);\n  }\n  /**\n   * Sets the indexes which should have this trait.\n   *\n   * @param indexes Indexes which should have this trait.\n   * @return The old indexes which had this trait.\n   */\n  set(indexes, browserEvent) {\n    return this._set(indexes, [...indexes].sort(numericSort), browserEvent);\n  }\n  _set(indexes, sortedIndexes, browserEvent) {\n    const result = this.indexes;\n    const sortedResult = this.sortedIndexes;\n    this.indexes = indexes;\n    this.sortedIndexes = sortedIndexes;\n    const toRender = disjunction(sortedResult, indexes);\n    this.renderer.renderIndexes(toRender);\n    this._onChange.fire({\n      indexes,\n      browserEvent\n    });\n    return result;\n  }\n  get() {\n    return this.indexes;\n  }\n  contains(index) {\n    return binarySearch(this.sortedIndexes, index, numericSort) >= 0;\n  }\n  dispose() {\n    dispose(this._onChange);\n  }\n}\n__decorate([memoize], Trait.prototype, \"renderer\", null);\nclass SelectionTrait extends Trait {\n  constructor(setAriaSelected) {\n    super('selected');\n    this.setAriaSelected = setAriaSelected;\n  }\n  renderIndex(index, container) {\n    super.renderIndex(index, container);\n    if (this.setAriaSelected) {\n      if (this.contains(index)) {\n        container.setAttribute('aria-selected', 'true');\n      } else {\n        container.setAttribute('aria-selected', 'false');\n      }\n    }\n  }\n}\n/**\n * The TraitSpliceable is used as a util class to be able\n * to preserve traits across splice calls, given an identity\n * provider.\n */\nclass TraitSpliceable {\n  constructor(trait, view, identityProvider) {\n    this.trait = trait;\n    this.view = view;\n    this.identityProvider = identityProvider;\n  }\n  splice(start, deleteCount, elements) {\n    if (!this.identityProvider) {\n      return this.trait.splice(start, deleteCount, new Array(elements.length).fill(false));\n    }\n    const pastElementsWithTrait = this.trait.get().map(i => this.identityProvider.getId(this.view.element(i)).toString());\n    if (pastElementsWithTrait.length === 0) {\n      return this.trait.splice(start, deleteCount, new Array(elements.length).fill(false));\n    }\n    const pastElementsWithTraitSet = new Set(pastElementsWithTrait);\n    const elementsWithTrait = elements.map(e => pastElementsWithTraitSet.has(this.identityProvider.getId(e).toString()));\n    this.trait.splice(start, deleteCount, elementsWithTrait);\n  }\n}\nexport function isInputElement(e) {\n  return e.tagName === 'INPUT' || e.tagName === 'TEXTAREA';\n}\nfunction isListElementDescendantOfClass(e, className) {\n  if (e.classList.contains(className)) {\n    return true;\n  }\n  if (e.classList.contains('monaco-list')) {\n    return false;\n  }\n  if (!e.parentElement) {\n    return false;\n  }\n  return isListElementDescendantOfClass(e.parentElement, className);\n}\nexport function isMonacoEditor(e) {\n  return isListElementDescendantOfClass(e, 'monaco-editor');\n}\nexport function isMonacoCustomToggle(e) {\n  return isListElementDescendantOfClass(e, 'monaco-custom-toggle');\n}\nexport function isActionItem(e) {\n  return isListElementDescendantOfClass(e, 'action-item');\n}\nexport function isStickyScrollElement(e) {\n  return isListElementDescendantOfClass(e, 'monaco-tree-sticky-row');\n}\nexport function isStickyScrollContainer(e) {\n  return e.classList.contains('monaco-tree-sticky-container');\n}\nexport function isButton(e) {\n  if (e.tagName === 'A' && e.classList.contains('monaco-button') || e.tagName === 'DIV' && e.classList.contains('monaco-button-dropdown')) {\n    return true;\n  }\n  if (e.classList.contains('monaco-list')) {\n    return false;\n  }\n  if (!e.parentElement) {\n    return false;\n  }\n  return isButton(e.parentElement);\n}\nclass KeyboardController {\n  get onKeyDown() {\n    return Event.chain(this.disposables.add(new DomEmitter(this.view.domNode, 'keydown')).event, $ => $.filter(e => !isInputElement(e.target)).map(e => new StandardKeyboardEvent(e)));\n  }\n  constructor(list, view, options) {\n    this.list = list;\n    this.view = view;\n    this.disposables = new DisposableStore();\n    this.multipleSelectionDisposables = new DisposableStore();\n    this.multipleSelectionSupport = options.multipleSelectionSupport;\n    this.disposables.add(this.onKeyDown(e => {\n      switch (e.keyCode) {\n        case 3 /* KeyCode.Enter */:\n          return this.onEnter(e);\n        case 16 /* KeyCode.UpArrow */:\n          return this.onUpArrow(e);\n        case 18 /* KeyCode.DownArrow */:\n          return this.onDownArrow(e);\n        case 11 /* KeyCode.PageUp */:\n          return this.onPageUpArrow(e);\n        case 12 /* KeyCode.PageDown */:\n          return this.onPageDownArrow(e);\n        case 9 /* KeyCode.Escape */:\n          return this.onEscape(e);\n        case 31 /* KeyCode.KeyA */:\n          if (this.multipleSelectionSupport && (platform.isMacintosh ? e.metaKey : e.ctrlKey)) {\n            this.onCtrlA(e);\n          }\n      }\n    }));\n  }\n  updateOptions(optionsUpdate) {\n    if (optionsUpdate.multipleSelectionSupport !== undefined) {\n      this.multipleSelectionSupport = optionsUpdate.multipleSelectionSupport;\n    }\n  }\n  onEnter(e) {\n    e.preventDefault();\n    e.stopPropagation();\n    this.list.setSelection(this.list.getFocus(), e.browserEvent);\n  }\n  onUpArrow(e) {\n    e.preventDefault();\n    e.stopPropagation();\n    this.list.focusPrevious(1, false, e.browserEvent);\n    const el = this.list.getFocus()[0];\n    this.list.setAnchor(el);\n    this.list.reveal(el);\n    this.view.domNode.focus();\n  }\n  onDownArrow(e) {\n    e.preventDefault();\n    e.stopPropagation();\n    this.list.focusNext(1, false, e.browserEvent);\n    const el = this.list.getFocus()[0];\n    this.list.setAnchor(el);\n    this.list.reveal(el);\n    this.view.domNode.focus();\n  }\n  onPageUpArrow(e) {\n    e.preventDefault();\n    e.stopPropagation();\n    this.list.focusPreviousPage(e.browserEvent);\n    const el = this.list.getFocus()[0];\n    this.list.setAnchor(el);\n    this.list.reveal(el);\n    this.view.domNode.focus();\n  }\n  onPageDownArrow(e) {\n    e.preventDefault();\n    e.stopPropagation();\n    this.list.focusNextPage(e.browserEvent);\n    const el = this.list.getFocus()[0];\n    this.list.setAnchor(el);\n    this.list.reveal(el);\n    this.view.domNode.focus();\n  }\n  onCtrlA(e) {\n    e.preventDefault();\n    e.stopPropagation();\n    this.list.setSelection(range(this.list.length), e.browserEvent);\n    this.list.setAnchor(undefined);\n    this.view.domNode.focus();\n  }\n  onEscape(e) {\n    if (this.list.getSelection().length) {\n      e.preventDefault();\n      e.stopPropagation();\n      this.list.setSelection([], e.browserEvent);\n      this.list.setAnchor(undefined);\n      this.view.domNode.focus();\n    }\n  }\n  dispose() {\n    this.disposables.dispose();\n    this.multipleSelectionDisposables.dispose();\n  }\n}\n__decorate([memoize], KeyboardController.prototype, \"onKeyDown\", null);\nexport var TypeNavigationMode;\n(function (TypeNavigationMode) {\n  TypeNavigationMode[TypeNavigationMode[\"Automatic\"] = 0] = \"Automatic\";\n  TypeNavigationMode[TypeNavigationMode[\"Trigger\"] = 1] = \"Trigger\";\n})(TypeNavigationMode || (TypeNavigationMode = {}));\nvar TypeNavigationControllerState;\n(function (TypeNavigationControllerState) {\n  TypeNavigationControllerState[TypeNavigationControllerState[\"Idle\"] = 0] = \"Idle\";\n  TypeNavigationControllerState[TypeNavigationControllerState[\"Typing\"] = 1] = \"Typing\";\n})(TypeNavigationControllerState || (TypeNavigationControllerState = {}));\nexport const DefaultKeyboardNavigationDelegate = new class {\n  mightProducePrintableCharacter(event) {\n    if (event.ctrlKey || event.metaKey || event.altKey) {\n      return false;\n    }\n    return event.keyCode >= 31 /* KeyCode.KeyA */ && event.keyCode <= 56 /* KeyCode.KeyZ */ || event.keyCode >= 21 /* KeyCode.Digit0 */ && event.keyCode <= 30 /* KeyCode.Digit9 */ || event.keyCode >= 98 /* KeyCode.Numpad0 */ && event.keyCode <= 107 /* KeyCode.Numpad9 */ || event.keyCode >= 85 /* KeyCode.Semicolon */ && event.keyCode <= 95 /* KeyCode.Quote */;\n  }\n}();\nclass TypeNavigationController {\n  constructor(list, view, keyboardNavigationLabelProvider, keyboardNavigationEventFilter, delegate) {\n    this.list = list;\n    this.view = view;\n    this.keyboardNavigationLabelProvider = keyboardNavigationLabelProvider;\n    this.keyboardNavigationEventFilter = keyboardNavigationEventFilter;\n    this.delegate = delegate;\n    this.enabled = false;\n    this.state = TypeNavigationControllerState.Idle;\n    this.mode = TypeNavigationMode.Automatic;\n    this.triggered = false;\n    this.previouslyFocused = -1;\n    this.enabledDisposables = new DisposableStore();\n    this.disposables = new DisposableStore();\n    this.updateOptions(list.options);\n  }\n  updateOptions(options) {\n    var _options$typeNavigati, _options$typeNavigati2;\n    if ((_options$typeNavigati = options.typeNavigationEnabled) !== null && _options$typeNavigati !== void 0 ? _options$typeNavigati : true) {\n      this.enable();\n    } else {\n      this.disable();\n    }\n    this.mode = (_options$typeNavigati2 = options.typeNavigationMode) !== null && _options$typeNavigati2 !== void 0 ? _options$typeNavigati2 : TypeNavigationMode.Automatic;\n  }\n  enable() {\n    if (this.enabled) {\n      return;\n    }\n    let typing = false;\n    const onChar = Event.chain(this.enabledDisposables.add(new DomEmitter(this.view.domNode, 'keydown')).event, $ => $.filter(e => !isInputElement(e.target)).filter(() => this.mode === TypeNavigationMode.Automatic || this.triggered).map(event => new StandardKeyboardEvent(event)).filter(e => typing || this.keyboardNavigationEventFilter(e)).filter(e => this.delegate.mightProducePrintableCharacter(e)).forEach(e => EventHelper.stop(e, true)).map(event => event.browserEvent.key));\n    const onClear = Event.debounce(onChar, () => null, 800, undefined, undefined, undefined, this.enabledDisposables);\n    const onInput = Event.reduce(Event.any(onChar, onClear), (r, i) => i === null ? null : (r || '') + i, undefined, this.enabledDisposables);\n    onInput(this.onInput, this, this.enabledDisposables);\n    onClear(this.onClear, this, this.enabledDisposables);\n    onChar(() => typing = true, undefined, this.enabledDisposables);\n    onClear(() => typing = false, undefined, this.enabledDisposables);\n    this.enabled = true;\n    this.triggered = false;\n  }\n  disable() {\n    if (!this.enabled) {\n      return;\n    }\n    this.enabledDisposables.clear();\n    this.enabled = false;\n    this.triggered = false;\n  }\n  onClear() {\n    const focus = this.list.getFocus();\n    if (focus.length > 0 && focus[0] === this.previouslyFocused) {\n      var _this$list$options$ac;\n      // List: re-announce element on typing end since typed keys will interrupt aria label of focused element\n      // Do not announce if there was a focus change at the end to prevent duplication https://github.com/microsoft/vscode/issues/95961\n      const ariaLabel = (_this$list$options$ac = this.list.options.accessibilityProvider) === null || _this$list$options$ac === void 0 ? void 0 : _this$list$options$ac.getAriaLabel(this.list.element(focus[0]));\n      if (typeof ariaLabel === 'string') {\n        alert(ariaLabel);\n      } else if (ariaLabel) {\n        alert(ariaLabel.get());\n      }\n    }\n    this.previouslyFocused = -1;\n  }\n  onInput(word) {\n    if (!word) {\n      this.state = TypeNavigationControllerState.Idle;\n      this.triggered = false;\n      return;\n    }\n    const focus = this.list.getFocus();\n    const start = focus.length > 0 ? focus[0] : 0;\n    const delta = this.state === TypeNavigationControllerState.Idle ? 1 : 0;\n    this.state = TypeNavigationControllerState.Typing;\n    for (let i = 0; i < this.list.length; i++) {\n      const index = (start + i + delta) % this.list.length;\n      const label = this.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(this.view.element(index));\n      const labelStr = label && label.toString();\n      if (this.list.options.typeNavigationEnabled) {\n        if (typeof labelStr !== 'undefined') {\n          // If prefix is found, focus and return early\n          if (matchesPrefix(word, labelStr)) {\n            this.previouslyFocused = start;\n            this.list.setFocus([index]);\n            this.list.reveal(index);\n            return;\n          }\n          const fuzzy = matchesFuzzy2(word, labelStr);\n          if (fuzzy) {\n            const fuzzyScore = fuzzy[0].end - fuzzy[0].start;\n            // ensures that when fuzzy matching, doesn't clash with prefix matching (1 input vs 1+ should be prefix and fuzzy respecitvely). Also makes sure that exact matches are prioritized.\n            if (fuzzyScore > 1 && fuzzy.length === 1) {\n              this.previouslyFocused = start;\n              this.list.setFocus([index]);\n              this.list.reveal(index);\n              return;\n            }\n          }\n        }\n      } else if (typeof labelStr === 'undefined' || matchesPrefix(word, labelStr)) {\n        this.previouslyFocused = start;\n        this.list.setFocus([index]);\n        this.list.reveal(index);\n        return;\n      }\n    }\n  }\n  dispose() {\n    this.disable();\n    this.enabledDisposables.dispose();\n    this.disposables.dispose();\n  }\n}\nclass DOMFocusController {\n  constructor(list, view) {\n    this.list = list;\n    this.view = view;\n    this.disposables = new DisposableStore();\n    const onKeyDown = Event.chain(this.disposables.add(new DomEmitter(view.domNode, 'keydown')).event, $ => $.filter(e => !isInputElement(e.target)).map(e => new StandardKeyboardEvent(e)));\n    const onTab = Event.chain(onKeyDown, $ => $.filter(e => e.keyCode === 2 /* KeyCode.Tab */ && !e.ctrlKey && !e.metaKey && !e.shiftKey && !e.altKey));\n    onTab(this.onTab, this, this.disposables);\n  }\n  onTab(e) {\n    if (e.target !== this.view.domNode) {\n      return;\n    }\n    const focus = this.list.getFocus();\n    if (focus.length === 0) {\n      return;\n    }\n    const focusedDomElement = this.view.domElement(focus[0]);\n    if (!focusedDomElement) {\n      return;\n    }\n    const tabIndexElement = focusedDomElement.querySelector('[tabIndex]');\n    if (!tabIndexElement || !isHTMLElement(tabIndexElement) || tabIndexElement.tabIndex === -1) {\n      return;\n    }\n    const style = getWindow(tabIndexElement).getComputedStyle(tabIndexElement);\n    if (style.visibility === 'hidden' || style.display === 'none') {\n      return;\n    }\n    e.preventDefault();\n    e.stopPropagation();\n    tabIndexElement.focus();\n  }\n  dispose() {\n    this.disposables.dispose();\n  }\n}\nexport function isSelectionSingleChangeEvent(event) {\n  return platform.isMacintosh ? event.browserEvent.metaKey : event.browserEvent.ctrlKey;\n}\nexport function isSelectionRangeChangeEvent(event) {\n  return event.browserEvent.shiftKey;\n}\nfunction isMouseRightClick(event) {\n  return isMouseEvent(event) && event.button === 2;\n}\nconst DefaultMultipleSelectionController = {\n  isSelectionSingleChangeEvent,\n  isSelectionRangeChangeEvent\n};\nexport class MouseController {\n  constructor(list) {\n    this.list = list;\n    this.disposables = new DisposableStore();\n    this._onPointer = new Emitter();\n    this.onPointer = this._onPointer.event;\n    if (list.options.multipleSelectionSupport !== false) {\n      this.multipleSelectionController = this.list.options.multipleSelectionController || DefaultMultipleSelectionController;\n    }\n    this.mouseSupport = typeof list.options.mouseSupport === 'undefined' || !!list.options.mouseSupport;\n    if (this.mouseSupport) {\n      list.onMouseDown(this.onMouseDown, this, this.disposables);\n      list.onContextMenu(this.onContextMenu, this, this.disposables);\n      list.onMouseDblClick(this.onDoubleClick, this, this.disposables);\n      list.onTouchStart(this.onMouseDown, this, this.disposables);\n      this.disposables.add(Gesture.addTarget(list.getHTMLElement()));\n    }\n    Event.any(list.onMouseClick, list.onMouseMiddleClick, list.onTap)(this.onViewPointer, this, this.disposables);\n  }\n  updateOptions(optionsUpdate) {\n    if (optionsUpdate.multipleSelectionSupport !== undefined) {\n      this.multipleSelectionController = undefined;\n      if (optionsUpdate.multipleSelectionSupport) {\n        this.multipleSelectionController = this.list.options.multipleSelectionController || DefaultMultipleSelectionController;\n      }\n    }\n  }\n  isSelectionSingleChangeEvent(event) {\n    if (!this.multipleSelectionController) {\n      return false;\n    }\n    return this.multipleSelectionController.isSelectionSingleChangeEvent(event);\n  }\n  isSelectionRangeChangeEvent(event) {\n    if (!this.multipleSelectionController) {\n      return false;\n    }\n    return this.multipleSelectionController.isSelectionRangeChangeEvent(event);\n  }\n  isSelectionChangeEvent(event) {\n    return this.isSelectionSingleChangeEvent(event) || this.isSelectionRangeChangeEvent(event);\n  }\n  onMouseDown(e) {\n    if (isMonacoEditor(e.browserEvent.target)) {\n      return;\n    }\n    if (getActiveElement() !== e.browserEvent.target) {\n      this.list.domFocus();\n    }\n  }\n  onContextMenu(e) {\n    if (isInputElement(e.browserEvent.target) || isMonacoEditor(e.browserEvent.target)) {\n      return;\n    }\n    const focus = typeof e.index === 'undefined' ? [] : [e.index];\n    this.list.setFocus(focus, e.browserEvent);\n  }\n  onViewPointer(e) {\n    if (!this.mouseSupport) {\n      return;\n    }\n    if (isInputElement(e.browserEvent.target) || isMonacoEditor(e.browserEvent.target)) {\n      return;\n    }\n    if (e.browserEvent.isHandledByList) {\n      return;\n    }\n    e.browserEvent.isHandledByList = true;\n    const focus = e.index;\n    if (typeof focus === 'undefined') {\n      this.list.setFocus([], e.browserEvent);\n      this.list.setSelection([], e.browserEvent);\n      this.list.setAnchor(undefined);\n      return;\n    }\n    if (this.isSelectionChangeEvent(e)) {\n      return this.changeSelection(e);\n    }\n    this.list.setFocus([focus], e.browserEvent);\n    this.list.setAnchor(focus);\n    if (!isMouseRightClick(e.browserEvent)) {\n      this.list.setSelection([focus], e.browserEvent);\n    }\n    this._onPointer.fire(e);\n  }\n  onDoubleClick(e) {\n    if (isInputElement(e.browserEvent.target) || isMonacoEditor(e.browserEvent.target)) {\n      return;\n    }\n    if (this.isSelectionChangeEvent(e)) {\n      return;\n    }\n    if (e.browserEvent.isHandledByList) {\n      return;\n    }\n    e.browserEvent.isHandledByList = true;\n    const focus = this.list.getFocus();\n    this.list.setSelection(focus, e.browserEvent);\n  }\n  changeSelection(e) {\n    const focus = e.index;\n    let anchor = this.list.getAnchor();\n    if (this.isSelectionRangeChangeEvent(e)) {\n      if (typeof anchor === 'undefined') {\n        const currentFocus = this.list.getFocus()[0];\n        anchor = currentFocus !== null && currentFocus !== void 0 ? currentFocus : focus;\n        this.list.setAnchor(anchor);\n      }\n      const min = Math.min(anchor, focus);\n      const max = Math.max(anchor, focus);\n      const rangeSelection = range(min, max + 1);\n      const selection = this.list.getSelection();\n      const contiguousRange = getContiguousRangeContaining(disjunction(selection, [anchor]), anchor);\n      if (contiguousRange.length === 0) {\n        return;\n      }\n      const newSelection = disjunction(rangeSelection, relativeComplement(selection, contiguousRange));\n      this.list.setSelection(newSelection, e.browserEvent);\n      this.list.setFocus([focus], e.browserEvent);\n    } else if (this.isSelectionSingleChangeEvent(e)) {\n      const selection = this.list.getSelection();\n      const newSelection = selection.filter(i => i !== focus);\n      this.list.setFocus([focus]);\n      this.list.setAnchor(focus);\n      if (selection.length === newSelection.length) {\n        this.list.setSelection([...newSelection, focus], e.browserEvent);\n      } else {\n        this.list.setSelection(newSelection, e.browserEvent);\n      }\n    }\n  }\n  dispose() {\n    this.disposables.dispose();\n  }\n}\nexport class DefaultStyleController {\n  constructor(styleElement, selectorSuffix) {\n    this.styleElement = styleElement;\n    this.selectorSuffix = selectorSuffix;\n  }\n  style(styles) {\n    var _styles$listFocusOutl, _styles$listInactiveF;\n    const suffix = this.selectorSuffix && \".\".concat(this.selectorSuffix);\n    const content = [];\n    if (styles.listBackground) {\n      content.push(\".monaco-list\".concat(suffix, \" .monaco-list-rows { background: \").concat(styles.listBackground, \"; }\"));\n    }\n    if (styles.listFocusBackground) {\n      content.push(\".monaco-list\".concat(suffix, \":focus .monaco-list-row.focused { background-color: \").concat(styles.listFocusBackground, \"; }\"));\n      content.push(\".monaco-list\".concat(suffix, \":focus .monaco-list-row.focused:hover { background-color: \").concat(styles.listFocusBackground, \"; }\")); // overwrite :hover style in this case!\n    }\n    if (styles.listFocusForeground) {\n      content.push(\".monaco-list\".concat(suffix, \":focus .monaco-list-row.focused { color: \").concat(styles.listFocusForeground, \"; }\"));\n    }\n    if (styles.listActiveSelectionBackground) {\n      content.push(\".monaco-list\".concat(suffix, \":focus .monaco-list-row.selected { background-color: \").concat(styles.listActiveSelectionBackground, \"; }\"));\n      content.push(\".monaco-list\".concat(suffix, \":focus .monaco-list-row.selected:hover { background-color: \").concat(styles.listActiveSelectionBackground, \"; }\")); // overwrite :hover style in this case!\n    }\n    if (styles.listActiveSelectionForeground) {\n      content.push(\".monaco-list\".concat(suffix, \":focus .monaco-list-row.selected { color: \").concat(styles.listActiveSelectionForeground, \"; }\"));\n    }\n    if (styles.listActiveSelectionIconForeground) {\n      content.push(\".monaco-list\".concat(suffix, \":focus .monaco-list-row.selected .codicon { color: \").concat(styles.listActiveSelectionIconForeground, \"; }\"));\n    }\n    if (styles.listFocusAndSelectionBackground) {\n      content.push(\"\\n\\t\\t\\t\\t.monaco-drag-image,\\n\\t\\t\\t\\t.monaco-list\".concat(suffix, \":focus .monaco-list-row.selected.focused { background-color: \").concat(styles.listFocusAndSelectionBackground, \"; }\\n\\t\\t\\t\"));\n    }\n    if (styles.listFocusAndSelectionForeground) {\n      content.push(\"\\n\\t\\t\\t\\t.monaco-drag-image,\\n\\t\\t\\t\\t.monaco-list\".concat(suffix, \":focus .monaco-list-row.selected.focused { color: \").concat(styles.listFocusAndSelectionForeground, \"; }\\n\\t\\t\\t\"));\n    }\n    if (styles.listInactiveFocusForeground) {\n      content.push(\".monaco-list\".concat(suffix, \" .monaco-list-row.focused { color:  \").concat(styles.listInactiveFocusForeground, \"; }\"));\n      content.push(\".monaco-list\".concat(suffix, \" .monaco-list-row.focused:hover { color:  \").concat(styles.listInactiveFocusForeground, \"; }\")); // overwrite :hover style in this case!\n    }\n    if (styles.listInactiveSelectionIconForeground) {\n      content.push(\".monaco-list\".concat(suffix, \" .monaco-list-row.focused .codicon { color:  \").concat(styles.listInactiveSelectionIconForeground, \"; }\"));\n    }\n    if (styles.listInactiveFocusBackground) {\n      content.push(\".monaco-list\".concat(suffix, \" .monaco-list-row.focused { background-color:  \").concat(styles.listInactiveFocusBackground, \"; }\"));\n      content.push(\".monaco-list\".concat(suffix, \" .monaco-list-row.focused:hover { background-color:  \").concat(styles.listInactiveFocusBackground, \"; }\")); // overwrite :hover style in this case!\n    }\n    if (styles.listInactiveSelectionBackground) {\n      content.push(\".monaco-list\".concat(suffix, \" .monaco-list-row.selected { background-color:  \").concat(styles.listInactiveSelectionBackground, \"; }\"));\n      content.push(\".monaco-list\".concat(suffix, \" .monaco-list-row.selected:hover { background-color:  \").concat(styles.listInactiveSelectionBackground, \"; }\")); // overwrite :hover style in this case!\n    }\n    if (styles.listInactiveSelectionForeground) {\n      content.push(\".monaco-list\".concat(suffix, \" .monaco-list-row.selected { color: \").concat(styles.listInactiveSelectionForeground, \"; }\"));\n    }\n    if (styles.listHoverBackground) {\n      content.push(\".monaco-list\".concat(suffix, \":not(.drop-target):not(.dragging) .monaco-list-row:hover:not(.selected):not(.focused) { background-color: \").concat(styles.listHoverBackground, \"; }\"));\n    }\n    if (styles.listHoverForeground) {\n      content.push(\".monaco-list\".concat(suffix, \":not(.drop-target):not(.dragging) .monaco-list-row:hover:not(.selected):not(.focused) { color:  \").concat(styles.listHoverForeground, \"; }\"));\n    }\n    /**\n     * Outlines\n     */\n    const focusAndSelectionOutline = asCssValueWithDefault(styles.listFocusAndSelectionOutline, asCssValueWithDefault(styles.listSelectionOutline, (_styles$listFocusOutl = styles.listFocusOutline) !== null && _styles$listFocusOutl !== void 0 ? _styles$listFocusOutl : ''));\n    if (focusAndSelectionOutline) {\n      // default: listFocusOutline\n      content.push(\".monaco-list\".concat(suffix, \":focus .monaco-list-row.focused.selected { outline: 1px solid \").concat(focusAndSelectionOutline, \"; outline-offset: -1px;}\"));\n    }\n    if (styles.listFocusOutline) {\n      // default: set\n      content.push(\"\\n\\t\\t\\t\\t.monaco-drag-image,\\n\\t\\t\\t\\t.monaco-list\".concat(suffix, \":focus .monaco-list-row.focused { outline: 1px solid \").concat(styles.listFocusOutline, \"; outline-offset: -1px; }\\n\\t\\t\\t\\t.monaco-workbench.context-menu-visible .monaco-list\").concat(suffix, \".last-focused .monaco-list-row.focused { outline: 1px solid \").concat(styles.listFocusOutline, \"; outline-offset: -1px; }\\n\\t\\t\\t\"));\n    }\n    const inactiveFocusAndSelectionOutline = asCssValueWithDefault(styles.listSelectionOutline, (_styles$listInactiveF = styles.listInactiveFocusOutline) !== null && _styles$listInactiveF !== void 0 ? _styles$listInactiveF : '');\n    if (inactiveFocusAndSelectionOutline) {\n      content.push(\".monaco-list\".concat(suffix, \" .monaco-list-row.focused.selected { outline: 1px dotted \").concat(inactiveFocusAndSelectionOutline, \"; outline-offset: -1px; }\"));\n    }\n    if (styles.listSelectionOutline) {\n      // default: activeContrastBorder\n      content.push(\".monaco-list\".concat(suffix, \" .monaco-list-row.selected { outline: 1px dotted \").concat(styles.listSelectionOutline, \"; outline-offset: -1px; }\"));\n    }\n    if (styles.listInactiveFocusOutline) {\n      // default: null\n      content.push(\".monaco-list\".concat(suffix, \" .monaco-list-row.focused { outline: 1px dotted \").concat(styles.listInactiveFocusOutline, \"; outline-offset: -1px; }\"));\n    }\n    if (styles.listHoverOutline) {\n      // default: activeContrastBorder\n      content.push(\".monaco-list\".concat(suffix, \" .monaco-list-row:hover { outline: 1px dashed \").concat(styles.listHoverOutline, \"; outline-offset: -1px; }\"));\n    }\n    if (styles.listDropOverBackground) {\n      content.push(\"\\n\\t\\t\\t\\t.monaco-list\".concat(suffix, \".drop-target,\\n\\t\\t\\t\\t.monaco-list\").concat(suffix, \" .monaco-list-rows.drop-target,\\n\\t\\t\\t\\t.monaco-list\").concat(suffix, \" .monaco-list-row.drop-target { background-color: \").concat(styles.listDropOverBackground, \" !important; color: inherit !important; }\\n\\t\\t\\t\"));\n    }\n    if (styles.listDropBetweenBackground) {\n      content.push(\"\\n\\t\\t\\t.monaco-list\".concat(suffix, \" .monaco-list-rows.drop-target-before .monaco-list-row:first-child::before,\\n\\t\\t\\t.monaco-list\").concat(suffix, \" .monaco-list-row.drop-target-before::before {\\n\\t\\t\\t\\tcontent: \\\"\\\"; position: absolute; top: 0px; left: 0px; width: 100%; height: 1px;\\n\\t\\t\\t\\tbackground-color: \").concat(styles.listDropBetweenBackground, \";\\n\\t\\t\\t}\"));\n      content.push(\"\\n\\t\\t\\t.monaco-list\".concat(suffix, \" .monaco-list-rows.drop-target-after .monaco-list-row:last-child::after,\\n\\t\\t\\t.monaco-list\").concat(suffix, \" .monaco-list-row.drop-target-after::after {\\n\\t\\t\\t\\tcontent: \\\"\\\"; position: absolute; bottom: 0px; left: 0px; width: 100%; height: 1px;\\n\\t\\t\\t\\tbackground-color: \").concat(styles.listDropBetweenBackground, \";\\n\\t\\t\\t}\"));\n    }\n    if (styles.tableColumnsBorder) {\n      content.push(\"\\n\\t\\t\\t\\t.monaco-table > .monaco-split-view2,\\n\\t\\t\\t\\t.monaco-table > .monaco-split-view2 .monaco-sash.vertical::before,\\n\\t\\t\\t\\t.monaco-workbench:not(.reduce-motion) .monaco-table:hover > .monaco-split-view2,\\n\\t\\t\\t\\t.monaco-workbench:not(.reduce-motion) .monaco-table:hover > .monaco-split-view2 .monaco-sash.vertical::before {\\n\\t\\t\\t\\t\\tborder-color: \".concat(styles.tableColumnsBorder, \";\\n\\t\\t\\t\\t}\\n\\n\\t\\t\\t\\t.monaco-workbench:not(.reduce-motion) .monaco-table > .monaco-split-view2,\\n\\t\\t\\t\\t.monaco-workbench:not(.reduce-motion) .monaco-table > .monaco-split-view2 .monaco-sash.vertical::before {\\n\\t\\t\\t\\t\\tborder-color: transparent;\\n\\t\\t\\t\\t}\\n\\t\\t\\t\"));\n    }\n    if (styles.tableOddRowsBackgroundColor) {\n      content.push(\"\\n\\t\\t\\t\\t.monaco-table .monaco-list-row[data-parity=odd]:not(.focused):not(.selected):not(:hover) .monaco-table-tr,\\n\\t\\t\\t\\t.monaco-table .monaco-list:not(:focus) .monaco-list-row[data-parity=odd].focused:not(.selected):not(:hover) .monaco-table-tr,\\n\\t\\t\\t\\t.monaco-table .monaco-list:not(.focused) .monaco-list-row[data-parity=odd].focused:not(.selected):not(:hover) .monaco-table-tr {\\n\\t\\t\\t\\t\\tbackground-color: \".concat(styles.tableOddRowsBackgroundColor, \";\\n\\t\\t\\t\\t}\\n\\t\\t\\t\"));\n    }\n    this.styleElement.textContent = content.join('\\n');\n  }\n}\nexport const unthemedListStyles = {\n  listFocusBackground: '#7FB0D0',\n  listActiveSelectionBackground: '#0E639C',\n  listActiveSelectionForeground: '#FFFFFF',\n  listActiveSelectionIconForeground: '#FFFFFF',\n  listFocusAndSelectionOutline: '#90C2F9',\n  listFocusAndSelectionBackground: '#094771',\n  listFocusAndSelectionForeground: '#FFFFFF',\n  listInactiveSelectionBackground: '#3F3F46',\n  listInactiveSelectionIconForeground: '#FFFFFF',\n  listHoverBackground: '#2A2D2E',\n  listDropOverBackground: '#383B3D',\n  listDropBetweenBackground: '#EEEEEE',\n  treeIndentGuidesStroke: '#a9a9a9',\n  treeInactiveIndentGuidesStroke: Color.fromHex('#a9a9a9').transparent(0.4).toString(),\n  tableColumnsBorder: Color.fromHex('#cccccc').transparent(0.2).toString(),\n  tableOddRowsBackgroundColor: Color.fromHex('#cccccc').transparent(0.04).toString(),\n  listBackground: undefined,\n  listFocusForeground: undefined,\n  listInactiveSelectionForeground: undefined,\n  listInactiveFocusForeground: undefined,\n  listInactiveFocusBackground: undefined,\n  listHoverForeground: undefined,\n  listFocusOutline: undefined,\n  listInactiveFocusOutline: undefined,\n  listSelectionOutline: undefined,\n  listHoverOutline: undefined,\n  treeStickyScrollBackground: undefined,\n  treeStickyScrollBorder: undefined,\n  treeStickyScrollShadow: undefined\n};\nconst DefaultOptions = {\n  keyboardSupport: true,\n  mouseSupport: true,\n  multipleSelectionSupport: true,\n  dnd: {\n    getDragURI() {\n      return null;\n    },\n    onDragStart() {},\n    onDragOver() {\n      return false;\n    },\n    drop() {},\n    dispose() {}\n  }\n};\n// TODO@Joao: move these utils into a SortedArray class\nfunction getContiguousRangeContaining(range, value) {\n  const index = range.indexOf(value);\n  if (index === -1) {\n    return [];\n  }\n  const result = [];\n  let i = index - 1;\n  while (i >= 0 && range[i] === value - (index - i)) {\n    result.push(range[i--]);\n  }\n  result.reverse();\n  i = index;\n  while (i < range.length && range[i] === value + (i - index)) {\n    result.push(range[i++]);\n  }\n  return result;\n}\n/**\n * Given two sorted collections of numbers, returns the intersection\n * between them (OR).\n */\nfunction disjunction(one, other) {\n  const result = [];\n  let i = 0,\n    j = 0;\n  while (i < one.length || j < other.length) {\n    if (i >= one.length) {\n      result.push(other[j++]);\n    } else if (j >= other.length) {\n      result.push(one[i++]);\n    } else if (one[i] === other[j]) {\n      result.push(one[i]);\n      i++;\n      j++;\n      continue;\n    } else if (one[i] < other[j]) {\n      result.push(one[i++]);\n    } else {\n      result.push(other[j++]);\n    }\n  }\n  return result;\n}\n/**\n * Given two sorted collections of numbers, returns the relative\n * complement between them (XOR).\n */\nfunction relativeComplement(one, other) {\n  const result = [];\n  let i = 0,\n    j = 0;\n  while (i < one.length || j < other.length) {\n    if (i >= one.length) {\n      result.push(other[j++]);\n    } else if (j >= other.length) {\n      result.push(one[i++]);\n    } else if (one[i] === other[j]) {\n      i++;\n      j++;\n      continue;\n    } else if (one[i] < other[j]) {\n      result.push(one[i++]);\n    } else {\n      j++;\n    }\n  }\n  return result;\n}\nconst numericSort = (a, b) => a - b;\nclass PipelineRenderer {\n  constructor(_templateId, renderers) {\n    this._templateId = _templateId;\n    this.renderers = renderers;\n  }\n  get templateId() {\n    return this._templateId;\n  }\n  renderTemplate(container) {\n    return this.renderers.map(r => r.renderTemplate(container));\n  }\n  renderElement(element, index, templateData, height) {\n    let i = 0;\n    for (const renderer of this.renderers) {\n      renderer.renderElement(element, index, templateData[i++], height);\n    }\n  }\n  disposeElement(element, index, templateData, height) {\n    let i = 0;\n    for (const renderer of this.renderers) {\n      var _renderer$disposeElem;\n      (_renderer$disposeElem = renderer.disposeElement) === null || _renderer$disposeElem === void 0 || _renderer$disposeElem.call(renderer, element, index, templateData[i], height);\n      i += 1;\n    }\n  }\n  disposeTemplate(templateData) {\n    let i = 0;\n    for (const renderer of this.renderers) {\n      renderer.disposeTemplate(templateData[i++]);\n    }\n  }\n}\nclass AccessibiltyRenderer {\n  constructor(accessibilityProvider) {\n    this.accessibilityProvider = accessibilityProvider;\n    this.templateId = 'a18n';\n  }\n  renderTemplate(container) {\n    return {\n      container,\n      disposables: new DisposableStore()\n    };\n  }\n  renderElement(element, index, data) {\n    const ariaLabel = this.accessibilityProvider.getAriaLabel(element);\n    const observable = ariaLabel && typeof ariaLabel !== 'string' ? ariaLabel : constObservable(ariaLabel);\n    data.disposables.add(autorun(reader => {\n      this.setAriaLabel(reader.readObservable(observable), data.container);\n    }));\n    const ariaLevel = this.accessibilityProvider.getAriaLevel && this.accessibilityProvider.getAriaLevel(element);\n    if (typeof ariaLevel === 'number') {\n      data.container.setAttribute('aria-level', \"\".concat(ariaLevel));\n    } else {\n      data.container.removeAttribute('aria-level');\n    }\n  }\n  setAriaLabel(ariaLabel, element) {\n    if (ariaLabel) {\n      element.setAttribute('aria-label', ariaLabel);\n    } else {\n      element.removeAttribute('aria-label');\n    }\n  }\n  disposeElement(element, index, templateData, height) {\n    templateData.disposables.clear();\n  }\n  disposeTemplate(templateData) {\n    templateData.disposables.dispose();\n  }\n}\nclass ListViewDragAndDrop {\n  constructor(list, dnd) {\n    this.list = list;\n    this.dnd = dnd;\n  }\n  getDragElements(element) {\n    const selection = this.list.getSelectedElements();\n    const elements = selection.indexOf(element) > -1 ? selection : [element];\n    return elements;\n  }\n  getDragURI(element) {\n    return this.dnd.getDragURI(element);\n  }\n  getDragLabel(elements, originalEvent) {\n    if (this.dnd.getDragLabel) {\n      return this.dnd.getDragLabel(elements, originalEvent);\n    }\n    return undefined;\n  }\n  onDragStart(data, originalEvent) {\n    var _this$dnd$onDragStart, _this$dnd;\n    (_this$dnd$onDragStart = (_this$dnd = this.dnd).onDragStart) === null || _this$dnd$onDragStart === void 0 || _this$dnd$onDragStart.call(_this$dnd, data, originalEvent);\n  }\n  onDragOver(data, targetElement, targetIndex, targetSector, originalEvent) {\n    return this.dnd.onDragOver(data, targetElement, targetIndex, targetSector, originalEvent);\n  }\n  onDragLeave(data, targetElement, targetIndex, originalEvent) {\n    var _this$dnd$onDragLeave, _this$dnd2;\n    (_this$dnd$onDragLeave = (_this$dnd2 = this.dnd).onDragLeave) === null || _this$dnd$onDragLeave === void 0 || _this$dnd$onDragLeave.call(_this$dnd2, data, targetElement, targetIndex, originalEvent);\n  }\n  onDragEnd(originalEvent) {\n    var _this$dnd$onDragEnd, _this$dnd3;\n    (_this$dnd$onDragEnd = (_this$dnd3 = this.dnd).onDragEnd) === null || _this$dnd$onDragEnd === void 0 || _this$dnd$onDragEnd.call(_this$dnd3, originalEvent);\n  }\n  drop(data, targetElement, targetIndex, targetSector, originalEvent) {\n    this.dnd.drop(data, targetElement, targetIndex, targetSector, originalEvent);\n  }\n  dispose() {\n    this.dnd.dispose();\n  }\n}\n/**\n * The {@link List} is a virtual scrolling widget, built on top of the {@link ListView}\n * widget.\n *\n * Features:\n * - Customizable keyboard and mouse support\n * - Element traits: focus, selection, achor\n * - Accessibility support\n * - Touch support\n * - Performant template-based rendering\n * - Horizontal scrolling\n * - Variable element height support\n * - Dynamic element height support\n * - Drag-and-drop support\n */\nexport class List {\n  get onDidChangeFocus() {\n    return Event.map(this.eventBufferer.wrapEvent(this.focus.onChange), e => this.toListEvent(e), this.disposables);\n  }\n  get onDidChangeSelection() {\n    return Event.map(this.eventBufferer.wrapEvent(this.selection.onChange), e => this.toListEvent(e), this.disposables);\n  }\n  get domId() {\n    return this.view.domId;\n  }\n  get onDidScroll() {\n    return this.view.onDidScroll;\n  }\n  get onMouseClick() {\n    return this.view.onMouseClick;\n  }\n  get onMouseDblClick() {\n    return this.view.onMouseDblClick;\n  }\n  get onMouseMiddleClick() {\n    return this.view.onMouseMiddleClick;\n  }\n  get onPointer() {\n    return this.mouseController.onPointer;\n  }\n  get onMouseDown() {\n    return this.view.onMouseDown;\n  }\n  get onMouseOver() {\n    return this.view.onMouseOver;\n  }\n  get onMouseOut() {\n    return this.view.onMouseOut;\n  }\n  get onTouchStart() {\n    return this.view.onTouchStart;\n  }\n  get onTap() {\n    return this.view.onTap;\n  }\n  /**\n   * Possible context menu trigger events:\n   * - ContextMenu key\n   * - Shift F10\n   * - Ctrl Option Shift M (macOS with VoiceOver)\n   * - Mouse right click\n   */\n  get onContextMenu() {\n    let didJustPressContextMenuKey = false;\n    const fromKeyDown = Event.chain(this.disposables.add(new DomEmitter(this.view.domNode, 'keydown')).event, $ => $.map(e => new StandardKeyboardEvent(e)).filter(e => didJustPressContextMenuKey = e.keyCode === 58 /* KeyCode.ContextMenu */ || e.shiftKey && e.keyCode === 68 /* KeyCode.F10 */).map(e => EventHelper.stop(e, true)).filter(() => false));\n    const fromKeyUp = Event.chain(this.disposables.add(new DomEmitter(this.view.domNode, 'keyup')).event, $ => $.forEach(() => didJustPressContextMenuKey = false).map(e => new StandardKeyboardEvent(e)).filter(e => e.keyCode === 58 /* KeyCode.ContextMenu */ || e.shiftKey && e.keyCode === 68 /* KeyCode.F10 */).map(e => EventHelper.stop(e, true)).map(_ref => {\n      let {\n        browserEvent\n      } = _ref;\n      const focus = this.getFocus();\n      const index = focus.length ? focus[0] : undefined;\n      const element = typeof index !== 'undefined' ? this.view.element(index) : undefined;\n      const anchor = typeof index !== 'undefined' ? this.view.domElement(index) : this.view.domNode;\n      return {\n        index,\n        element,\n        anchor,\n        browserEvent\n      };\n    }));\n    const fromMouse = Event.chain(this.view.onContextMenu, $ => $.filter(_ => !didJustPressContextMenuKey).map(_ref2 => {\n      let {\n        element,\n        index,\n        browserEvent\n      } = _ref2;\n      return {\n        element,\n        index,\n        anchor: new StandardMouseEvent(getWindow(this.view.domNode), browserEvent),\n        browserEvent\n      };\n    }));\n    return Event.any(fromKeyDown, fromKeyUp, fromMouse);\n  }\n  get onKeyDown() {\n    return this.disposables.add(new DomEmitter(this.view.domNode, 'keydown')).event;\n  }\n  get onDidFocus() {\n    return Event.signal(this.disposables.add(new DomEmitter(this.view.domNode, 'focus', true)).event);\n  }\n  get onDidBlur() {\n    return Event.signal(this.disposables.add(new DomEmitter(this.view.domNode, 'blur', true)).event);\n  }\n  constructor(user, container, virtualDelegate, renderers) {\n    var _this$_options$access;\n    let _options = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : DefaultOptions;\n    this.user = user;\n    this._options = _options;\n    this.focus = new Trait('focused');\n    this.anchor = new Trait('anchor');\n    this.eventBufferer = new EventBufferer();\n    this._ariaLabel = '';\n    this.disposables = new DisposableStore();\n    this._onDidDispose = new Emitter();\n    this.onDidDispose = this._onDidDispose.event;\n    const role = this._options.accessibilityProvider && this._options.accessibilityProvider.getWidgetRole ? (_this$_options$access = this._options.accessibilityProvider) === null || _this$_options$access === void 0 ? void 0 : _this$_options$access.getWidgetRole() : 'list';\n    this.selection = new SelectionTrait(role !== 'listbox');\n    const baseRenderers = [this.focus.renderer, this.selection.renderer];\n    this.accessibilityProvider = _options.accessibilityProvider;\n    if (this.accessibilityProvider) {\n      var _this$accessibilityPr, _this$accessibilityPr2;\n      baseRenderers.push(new AccessibiltyRenderer(this.accessibilityProvider));\n      (_this$accessibilityPr = (_this$accessibilityPr2 = this.accessibilityProvider).onDidChangeActiveDescendant) === null || _this$accessibilityPr === void 0 || _this$accessibilityPr.call(_this$accessibilityPr2, this.onDidChangeActiveDescendant, this, this.disposables);\n    }\n    renderers = renderers.map(r => new PipelineRenderer(r.templateId, [...baseRenderers, r]));\n    const viewOptions = {\n      ..._options,\n      dnd: _options.dnd && new ListViewDragAndDrop(this, _options.dnd)\n    };\n    this.view = this.createListView(container, virtualDelegate, renderers, viewOptions);\n    this.view.domNode.setAttribute('role', role);\n    if (_options.styleController) {\n      this.styleController = _options.styleController(this.view.domId);\n    } else {\n      const styleElement = createStyleSheet(this.view.domNode);\n      this.styleController = new DefaultStyleController(styleElement, this.view.domId);\n    }\n    this.spliceable = new CombinedSpliceable([new TraitSpliceable(this.focus, this.view, _options.identityProvider), new TraitSpliceable(this.selection, this.view, _options.identityProvider), new TraitSpliceable(this.anchor, this.view, _options.identityProvider), this.view]);\n    this.disposables.add(this.focus);\n    this.disposables.add(this.selection);\n    this.disposables.add(this.anchor);\n    this.disposables.add(this.view);\n    this.disposables.add(this._onDidDispose);\n    this.disposables.add(new DOMFocusController(this, this.view));\n    if (typeof _options.keyboardSupport !== 'boolean' || _options.keyboardSupport) {\n      this.keyboardController = new KeyboardController(this, this.view, _options);\n      this.disposables.add(this.keyboardController);\n    }\n    if (_options.keyboardNavigationLabelProvider) {\n      var _options$keyboardNavi;\n      const delegate = _options.keyboardNavigationDelegate || DefaultKeyboardNavigationDelegate;\n      this.typeNavigationController = new TypeNavigationController(this, this.view, _options.keyboardNavigationLabelProvider, (_options$keyboardNavi = _options.keyboardNavigationEventFilter) !== null && _options$keyboardNavi !== void 0 ? _options$keyboardNavi : () => true, delegate);\n      this.disposables.add(this.typeNavigationController);\n    }\n    this.mouseController = this.createMouseController(_options);\n    this.disposables.add(this.mouseController);\n    this.onDidChangeFocus(this._onFocusChange, this, this.disposables);\n    this.onDidChangeSelection(this._onSelectionChange, this, this.disposables);\n    if (this.accessibilityProvider) {\n      this.ariaLabel = this.accessibilityProvider.getWidgetAriaLabel();\n    }\n    if (this._options.multipleSelectionSupport !== false) {\n      this.view.domNode.setAttribute('aria-multiselectable', 'true');\n    }\n  }\n  createListView(container, virtualDelegate, renderers, viewOptions) {\n    return new ListView(container, virtualDelegate, renderers, viewOptions);\n  }\n  createMouseController(options) {\n    return new MouseController(this);\n  }\n  updateOptions() {\n    var _this$typeNavigationC, _this$keyboardControl;\n    let optionsUpdate = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    this._options = {\n      ...this._options,\n      ...optionsUpdate\n    };\n    (_this$typeNavigationC = this.typeNavigationController) === null || _this$typeNavigationC === void 0 || _this$typeNavigationC.updateOptions(this._options);\n    if (this._options.multipleSelectionController !== undefined) {\n      if (this._options.multipleSelectionSupport) {\n        this.view.domNode.setAttribute('aria-multiselectable', 'true');\n      } else {\n        this.view.domNode.removeAttribute('aria-multiselectable');\n      }\n    }\n    this.mouseController.updateOptions(optionsUpdate);\n    (_this$keyboardControl = this.keyboardController) === null || _this$keyboardControl === void 0 || _this$keyboardControl.updateOptions(optionsUpdate);\n    this.view.updateOptions(optionsUpdate);\n  }\n  get options() {\n    return this._options;\n  }\n  splice(start, deleteCount) {\n    let elements = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : [];\n    if (start < 0 || start > this.view.length) {\n      throw new ListError(this.user, \"Invalid start index: \".concat(start));\n    }\n    if (deleteCount < 0) {\n      throw new ListError(this.user, \"Invalid delete count: \".concat(deleteCount));\n    }\n    if (deleteCount === 0 && elements.length === 0) {\n      return;\n    }\n    this.eventBufferer.bufferEvents(() => this.spliceable.splice(start, deleteCount, elements));\n  }\n  rerender() {\n    this.view.rerender();\n  }\n  element(index) {\n    return this.view.element(index);\n  }\n  indexOf(element) {\n    return this.view.indexOf(element);\n  }\n  indexAt(position) {\n    return this.view.indexAt(position);\n  }\n  get length() {\n    return this.view.length;\n  }\n  get contentHeight() {\n    return this.view.contentHeight;\n  }\n  get onDidChangeContentHeight() {\n    return this.view.onDidChangeContentHeight;\n  }\n  get scrollTop() {\n    return this.view.getScrollTop();\n  }\n  set scrollTop(scrollTop) {\n    this.view.setScrollTop(scrollTop);\n  }\n  get scrollHeight() {\n    return this.view.scrollHeight;\n  }\n  get renderHeight() {\n    return this.view.renderHeight;\n  }\n  get firstVisibleIndex() {\n    return this.view.firstVisibleIndex;\n  }\n  get ariaLabel() {\n    return this._ariaLabel;\n  }\n  set ariaLabel(value) {\n    this._ariaLabel = value;\n    this.view.domNode.setAttribute('aria-label', value);\n  }\n  domFocus() {\n    this.view.domNode.focus({\n      preventScroll: true\n    });\n  }\n  layout(height, width) {\n    this.view.layout(height, width);\n  }\n  setSelection(indexes, browserEvent) {\n    for (const index of indexes) {\n      if (index < 0 || index >= this.length) {\n        throw new ListError(this.user, \"Invalid index \".concat(index));\n      }\n    }\n    this.selection.set(indexes, browserEvent);\n  }\n  getSelection() {\n    return this.selection.get();\n  }\n  getSelectedElements() {\n    return this.getSelection().map(i => this.view.element(i));\n  }\n  setAnchor(index) {\n    if (typeof index === 'undefined') {\n      this.anchor.set([]);\n      return;\n    }\n    if (index < 0 || index >= this.length) {\n      throw new ListError(this.user, \"Invalid index \".concat(index));\n    }\n    this.anchor.set([index]);\n  }\n  getAnchor() {\n    return firstOrDefault(this.anchor.get(), undefined);\n  }\n  getAnchorElement() {\n    const anchor = this.getAnchor();\n    return typeof anchor === 'undefined' ? undefined : this.element(anchor);\n  }\n  setFocus(indexes, browserEvent) {\n    for (const index of indexes) {\n      if (index < 0 || index >= this.length) {\n        throw new ListError(this.user, \"Invalid index \".concat(index));\n      }\n    }\n    this.focus.set(indexes, browserEvent);\n  }\n  focusNext() {\n    let n = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 1;\n    let loop = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n    let browserEvent = arguments.length > 2 ? arguments[2] : undefined;\n    let filter = arguments.length > 3 ? arguments[3] : undefined;\n    if (this.length === 0) {\n      return;\n    }\n    const focus = this.focus.get();\n    const index = this.findNextIndex(focus.length > 0 ? focus[0] + n : 0, loop, filter);\n    if (index > -1) {\n      this.setFocus([index], browserEvent);\n    }\n  }\n  focusPrevious() {\n    let n = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 1;\n    let loop = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n    let browserEvent = arguments.length > 2 ? arguments[2] : undefined;\n    let filter = arguments.length > 3 ? arguments[3] : undefined;\n    if (this.length === 0) {\n      return;\n    }\n    const focus = this.focus.get();\n    const index = this.findPreviousIndex(focus.length > 0 ? focus[0] - n : 0, loop, filter);\n    if (index > -1) {\n      this.setFocus([index], browserEvent);\n    }\n  }\n  async focusNextPage(browserEvent, filter) {\n    let lastPageIndex = this.view.indexAt(this.view.getScrollTop() + this.view.renderHeight);\n    lastPageIndex = lastPageIndex === 0 ? 0 : lastPageIndex - 1;\n    const currentlyFocusedElementIndex = this.getFocus()[0];\n    if (currentlyFocusedElementIndex !== lastPageIndex && (currentlyFocusedElementIndex === undefined || lastPageIndex > currentlyFocusedElementIndex)) {\n      const lastGoodPageIndex = this.findPreviousIndex(lastPageIndex, false, filter);\n      if (lastGoodPageIndex > -1 && currentlyFocusedElementIndex !== lastGoodPageIndex) {\n        this.setFocus([lastGoodPageIndex], browserEvent);\n      } else {\n        this.setFocus([lastPageIndex], browserEvent);\n      }\n    } else {\n      const previousScrollTop = this.view.getScrollTop();\n      let nextpageScrollTop = previousScrollTop + this.view.renderHeight;\n      if (lastPageIndex > currentlyFocusedElementIndex) {\n        // scroll last page element to the top only if the last page element is below the focused element\n        nextpageScrollTop -= this.view.elementHeight(lastPageIndex);\n      }\n      this.view.setScrollTop(nextpageScrollTop);\n      if (this.view.getScrollTop() !== previousScrollTop) {\n        this.setFocus([]);\n        // Let the scroll event listener run\n        await timeout(0);\n        await this.focusNextPage(browserEvent, filter);\n      }\n    }\n  }\n  async focusPreviousPage(browserEvent, filter) {\n    let getPaddingTop = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : () => 0;\n    let firstPageIndex;\n    const paddingTop = getPaddingTop();\n    const scrollTop = this.view.getScrollTop() + paddingTop;\n    if (scrollTop === 0) {\n      firstPageIndex = this.view.indexAt(scrollTop);\n    } else {\n      firstPageIndex = this.view.indexAfter(scrollTop - 1);\n    }\n    const currentlyFocusedElementIndex = this.getFocus()[0];\n    if (currentlyFocusedElementIndex !== firstPageIndex && (currentlyFocusedElementIndex === undefined || currentlyFocusedElementIndex >= firstPageIndex)) {\n      const firstGoodPageIndex = this.findNextIndex(firstPageIndex, false, filter);\n      if (firstGoodPageIndex > -1 && currentlyFocusedElementIndex !== firstGoodPageIndex) {\n        this.setFocus([firstGoodPageIndex], browserEvent);\n      } else {\n        this.setFocus([firstPageIndex], browserEvent);\n      }\n    } else {\n      const previousScrollTop = scrollTop;\n      this.view.setScrollTop(scrollTop - this.view.renderHeight - paddingTop);\n      if (this.view.getScrollTop() + getPaddingTop() !== previousScrollTop) {\n        this.setFocus([]);\n        // Let the scroll event listener run\n        await timeout(0);\n        await this.focusPreviousPage(browserEvent, filter, getPaddingTop);\n      }\n    }\n  }\n  focusLast(browserEvent, filter) {\n    if (this.length === 0) {\n      return;\n    }\n    const index = this.findPreviousIndex(this.length - 1, false, filter);\n    if (index > -1) {\n      this.setFocus([index], browserEvent);\n    }\n  }\n  focusFirst(browserEvent, filter) {\n    this.focusNth(0, browserEvent, filter);\n  }\n  focusNth(n, browserEvent, filter) {\n    if (this.length === 0) {\n      return;\n    }\n    const index = this.findNextIndex(n, false, filter);\n    if (index > -1) {\n      this.setFocus([index], browserEvent);\n    }\n  }\n  findNextIndex(index) {\n    let loop = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n    let filter = arguments.length > 2 ? arguments[2] : undefined;\n    for (let i = 0; i < this.length; i++) {\n      if (index >= this.length && !loop) {\n        return -1;\n      }\n      index = index % this.length;\n      if (!filter || filter(this.element(index))) {\n        return index;\n      }\n      index++;\n    }\n    return -1;\n  }\n  findPreviousIndex(index) {\n    let loop = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n    let filter = arguments.length > 2 ? arguments[2] : undefined;\n    for (let i = 0; i < this.length; i++) {\n      if (index < 0 && !loop) {\n        return -1;\n      }\n      index = (this.length + index % this.length) % this.length;\n      if (!filter || filter(this.element(index))) {\n        return index;\n      }\n      index--;\n    }\n    return -1;\n  }\n  getFocus() {\n    return this.focus.get();\n  }\n  getFocusedElements() {\n    return this.getFocus().map(i => this.view.element(i));\n  }\n  reveal(index, relativeTop) {\n    let paddingTop = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;\n    if (index < 0 || index >= this.length) {\n      throw new ListError(this.user, \"Invalid index \".concat(index));\n    }\n    const scrollTop = this.view.getScrollTop();\n    const elementTop = this.view.elementTop(index);\n    const elementHeight = this.view.elementHeight(index);\n    if (isNumber(relativeTop)) {\n      // y = mx + b\n      const m = elementHeight - this.view.renderHeight + paddingTop;\n      this.view.setScrollTop(m * clamp(relativeTop, 0, 1) + elementTop - paddingTop);\n    } else {\n      const viewItemBottom = elementTop + elementHeight;\n      const scrollBottom = scrollTop + this.view.renderHeight;\n      if (elementTop < scrollTop + paddingTop && viewItemBottom >= scrollBottom) {\n        // The element is already overflowing the viewport, no-op\n      } else if (elementTop < scrollTop + paddingTop || viewItemBottom >= scrollBottom && elementHeight >= this.view.renderHeight) {\n        this.view.setScrollTop(elementTop - paddingTop);\n      } else if (viewItemBottom >= scrollBottom) {\n        this.view.setScrollTop(viewItemBottom - this.view.renderHeight);\n      }\n    }\n  }\n  /**\n   * Returns the relative position of an element rendered in the list.\n   * Returns `null` if the element isn't *entirely* in the visible viewport.\n   */\n  getRelativeTop(index) {\n    let paddingTop = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n    if (index < 0 || index >= this.length) {\n      throw new ListError(this.user, \"Invalid index \".concat(index));\n    }\n    const scrollTop = this.view.getScrollTop();\n    const elementTop = this.view.elementTop(index);\n    const elementHeight = this.view.elementHeight(index);\n    if (elementTop < scrollTop + paddingTop || elementTop + elementHeight > scrollTop + this.view.renderHeight) {\n      return null;\n    }\n    // y = mx + b\n    const m = elementHeight - this.view.renderHeight + paddingTop;\n    return Math.abs((scrollTop + paddingTop - elementTop) / m);\n  }\n  getHTMLElement() {\n    return this.view.domNode;\n  }\n  getScrollableElement() {\n    return this.view.scrollableElementDomNode;\n  }\n  getElementID(index) {\n    return this.view.getElementDomId(index);\n  }\n  getElementTop(index) {\n    return this.view.elementTop(index);\n  }\n  style(styles) {\n    this.styleController.style(styles);\n  }\n  toListEvent(_ref3) {\n    let {\n      indexes,\n      browserEvent\n    } = _ref3;\n    return {\n      indexes,\n      elements: indexes.map(i => this.view.element(i)),\n      browserEvent\n    };\n  }\n  _onFocusChange() {\n    const focus = this.focus.get();\n    this.view.domNode.classList.toggle('element-focused', focus.length > 0);\n    this.onDidChangeActiveDescendant();\n  }\n  onDidChangeActiveDescendant() {\n    const focus = this.focus.get();\n    if (focus.length > 0) {\n      var _this$accessibilityPr3;\n      let id;\n      if ((_this$accessibilityPr3 = this.accessibilityProvider) !== null && _this$accessibilityPr3 !== void 0 && _this$accessibilityPr3.getActiveDescendantId) {\n        id = this.accessibilityProvider.getActiveDescendantId(this.view.element(focus[0]));\n      }\n      this.view.domNode.setAttribute('aria-activedescendant', id || this.view.getElementDomId(focus[0]));\n    } else {\n      this.view.domNode.removeAttribute('aria-activedescendant');\n    }\n  }\n  _onSelectionChange() {\n    const selection = this.selection.get();\n    this.view.domNode.classList.toggle('selection-none', selection.length === 0);\n    this.view.domNode.classList.toggle('selection-single', selection.length === 1);\n    this.view.domNode.classList.toggle('selection-multiple', selection.length > 1);\n  }\n  dispose() {\n    this._onDidDispose.fire();\n    this.disposables.dispose();\n    this._onDidDispose.dispose();\n  }\n}\n__decorate([memoize], List.prototype, \"onDidChangeFocus\", null);\n__decorate([memoize], List.prototype, \"onDidChangeSelection\", null);\n__decorate([memoize], List.prototype, \"onContextMenu\", null);\n__decorate([memoize], List.prototype, \"onKeyDown\", null);\n__decorate([memoize], List.prototype, \"onDidFocus\", null);\n__decorate([memoize], List.prototype, \"onDidBlur\", null);","map":{"version":3,"names":["__decorate","decorators","target","key","desc","c","arguments","length","r","Object","getOwnPropertyDescriptor","d","Reflect","decorate","i","defineProperty","asCssValueWithDefault","createStyleSheet","EventHelper","getActiveElement","getWindow","isHTMLElement","isMouseEvent","DomEmitter","StandardKeyboardEvent","Gesture","alert","CombinedSpliceable","binarySearch","firstOrDefault","range","timeout","Color","memoize","Emitter","Event","EventBufferer","matchesFuzzy2","matchesPrefix","DisposableStore","dispose","clamp","platform","isNumber","ListError","ListView","StandardMouseEvent","autorun","constObservable","TraitRenderer","constructor","trait","renderedElements","templateId","concat","name","renderTemplate","container","renderElement","element","index","templateData","renderedElementIndex","findIndex","el","rendered","unrender","push","renderIndex","splice","start","deleteCount","insertCount","renderedElement","renderIndexes","indexes","indexOf","disposeTemplate","Trait","_trait","renderer","sortedIndexes","_onChange","onChange","event","elements","diff","end","j","_set","classList","toggle","contains","remove","set","browserEvent","sort","numericSort","result","sortedResult","toRender","disjunction","fire","get","prototype","SelectionTrait","setAriaSelected","setAttribute","TraitSpliceable","view","identityProvider","Array","fill","pastElementsWithTrait","map","getId","toString","pastElementsWithTraitSet","Set","elementsWithTrait","e","has","isInputElement","tagName","isListElementDescendantOfClass","className","parentElement","isMonacoEditor","isMonacoCustomToggle","isActionItem","isStickyScrollElement","isStickyScrollContainer","isButton","KeyboardController","onKeyDown","chain","disposables","add","domNode","$","filter","list","options","multipleSelectionDisposables","multipleSelectionSupport","keyCode","onEnter","onUpArrow","onDownArrow","onPageUpArrow","onPageDownArrow","onEscape","isMacintosh","metaKey","ctrlKey","onCtrlA","updateOptions","optionsUpdate","undefined","preventDefault","stopPropagation","setSelection","getFocus","focusPrevious","setAnchor","reveal","focus","focusNext","focusPreviousPage","focusNextPage","getSelection","TypeNavigationMode","TypeNavigationControllerState","DefaultKeyboardNavigationDelegate","mightProducePrintableCharacter","altKey","TypeNavigationController","keyboardNavigationLabelProvider","keyboardNavigationEventFilter","delegate","enabled","state","Idle","mode","Automatic","triggered","previouslyFocused","enabledDisposables","_options$typeNavigati","_options$typeNavigati2","typeNavigationEnabled","enable","disable","typeNavigationMode","typing","onChar","forEach","stop","onClear","debounce","onInput","reduce","any","clear","_this$list$options$ac","ariaLabel","accessibilityProvider","getAriaLabel","word","delta","Typing","label","getKeyboardNavigationLabel","labelStr","setFocus","fuzzy","fuzzyScore","DOMFocusController","onTab","shiftKey","focusedDomElement","domElement","tabIndexElement","querySelector","tabIndex","style","getComputedStyle","visibility","display","isSelectionSingleChangeEvent","isSelectionRangeChangeEvent","isMouseRightClick","button","DefaultMultipleSelectionController","MouseController","_onPointer","onPointer","multipleSelectionController","mouseSupport","onMouseDown","onContextMenu","onMouseDblClick","onDoubleClick","onTouchStart","addTarget","getHTMLElement","onMouseClick","onMouseMiddleClick","onTap","onViewPointer","isSelectionChangeEvent","domFocus","isHandledByList","changeSelection","anchor","getAnchor","currentFocus","min","Math","max","rangeSelection","selection","contiguousRange","getContiguousRangeContaining","newSelection","relativeComplement","DefaultStyleController","styleElement","selectorSuffix","styles","_styles$listFocusOutl","_styles$listInactiveF","suffix","content","listBackground","listFocusBackground","listFocusForeground","listActiveSelectionBackground","listActiveSelectionForeground","listActiveSelectionIconForeground","listFocusAndSelectionBackground","listFocusAndSelectionForeground","listInactiveFocusForeground","listInactiveSelectionIconForeground","listInactiveFocusBackground","listInactiveSelectionBackground","listInactiveSelectionForeground","listHoverBackground","listHoverForeground","focusAndSelectionOutline","listFocusAndSelectionOutline","listSelectionOutline","listFocusOutline","inactiveFocusAndSelectionOutline","listInactiveFocusOutline","listHoverOutline","listDropOverBackground","listDropBetweenBackground","tableColumnsBorder","tableOddRowsBackgroundColor","textContent","join","unthemedListStyles","treeIndentGuidesStroke","treeInactiveIndentGuidesStroke","fromHex","transparent","treeStickyScrollBackground","treeStickyScrollBorder","treeStickyScrollShadow","DefaultOptions","keyboardSupport","dnd","getDragURI","onDragStart","onDragOver","drop","value","reverse","one","other","a","b","PipelineRenderer","_templateId","renderers","height","disposeElement","_renderer$disposeElem","call","AccessibiltyRenderer","data","observable","reader","setAriaLabel","readObservable","ariaLevel","getAriaLevel","removeAttribute","ListViewDragAndDrop","getDragElements","getSelectedElements","getDragLabel","originalEvent","_this$dnd$onDragStart","_this$dnd","targetElement","targetIndex","targetSector","onDragLeave","_this$dnd$onDragLeave","_this$dnd2","onDragEnd","_this$dnd$onDragEnd","_this$dnd3","List","onDidChangeFocus","eventBufferer","wrapEvent","toListEvent","onDidChangeSelection","domId","onDidScroll","mouseController","onMouseOver","onMouseOut","didJustPressContextMenuKey","fromKeyDown","fromKeyUp","_ref","fromMouse","_","_ref2","onDidFocus","signal","onDidBlur","user","virtualDelegate","_this$_options$access","_options","_ariaLabel","_onDidDispose","onDidDispose","role","getWidgetRole","baseRenderers","_this$accessibilityPr","_this$accessibilityPr2","onDidChangeActiveDescendant","viewOptions","createListView","styleController","spliceable","keyboardController","_options$keyboardNavi","keyboardNavigationDelegate","typeNavigationController","createMouseController","_onFocusChange","_onSelectionChange","getWidgetAriaLabel","_this$typeNavigationC","_this$keyboardControl","bufferEvents","rerender","indexAt","position","contentHeight","onDidChangeContentHeight","scrollTop","getScrollTop","setScrollTop","scrollHeight","renderHeight","firstVisibleIndex","preventScroll","layout","width","getAnchorElement","n","loop","findNextIndex","findPreviousIndex","lastPageIndex","currentlyFocusedElementIndex","lastGoodPageIndex","previousScrollTop","nextpageScrollTop","elementHeight","getPaddingTop","firstPageIndex","paddingTop","indexAfter","firstGoodPageIndex","focusLast","focusFirst","focusNth","getFocusedElements","relativeTop","elementTop","m","viewItemBottom","scrollBottom","getRelativeTop","abs","getScrollableElement","scrollableElementDomNode","getElementID","getElementDomId","getElementTop","_ref3","_this$accessibilityPr3","id","getActiveDescendantId"],"sources":["D:/ospanel/domains/react/react-intro-main/node_modules/monaco-editor/esm/vs/base/browser/ui/list/listWidget.js"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nimport { asCssValueWithDefault, createStyleSheet, EventHelper, getActiveElement, getWindow, isHTMLElement, isMouseEvent } from '../../dom.js';\nimport { DomEmitter } from '../../event.js';\nimport { StandardKeyboardEvent } from '../../keyboardEvent.js';\nimport { Gesture } from '../../touch.js';\nimport { alert } from '../aria/aria.js';\nimport { CombinedSpliceable } from './splice.js';\nimport { binarySearch, firstOrDefault, range } from '../../../common/arrays.js';\nimport { timeout } from '../../../common/async.js';\nimport { Color } from '../../../common/color.js';\nimport { memoize } from '../../../common/decorators.js';\nimport { Emitter, Event, EventBufferer } from '../../../common/event.js';\nimport { matchesFuzzy2, matchesPrefix } from '../../../common/filters.js';\nimport { DisposableStore, dispose } from '../../../common/lifecycle.js';\nimport { clamp } from '../../../common/numbers.js';\nimport * as platform from '../../../common/platform.js';\nimport { isNumber } from '../../../common/types.js';\nimport './list.css';\nimport { ListError } from './list.js';\nimport { ListView } from './listView.js';\nimport { StandardMouseEvent } from '../../mouseEvent.js';\nimport { autorun, constObservable } from '../../../common/observable.js';\nclass TraitRenderer {\n    constructor(trait) {\n        this.trait = trait;\n        this.renderedElements = [];\n    }\n    get templateId() {\n        return `template:${this.trait.name}`;\n    }\n    renderTemplate(container) {\n        return container;\n    }\n    renderElement(element, index, templateData) {\n        const renderedElementIndex = this.renderedElements.findIndex(el => el.templateData === templateData);\n        if (renderedElementIndex >= 0) {\n            const rendered = this.renderedElements[renderedElementIndex];\n            this.trait.unrender(templateData);\n            rendered.index = index;\n        }\n        else {\n            const rendered = { index, templateData };\n            this.renderedElements.push(rendered);\n        }\n        this.trait.renderIndex(index, templateData);\n    }\n    splice(start, deleteCount, insertCount) {\n        const rendered = [];\n        for (const renderedElement of this.renderedElements) {\n            if (renderedElement.index < start) {\n                rendered.push(renderedElement);\n            }\n            else if (renderedElement.index >= start + deleteCount) {\n                rendered.push({\n                    index: renderedElement.index + insertCount - deleteCount,\n                    templateData: renderedElement.templateData\n                });\n            }\n        }\n        this.renderedElements = rendered;\n    }\n    renderIndexes(indexes) {\n        for (const { index, templateData } of this.renderedElements) {\n            if (indexes.indexOf(index) > -1) {\n                this.trait.renderIndex(index, templateData);\n            }\n        }\n    }\n    disposeTemplate(templateData) {\n        const index = this.renderedElements.findIndex(el => el.templateData === templateData);\n        if (index < 0) {\n            return;\n        }\n        this.renderedElements.splice(index, 1);\n    }\n}\nclass Trait {\n    get name() { return this._trait; }\n    get renderer() {\n        return new TraitRenderer(this);\n    }\n    constructor(_trait) {\n        this._trait = _trait;\n        this.indexes = [];\n        this.sortedIndexes = [];\n        this._onChange = new Emitter();\n        this.onChange = this._onChange.event;\n    }\n    splice(start, deleteCount, elements) {\n        const diff = elements.length - deleteCount;\n        const end = start + deleteCount;\n        const sortedIndexes = [];\n        let i = 0;\n        while (i < this.sortedIndexes.length && this.sortedIndexes[i] < start) {\n            sortedIndexes.push(this.sortedIndexes[i++]);\n        }\n        for (let j = 0; j < elements.length; j++) {\n            if (elements[j]) {\n                sortedIndexes.push(j + start);\n            }\n        }\n        while (i < this.sortedIndexes.length && this.sortedIndexes[i] >= end) {\n            sortedIndexes.push(this.sortedIndexes[i++] + diff);\n        }\n        this.renderer.splice(start, deleteCount, elements.length);\n        this._set(sortedIndexes, sortedIndexes);\n    }\n    renderIndex(index, container) {\n        container.classList.toggle(this._trait, this.contains(index));\n    }\n    unrender(container) {\n        container.classList.remove(this._trait);\n    }\n    /**\n     * Sets the indexes which should have this trait.\n     *\n     * @param indexes Indexes which should have this trait.\n     * @return The old indexes which had this trait.\n     */\n    set(indexes, browserEvent) {\n        return this._set(indexes, [...indexes].sort(numericSort), browserEvent);\n    }\n    _set(indexes, sortedIndexes, browserEvent) {\n        const result = this.indexes;\n        const sortedResult = this.sortedIndexes;\n        this.indexes = indexes;\n        this.sortedIndexes = sortedIndexes;\n        const toRender = disjunction(sortedResult, indexes);\n        this.renderer.renderIndexes(toRender);\n        this._onChange.fire({ indexes, browserEvent });\n        return result;\n    }\n    get() {\n        return this.indexes;\n    }\n    contains(index) {\n        return binarySearch(this.sortedIndexes, index, numericSort) >= 0;\n    }\n    dispose() {\n        dispose(this._onChange);\n    }\n}\n__decorate([\n    memoize\n], Trait.prototype, \"renderer\", null);\nclass SelectionTrait extends Trait {\n    constructor(setAriaSelected) {\n        super('selected');\n        this.setAriaSelected = setAriaSelected;\n    }\n    renderIndex(index, container) {\n        super.renderIndex(index, container);\n        if (this.setAriaSelected) {\n            if (this.contains(index)) {\n                container.setAttribute('aria-selected', 'true');\n            }\n            else {\n                container.setAttribute('aria-selected', 'false');\n            }\n        }\n    }\n}\n/**\n * The TraitSpliceable is used as a util class to be able\n * to preserve traits across splice calls, given an identity\n * provider.\n */\nclass TraitSpliceable {\n    constructor(trait, view, identityProvider) {\n        this.trait = trait;\n        this.view = view;\n        this.identityProvider = identityProvider;\n    }\n    splice(start, deleteCount, elements) {\n        if (!this.identityProvider) {\n            return this.trait.splice(start, deleteCount, new Array(elements.length).fill(false));\n        }\n        const pastElementsWithTrait = this.trait.get().map(i => this.identityProvider.getId(this.view.element(i)).toString());\n        if (pastElementsWithTrait.length === 0) {\n            return this.trait.splice(start, deleteCount, new Array(elements.length).fill(false));\n        }\n        const pastElementsWithTraitSet = new Set(pastElementsWithTrait);\n        const elementsWithTrait = elements.map(e => pastElementsWithTraitSet.has(this.identityProvider.getId(e).toString()));\n        this.trait.splice(start, deleteCount, elementsWithTrait);\n    }\n}\nexport function isInputElement(e) {\n    return e.tagName === 'INPUT' || e.tagName === 'TEXTAREA';\n}\nfunction isListElementDescendantOfClass(e, className) {\n    if (e.classList.contains(className)) {\n        return true;\n    }\n    if (e.classList.contains('monaco-list')) {\n        return false;\n    }\n    if (!e.parentElement) {\n        return false;\n    }\n    return isListElementDescendantOfClass(e.parentElement, className);\n}\nexport function isMonacoEditor(e) {\n    return isListElementDescendantOfClass(e, 'monaco-editor');\n}\nexport function isMonacoCustomToggle(e) {\n    return isListElementDescendantOfClass(e, 'monaco-custom-toggle');\n}\nexport function isActionItem(e) {\n    return isListElementDescendantOfClass(e, 'action-item');\n}\nexport function isStickyScrollElement(e) {\n    return isListElementDescendantOfClass(e, 'monaco-tree-sticky-row');\n}\nexport function isStickyScrollContainer(e) {\n    return e.classList.contains('monaco-tree-sticky-container');\n}\nexport function isButton(e) {\n    if ((e.tagName === 'A' && e.classList.contains('monaco-button')) ||\n        (e.tagName === 'DIV' && e.classList.contains('monaco-button-dropdown'))) {\n        return true;\n    }\n    if (e.classList.contains('monaco-list')) {\n        return false;\n    }\n    if (!e.parentElement) {\n        return false;\n    }\n    return isButton(e.parentElement);\n}\nclass KeyboardController {\n    get onKeyDown() {\n        return Event.chain(this.disposables.add(new DomEmitter(this.view.domNode, 'keydown')).event, $ => $.filter(e => !isInputElement(e.target))\n            .map(e => new StandardKeyboardEvent(e)));\n    }\n    constructor(list, view, options) {\n        this.list = list;\n        this.view = view;\n        this.disposables = new DisposableStore();\n        this.multipleSelectionDisposables = new DisposableStore();\n        this.multipleSelectionSupport = options.multipleSelectionSupport;\n        this.disposables.add(this.onKeyDown(e => {\n            switch (e.keyCode) {\n                case 3 /* KeyCode.Enter */:\n                    return this.onEnter(e);\n                case 16 /* KeyCode.UpArrow */:\n                    return this.onUpArrow(e);\n                case 18 /* KeyCode.DownArrow */:\n                    return this.onDownArrow(e);\n                case 11 /* KeyCode.PageUp */:\n                    return this.onPageUpArrow(e);\n                case 12 /* KeyCode.PageDown */:\n                    return this.onPageDownArrow(e);\n                case 9 /* KeyCode.Escape */:\n                    return this.onEscape(e);\n                case 31 /* KeyCode.KeyA */:\n                    if (this.multipleSelectionSupport && (platform.isMacintosh ? e.metaKey : e.ctrlKey)) {\n                        this.onCtrlA(e);\n                    }\n            }\n        }));\n    }\n    updateOptions(optionsUpdate) {\n        if (optionsUpdate.multipleSelectionSupport !== undefined) {\n            this.multipleSelectionSupport = optionsUpdate.multipleSelectionSupport;\n        }\n    }\n    onEnter(e) {\n        e.preventDefault();\n        e.stopPropagation();\n        this.list.setSelection(this.list.getFocus(), e.browserEvent);\n    }\n    onUpArrow(e) {\n        e.preventDefault();\n        e.stopPropagation();\n        this.list.focusPrevious(1, false, e.browserEvent);\n        const el = this.list.getFocus()[0];\n        this.list.setAnchor(el);\n        this.list.reveal(el);\n        this.view.domNode.focus();\n    }\n    onDownArrow(e) {\n        e.preventDefault();\n        e.stopPropagation();\n        this.list.focusNext(1, false, e.browserEvent);\n        const el = this.list.getFocus()[0];\n        this.list.setAnchor(el);\n        this.list.reveal(el);\n        this.view.domNode.focus();\n    }\n    onPageUpArrow(e) {\n        e.preventDefault();\n        e.stopPropagation();\n        this.list.focusPreviousPage(e.browserEvent);\n        const el = this.list.getFocus()[0];\n        this.list.setAnchor(el);\n        this.list.reveal(el);\n        this.view.domNode.focus();\n    }\n    onPageDownArrow(e) {\n        e.preventDefault();\n        e.stopPropagation();\n        this.list.focusNextPage(e.browserEvent);\n        const el = this.list.getFocus()[0];\n        this.list.setAnchor(el);\n        this.list.reveal(el);\n        this.view.domNode.focus();\n    }\n    onCtrlA(e) {\n        e.preventDefault();\n        e.stopPropagation();\n        this.list.setSelection(range(this.list.length), e.browserEvent);\n        this.list.setAnchor(undefined);\n        this.view.domNode.focus();\n    }\n    onEscape(e) {\n        if (this.list.getSelection().length) {\n            e.preventDefault();\n            e.stopPropagation();\n            this.list.setSelection([], e.browserEvent);\n            this.list.setAnchor(undefined);\n            this.view.domNode.focus();\n        }\n    }\n    dispose() {\n        this.disposables.dispose();\n        this.multipleSelectionDisposables.dispose();\n    }\n}\n__decorate([\n    memoize\n], KeyboardController.prototype, \"onKeyDown\", null);\nexport var TypeNavigationMode;\n(function (TypeNavigationMode) {\n    TypeNavigationMode[TypeNavigationMode[\"Automatic\"] = 0] = \"Automatic\";\n    TypeNavigationMode[TypeNavigationMode[\"Trigger\"] = 1] = \"Trigger\";\n})(TypeNavigationMode || (TypeNavigationMode = {}));\nvar TypeNavigationControllerState;\n(function (TypeNavigationControllerState) {\n    TypeNavigationControllerState[TypeNavigationControllerState[\"Idle\"] = 0] = \"Idle\";\n    TypeNavigationControllerState[TypeNavigationControllerState[\"Typing\"] = 1] = \"Typing\";\n})(TypeNavigationControllerState || (TypeNavigationControllerState = {}));\nexport const DefaultKeyboardNavigationDelegate = new class {\n    mightProducePrintableCharacter(event) {\n        if (event.ctrlKey || event.metaKey || event.altKey) {\n            return false;\n        }\n        return (event.keyCode >= 31 /* KeyCode.KeyA */ && event.keyCode <= 56 /* KeyCode.KeyZ */)\n            || (event.keyCode >= 21 /* KeyCode.Digit0 */ && event.keyCode <= 30 /* KeyCode.Digit9 */)\n            || (event.keyCode >= 98 /* KeyCode.Numpad0 */ && event.keyCode <= 107 /* KeyCode.Numpad9 */)\n            || (event.keyCode >= 85 /* KeyCode.Semicolon */ && event.keyCode <= 95 /* KeyCode.Quote */);\n    }\n};\nclass TypeNavigationController {\n    constructor(list, view, keyboardNavigationLabelProvider, keyboardNavigationEventFilter, delegate) {\n        this.list = list;\n        this.view = view;\n        this.keyboardNavigationLabelProvider = keyboardNavigationLabelProvider;\n        this.keyboardNavigationEventFilter = keyboardNavigationEventFilter;\n        this.delegate = delegate;\n        this.enabled = false;\n        this.state = TypeNavigationControllerState.Idle;\n        this.mode = TypeNavigationMode.Automatic;\n        this.triggered = false;\n        this.previouslyFocused = -1;\n        this.enabledDisposables = new DisposableStore();\n        this.disposables = new DisposableStore();\n        this.updateOptions(list.options);\n    }\n    updateOptions(options) {\n        if (options.typeNavigationEnabled ?? true) {\n            this.enable();\n        }\n        else {\n            this.disable();\n        }\n        this.mode = options.typeNavigationMode ?? TypeNavigationMode.Automatic;\n    }\n    enable() {\n        if (this.enabled) {\n            return;\n        }\n        let typing = false;\n        const onChar = Event.chain(this.enabledDisposables.add(new DomEmitter(this.view.domNode, 'keydown')).event, $ => $.filter(e => !isInputElement(e.target))\n            .filter(() => this.mode === TypeNavigationMode.Automatic || this.triggered)\n            .map(event => new StandardKeyboardEvent(event))\n            .filter(e => typing || this.keyboardNavigationEventFilter(e))\n            .filter(e => this.delegate.mightProducePrintableCharacter(e))\n            .forEach(e => EventHelper.stop(e, true))\n            .map(event => event.browserEvent.key));\n        const onClear = Event.debounce(onChar, () => null, 800, undefined, undefined, undefined, this.enabledDisposables);\n        const onInput = Event.reduce(Event.any(onChar, onClear), (r, i) => i === null ? null : ((r || '') + i), undefined, this.enabledDisposables);\n        onInput(this.onInput, this, this.enabledDisposables);\n        onClear(this.onClear, this, this.enabledDisposables);\n        onChar(() => typing = true, undefined, this.enabledDisposables);\n        onClear(() => typing = false, undefined, this.enabledDisposables);\n        this.enabled = true;\n        this.triggered = false;\n    }\n    disable() {\n        if (!this.enabled) {\n            return;\n        }\n        this.enabledDisposables.clear();\n        this.enabled = false;\n        this.triggered = false;\n    }\n    onClear() {\n        const focus = this.list.getFocus();\n        if (focus.length > 0 && focus[0] === this.previouslyFocused) {\n            // List: re-announce element on typing end since typed keys will interrupt aria label of focused element\n            // Do not announce if there was a focus change at the end to prevent duplication https://github.com/microsoft/vscode/issues/95961\n            const ariaLabel = this.list.options.accessibilityProvider?.getAriaLabel(this.list.element(focus[0]));\n            if (typeof ariaLabel === 'string') {\n                alert(ariaLabel);\n            }\n            else if (ariaLabel) {\n                alert(ariaLabel.get());\n            }\n        }\n        this.previouslyFocused = -1;\n    }\n    onInput(word) {\n        if (!word) {\n            this.state = TypeNavigationControllerState.Idle;\n            this.triggered = false;\n            return;\n        }\n        const focus = this.list.getFocus();\n        const start = focus.length > 0 ? focus[0] : 0;\n        const delta = this.state === TypeNavigationControllerState.Idle ? 1 : 0;\n        this.state = TypeNavigationControllerState.Typing;\n        for (let i = 0; i < this.list.length; i++) {\n            const index = (start + i + delta) % this.list.length;\n            const label = this.keyboardNavigationLabelProvider.getKeyboardNavigationLabel(this.view.element(index));\n            const labelStr = label && label.toString();\n            if (this.list.options.typeNavigationEnabled) {\n                if (typeof labelStr !== 'undefined') {\n                    // If prefix is found, focus and return early\n                    if (matchesPrefix(word, labelStr)) {\n                        this.previouslyFocused = start;\n                        this.list.setFocus([index]);\n                        this.list.reveal(index);\n                        return;\n                    }\n                    const fuzzy = matchesFuzzy2(word, labelStr);\n                    if (fuzzy) {\n                        const fuzzyScore = fuzzy[0].end - fuzzy[0].start;\n                        // ensures that when fuzzy matching, doesn't clash with prefix matching (1 input vs 1+ should be prefix and fuzzy respecitvely). Also makes sure that exact matches are prioritized.\n                        if (fuzzyScore > 1 && fuzzy.length === 1) {\n                            this.previouslyFocused = start;\n                            this.list.setFocus([index]);\n                            this.list.reveal(index);\n                            return;\n                        }\n                    }\n                }\n            }\n            else if (typeof labelStr === 'undefined' || matchesPrefix(word, labelStr)) {\n                this.previouslyFocused = start;\n                this.list.setFocus([index]);\n                this.list.reveal(index);\n                return;\n            }\n        }\n    }\n    dispose() {\n        this.disable();\n        this.enabledDisposables.dispose();\n        this.disposables.dispose();\n    }\n}\nclass DOMFocusController {\n    constructor(list, view) {\n        this.list = list;\n        this.view = view;\n        this.disposables = new DisposableStore();\n        const onKeyDown = Event.chain(this.disposables.add(new DomEmitter(view.domNode, 'keydown')).event, $ => $\n            .filter(e => !isInputElement(e.target))\n            .map(e => new StandardKeyboardEvent(e)));\n        const onTab = Event.chain(onKeyDown, $ => $.filter(e => e.keyCode === 2 /* KeyCode.Tab */ && !e.ctrlKey && !e.metaKey && !e.shiftKey && !e.altKey));\n        onTab(this.onTab, this, this.disposables);\n    }\n    onTab(e) {\n        if (e.target !== this.view.domNode) {\n            return;\n        }\n        const focus = this.list.getFocus();\n        if (focus.length === 0) {\n            return;\n        }\n        const focusedDomElement = this.view.domElement(focus[0]);\n        if (!focusedDomElement) {\n            return;\n        }\n        const tabIndexElement = focusedDomElement.querySelector('[tabIndex]');\n        if (!tabIndexElement || !(isHTMLElement(tabIndexElement)) || tabIndexElement.tabIndex === -1) {\n            return;\n        }\n        const style = getWindow(tabIndexElement).getComputedStyle(tabIndexElement);\n        if (style.visibility === 'hidden' || style.display === 'none') {\n            return;\n        }\n        e.preventDefault();\n        e.stopPropagation();\n        tabIndexElement.focus();\n    }\n    dispose() {\n        this.disposables.dispose();\n    }\n}\nexport function isSelectionSingleChangeEvent(event) {\n    return platform.isMacintosh ? event.browserEvent.metaKey : event.browserEvent.ctrlKey;\n}\nexport function isSelectionRangeChangeEvent(event) {\n    return event.browserEvent.shiftKey;\n}\nfunction isMouseRightClick(event) {\n    return isMouseEvent(event) && event.button === 2;\n}\nconst DefaultMultipleSelectionController = {\n    isSelectionSingleChangeEvent,\n    isSelectionRangeChangeEvent\n};\nexport class MouseController {\n    constructor(list) {\n        this.list = list;\n        this.disposables = new DisposableStore();\n        this._onPointer = new Emitter();\n        this.onPointer = this._onPointer.event;\n        if (list.options.multipleSelectionSupport !== false) {\n            this.multipleSelectionController = this.list.options.multipleSelectionController || DefaultMultipleSelectionController;\n        }\n        this.mouseSupport = typeof list.options.mouseSupport === 'undefined' || !!list.options.mouseSupport;\n        if (this.mouseSupport) {\n            list.onMouseDown(this.onMouseDown, this, this.disposables);\n            list.onContextMenu(this.onContextMenu, this, this.disposables);\n            list.onMouseDblClick(this.onDoubleClick, this, this.disposables);\n            list.onTouchStart(this.onMouseDown, this, this.disposables);\n            this.disposables.add(Gesture.addTarget(list.getHTMLElement()));\n        }\n        Event.any(list.onMouseClick, list.onMouseMiddleClick, list.onTap)(this.onViewPointer, this, this.disposables);\n    }\n    updateOptions(optionsUpdate) {\n        if (optionsUpdate.multipleSelectionSupport !== undefined) {\n            this.multipleSelectionController = undefined;\n            if (optionsUpdate.multipleSelectionSupport) {\n                this.multipleSelectionController = this.list.options.multipleSelectionController || DefaultMultipleSelectionController;\n            }\n        }\n    }\n    isSelectionSingleChangeEvent(event) {\n        if (!this.multipleSelectionController) {\n            return false;\n        }\n        return this.multipleSelectionController.isSelectionSingleChangeEvent(event);\n    }\n    isSelectionRangeChangeEvent(event) {\n        if (!this.multipleSelectionController) {\n            return false;\n        }\n        return this.multipleSelectionController.isSelectionRangeChangeEvent(event);\n    }\n    isSelectionChangeEvent(event) {\n        return this.isSelectionSingleChangeEvent(event) || this.isSelectionRangeChangeEvent(event);\n    }\n    onMouseDown(e) {\n        if (isMonacoEditor(e.browserEvent.target)) {\n            return;\n        }\n        if (getActiveElement() !== e.browserEvent.target) {\n            this.list.domFocus();\n        }\n    }\n    onContextMenu(e) {\n        if (isInputElement(e.browserEvent.target) || isMonacoEditor(e.browserEvent.target)) {\n            return;\n        }\n        const focus = typeof e.index === 'undefined' ? [] : [e.index];\n        this.list.setFocus(focus, e.browserEvent);\n    }\n    onViewPointer(e) {\n        if (!this.mouseSupport) {\n            return;\n        }\n        if (isInputElement(e.browserEvent.target) || isMonacoEditor(e.browserEvent.target)) {\n            return;\n        }\n        if (e.browserEvent.isHandledByList) {\n            return;\n        }\n        e.browserEvent.isHandledByList = true;\n        const focus = e.index;\n        if (typeof focus === 'undefined') {\n            this.list.setFocus([], e.browserEvent);\n            this.list.setSelection([], e.browserEvent);\n            this.list.setAnchor(undefined);\n            return;\n        }\n        if (this.isSelectionChangeEvent(e)) {\n            return this.changeSelection(e);\n        }\n        this.list.setFocus([focus], e.browserEvent);\n        this.list.setAnchor(focus);\n        if (!isMouseRightClick(e.browserEvent)) {\n            this.list.setSelection([focus], e.browserEvent);\n        }\n        this._onPointer.fire(e);\n    }\n    onDoubleClick(e) {\n        if (isInputElement(e.browserEvent.target) || isMonacoEditor(e.browserEvent.target)) {\n            return;\n        }\n        if (this.isSelectionChangeEvent(e)) {\n            return;\n        }\n        if (e.browserEvent.isHandledByList) {\n            return;\n        }\n        e.browserEvent.isHandledByList = true;\n        const focus = this.list.getFocus();\n        this.list.setSelection(focus, e.browserEvent);\n    }\n    changeSelection(e) {\n        const focus = e.index;\n        let anchor = this.list.getAnchor();\n        if (this.isSelectionRangeChangeEvent(e)) {\n            if (typeof anchor === 'undefined') {\n                const currentFocus = this.list.getFocus()[0];\n                anchor = currentFocus ?? focus;\n                this.list.setAnchor(anchor);\n            }\n            const min = Math.min(anchor, focus);\n            const max = Math.max(anchor, focus);\n            const rangeSelection = range(min, max + 1);\n            const selection = this.list.getSelection();\n            const contiguousRange = getContiguousRangeContaining(disjunction(selection, [anchor]), anchor);\n            if (contiguousRange.length === 0) {\n                return;\n            }\n            const newSelection = disjunction(rangeSelection, relativeComplement(selection, contiguousRange));\n            this.list.setSelection(newSelection, e.browserEvent);\n            this.list.setFocus([focus], e.browserEvent);\n        }\n        else if (this.isSelectionSingleChangeEvent(e)) {\n            const selection = this.list.getSelection();\n            const newSelection = selection.filter(i => i !== focus);\n            this.list.setFocus([focus]);\n            this.list.setAnchor(focus);\n            if (selection.length === newSelection.length) {\n                this.list.setSelection([...newSelection, focus], e.browserEvent);\n            }\n            else {\n                this.list.setSelection(newSelection, e.browserEvent);\n            }\n        }\n    }\n    dispose() {\n        this.disposables.dispose();\n    }\n}\nexport class DefaultStyleController {\n    constructor(styleElement, selectorSuffix) {\n        this.styleElement = styleElement;\n        this.selectorSuffix = selectorSuffix;\n    }\n    style(styles) {\n        const suffix = this.selectorSuffix && `.${this.selectorSuffix}`;\n        const content = [];\n        if (styles.listBackground) {\n            content.push(`.monaco-list${suffix} .monaco-list-rows { background: ${styles.listBackground}; }`);\n        }\n        if (styles.listFocusBackground) {\n            content.push(`.monaco-list${suffix}:focus .monaco-list-row.focused { background-color: ${styles.listFocusBackground}; }`);\n            content.push(`.monaco-list${suffix}:focus .monaco-list-row.focused:hover { background-color: ${styles.listFocusBackground}; }`); // overwrite :hover style in this case!\n        }\n        if (styles.listFocusForeground) {\n            content.push(`.monaco-list${suffix}:focus .monaco-list-row.focused { color: ${styles.listFocusForeground}; }`);\n        }\n        if (styles.listActiveSelectionBackground) {\n            content.push(`.monaco-list${suffix}:focus .monaco-list-row.selected { background-color: ${styles.listActiveSelectionBackground}; }`);\n            content.push(`.monaco-list${suffix}:focus .monaco-list-row.selected:hover { background-color: ${styles.listActiveSelectionBackground}; }`); // overwrite :hover style in this case!\n        }\n        if (styles.listActiveSelectionForeground) {\n            content.push(`.monaco-list${suffix}:focus .monaco-list-row.selected { color: ${styles.listActiveSelectionForeground}; }`);\n        }\n        if (styles.listActiveSelectionIconForeground) {\n            content.push(`.monaco-list${suffix}:focus .monaco-list-row.selected .codicon { color: ${styles.listActiveSelectionIconForeground}; }`);\n        }\n        if (styles.listFocusAndSelectionBackground) {\n            content.push(`\n\t\t\t\t.monaco-drag-image,\n\t\t\t\t.monaco-list${suffix}:focus .monaco-list-row.selected.focused { background-color: ${styles.listFocusAndSelectionBackground}; }\n\t\t\t`);\n        }\n        if (styles.listFocusAndSelectionForeground) {\n            content.push(`\n\t\t\t\t.monaco-drag-image,\n\t\t\t\t.monaco-list${suffix}:focus .monaco-list-row.selected.focused { color: ${styles.listFocusAndSelectionForeground}; }\n\t\t\t`);\n        }\n        if (styles.listInactiveFocusForeground) {\n            content.push(`.monaco-list${suffix} .monaco-list-row.focused { color:  ${styles.listInactiveFocusForeground}; }`);\n            content.push(`.monaco-list${suffix} .monaco-list-row.focused:hover { color:  ${styles.listInactiveFocusForeground}; }`); // overwrite :hover style in this case!\n        }\n        if (styles.listInactiveSelectionIconForeground) {\n            content.push(`.monaco-list${suffix} .monaco-list-row.focused .codicon { color:  ${styles.listInactiveSelectionIconForeground}; }`);\n        }\n        if (styles.listInactiveFocusBackground) {\n            content.push(`.monaco-list${suffix} .monaco-list-row.focused { background-color:  ${styles.listInactiveFocusBackground}; }`);\n            content.push(`.monaco-list${suffix} .monaco-list-row.focused:hover { background-color:  ${styles.listInactiveFocusBackground}; }`); // overwrite :hover style in this case!\n        }\n        if (styles.listInactiveSelectionBackground) {\n            content.push(`.monaco-list${suffix} .monaco-list-row.selected { background-color:  ${styles.listInactiveSelectionBackground}; }`);\n            content.push(`.monaco-list${suffix} .monaco-list-row.selected:hover { background-color:  ${styles.listInactiveSelectionBackground}; }`); // overwrite :hover style in this case!\n        }\n        if (styles.listInactiveSelectionForeground) {\n            content.push(`.monaco-list${suffix} .monaco-list-row.selected { color: ${styles.listInactiveSelectionForeground}; }`);\n        }\n        if (styles.listHoverBackground) {\n            content.push(`.monaco-list${suffix}:not(.drop-target):not(.dragging) .monaco-list-row:hover:not(.selected):not(.focused) { background-color: ${styles.listHoverBackground}; }`);\n        }\n        if (styles.listHoverForeground) {\n            content.push(`.monaco-list${suffix}:not(.drop-target):not(.dragging) .monaco-list-row:hover:not(.selected):not(.focused) { color:  ${styles.listHoverForeground}; }`);\n        }\n        /**\n         * Outlines\n         */\n        const focusAndSelectionOutline = asCssValueWithDefault(styles.listFocusAndSelectionOutline, asCssValueWithDefault(styles.listSelectionOutline, styles.listFocusOutline ?? ''));\n        if (focusAndSelectionOutline) { // default: listFocusOutline\n            content.push(`.monaco-list${suffix}:focus .monaco-list-row.focused.selected { outline: 1px solid ${focusAndSelectionOutline}; outline-offset: -1px;}`);\n        }\n        if (styles.listFocusOutline) { // default: set\n            content.push(`\n\t\t\t\t.monaco-drag-image,\n\t\t\t\t.monaco-list${suffix}:focus .monaco-list-row.focused { outline: 1px solid ${styles.listFocusOutline}; outline-offset: -1px; }\n\t\t\t\t.monaco-workbench.context-menu-visible .monaco-list${suffix}.last-focused .monaco-list-row.focused { outline: 1px solid ${styles.listFocusOutline}; outline-offset: -1px; }\n\t\t\t`);\n        }\n        const inactiveFocusAndSelectionOutline = asCssValueWithDefault(styles.listSelectionOutline, styles.listInactiveFocusOutline ?? '');\n        if (inactiveFocusAndSelectionOutline) {\n            content.push(`.monaco-list${suffix} .monaco-list-row.focused.selected { outline: 1px dotted ${inactiveFocusAndSelectionOutline}; outline-offset: -1px; }`);\n        }\n        if (styles.listSelectionOutline) { // default: activeContrastBorder\n            content.push(`.monaco-list${suffix} .monaco-list-row.selected { outline: 1px dotted ${styles.listSelectionOutline}; outline-offset: -1px; }`);\n        }\n        if (styles.listInactiveFocusOutline) { // default: null\n            content.push(`.monaco-list${suffix} .monaco-list-row.focused { outline: 1px dotted ${styles.listInactiveFocusOutline}; outline-offset: -1px; }`);\n        }\n        if (styles.listHoverOutline) { // default: activeContrastBorder\n            content.push(`.monaco-list${suffix} .monaco-list-row:hover { outline: 1px dashed ${styles.listHoverOutline}; outline-offset: -1px; }`);\n        }\n        if (styles.listDropOverBackground) {\n            content.push(`\n\t\t\t\t.monaco-list${suffix}.drop-target,\n\t\t\t\t.monaco-list${suffix} .monaco-list-rows.drop-target,\n\t\t\t\t.monaco-list${suffix} .monaco-list-row.drop-target { background-color: ${styles.listDropOverBackground} !important; color: inherit !important; }\n\t\t\t`);\n        }\n        if (styles.listDropBetweenBackground) {\n            content.push(`\n\t\t\t.monaco-list${suffix} .monaco-list-rows.drop-target-before .monaco-list-row:first-child::before,\n\t\t\t.monaco-list${suffix} .monaco-list-row.drop-target-before::before {\n\t\t\t\tcontent: \"\"; position: absolute; top: 0px; left: 0px; width: 100%; height: 1px;\n\t\t\t\tbackground-color: ${styles.listDropBetweenBackground};\n\t\t\t}`);\n            content.push(`\n\t\t\t.monaco-list${suffix} .monaco-list-rows.drop-target-after .monaco-list-row:last-child::after,\n\t\t\t.monaco-list${suffix} .monaco-list-row.drop-target-after::after {\n\t\t\t\tcontent: \"\"; position: absolute; bottom: 0px; left: 0px; width: 100%; height: 1px;\n\t\t\t\tbackground-color: ${styles.listDropBetweenBackground};\n\t\t\t}`);\n        }\n        if (styles.tableColumnsBorder) {\n            content.push(`\n\t\t\t\t.monaco-table > .monaco-split-view2,\n\t\t\t\t.monaco-table > .monaco-split-view2 .monaco-sash.vertical::before,\n\t\t\t\t.monaco-workbench:not(.reduce-motion) .monaco-table:hover > .monaco-split-view2,\n\t\t\t\t.monaco-workbench:not(.reduce-motion) .monaco-table:hover > .monaco-split-view2 .monaco-sash.vertical::before {\n\t\t\t\t\tborder-color: ${styles.tableColumnsBorder};\n\t\t\t\t}\n\n\t\t\t\t.monaco-workbench:not(.reduce-motion) .monaco-table > .monaco-split-view2,\n\t\t\t\t.monaco-workbench:not(.reduce-motion) .monaco-table > .monaco-split-view2 .monaco-sash.vertical::before {\n\t\t\t\t\tborder-color: transparent;\n\t\t\t\t}\n\t\t\t`);\n        }\n        if (styles.tableOddRowsBackgroundColor) {\n            content.push(`\n\t\t\t\t.monaco-table .monaco-list-row[data-parity=odd]:not(.focused):not(.selected):not(:hover) .monaco-table-tr,\n\t\t\t\t.monaco-table .monaco-list:not(:focus) .monaco-list-row[data-parity=odd].focused:not(.selected):not(:hover) .monaco-table-tr,\n\t\t\t\t.monaco-table .monaco-list:not(.focused) .monaco-list-row[data-parity=odd].focused:not(.selected):not(:hover) .monaco-table-tr {\n\t\t\t\t\tbackground-color: ${styles.tableOddRowsBackgroundColor};\n\t\t\t\t}\n\t\t\t`);\n        }\n        this.styleElement.textContent = content.join('\\n');\n    }\n}\nexport const unthemedListStyles = {\n    listFocusBackground: '#7FB0D0',\n    listActiveSelectionBackground: '#0E639C',\n    listActiveSelectionForeground: '#FFFFFF',\n    listActiveSelectionIconForeground: '#FFFFFF',\n    listFocusAndSelectionOutline: '#90C2F9',\n    listFocusAndSelectionBackground: '#094771',\n    listFocusAndSelectionForeground: '#FFFFFF',\n    listInactiveSelectionBackground: '#3F3F46',\n    listInactiveSelectionIconForeground: '#FFFFFF',\n    listHoverBackground: '#2A2D2E',\n    listDropOverBackground: '#383B3D',\n    listDropBetweenBackground: '#EEEEEE',\n    treeIndentGuidesStroke: '#a9a9a9',\n    treeInactiveIndentGuidesStroke: Color.fromHex('#a9a9a9').transparent(0.4).toString(),\n    tableColumnsBorder: Color.fromHex('#cccccc').transparent(0.2).toString(),\n    tableOddRowsBackgroundColor: Color.fromHex('#cccccc').transparent(0.04).toString(),\n    listBackground: undefined,\n    listFocusForeground: undefined,\n    listInactiveSelectionForeground: undefined,\n    listInactiveFocusForeground: undefined,\n    listInactiveFocusBackground: undefined,\n    listHoverForeground: undefined,\n    listFocusOutline: undefined,\n    listInactiveFocusOutline: undefined,\n    listSelectionOutline: undefined,\n    listHoverOutline: undefined,\n    treeStickyScrollBackground: undefined,\n    treeStickyScrollBorder: undefined,\n    treeStickyScrollShadow: undefined\n};\nconst DefaultOptions = {\n    keyboardSupport: true,\n    mouseSupport: true,\n    multipleSelectionSupport: true,\n    dnd: {\n        getDragURI() { return null; },\n        onDragStart() { },\n        onDragOver() { return false; },\n        drop() { },\n        dispose() { }\n    }\n};\n// TODO@Joao: move these utils into a SortedArray class\nfunction getContiguousRangeContaining(range, value) {\n    const index = range.indexOf(value);\n    if (index === -1) {\n        return [];\n    }\n    const result = [];\n    let i = index - 1;\n    while (i >= 0 && range[i] === value - (index - i)) {\n        result.push(range[i--]);\n    }\n    result.reverse();\n    i = index;\n    while (i < range.length && range[i] === value + (i - index)) {\n        result.push(range[i++]);\n    }\n    return result;\n}\n/**\n * Given two sorted collections of numbers, returns the intersection\n * between them (OR).\n */\nfunction disjunction(one, other) {\n    const result = [];\n    let i = 0, j = 0;\n    while (i < one.length || j < other.length) {\n        if (i >= one.length) {\n            result.push(other[j++]);\n        }\n        else if (j >= other.length) {\n            result.push(one[i++]);\n        }\n        else if (one[i] === other[j]) {\n            result.push(one[i]);\n            i++;\n            j++;\n            continue;\n        }\n        else if (one[i] < other[j]) {\n            result.push(one[i++]);\n        }\n        else {\n            result.push(other[j++]);\n        }\n    }\n    return result;\n}\n/**\n * Given two sorted collections of numbers, returns the relative\n * complement between them (XOR).\n */\nfunction relativeComplement(one, other) {\n    const result = [];\n    let i = 0, j = 0;\n    while (i < one.length || j < other.length) {\n        if (i >= one.length) {\n            result.push(other[j++]);\n        }\n        else if (j >= other.length) {\n            result.push(one[i++]);\n        }\n        else if (one[i] === other[j]) {\n            i++;\n            j++;\n            continue;\n        }\n        else if (one[i] < other[j]) {\n            result.push(one[i++]);\n        }\n        else {\n            j++;\n        }\n    }\n    return result;\n}\nconst numericSort = (a, b) => a - b;\nclass PipelineRenderer {\n    constructor(_templateId, renderers) {\n        this._templateId = _templateId;\n        this.renderers = renderers;\n    }\n    get templateId() {\n        return this._templateId;\n    }\n    renderTemplate(container) {\n        return this.renderers.map(r => r.renderTemplate(container));\n    }\n    renderElement(element, index, templateData, height) {\n        let i = 0;\n        for (const renderer of this.renderers) {\n            renderer.renderElement(element, index, templateData[i++], height);\n        }\n    }\n    disposeElement(element, index, templateData, height) {\n        let i = 0;\n        for (const renderer of this.renderers) {\n            renderer.disposeElement?.(element, index, templateData[i], height);\n            i += 1;\n        }\n    }\n    disposeTemplate(templateData) {\n        let i = 0;\n        for (const renderer of this.renderers) {\n            renderer.disposeTemplate(templateData[i++]);\n        }\n    }\n}\nclass AccessibiltyRenderer {\n    constructor(accessibilityProvider) {\n        this.accessibilityProvider = accessibilityProvider;\n        this.templateId = 'a18n';\n    }\n    renderTemplate(container) {\n        return { container, disposables: new DisposableStore() };\n    }\n    renderElement(element, index, data) {\n        const ariaLabel = this.accessibilityProvider.getAriaLabel(element);\n        const observable = (ariaLabel && typeof ariaLabel !== 'string') ? ariaLabel : constObservable(ariaLabel);\n        data.disposables.add(autorun(reader => {\n            this.setAriaLabel(reader.readObservable(observable), data.container);\n        }));\n        const ariaLevel = this.accessibilityProvider.getAriaLevel && this.accessibilityProvider.getAriaLevel(element);\n        if (typeof ariaLevel === 'number') {\n            data.container.setAttribute('aria-level', `${ariaLevel}`);\n        }\n        else {\n            data.container.removeAttribute('aria-level');\n        }\n    }\n    setAriaLabel(ariaLabel, element) {\n        if (ariaLabel) {\n            element.setAttribute('aria-label', ariaLabel);\n        }\n        else {\n            element.removeAttribute('aria-label');\n        }\n    }\n    disposeElement(element, index, templateData, height) {\n        templateData.disposables.clear();\n    }\n    disposeTemplate(templateData) {\n        templateData.disposables.dispose();\n    }\n}\nclass ListViewDragAndDrop {\n    constructor(list, dnd) {\n        this.list = list;\n        this.dnd = dnd;\n    }\n    getDragElements(element) {\n        const selection = this.list.getSelectedElements();\n        const elements = selection.indexOf(element) > -1 ? selection : [element];\n        return elements;\n    }\n    getDragURI(element) {\n        return this.dnd.getDragURI(element);\n    }\n    getDragLabel(elements, originalEvent) {\n        if (this.dnd.getDragLabel) {\n            return this.dnd.getDragLabel(elements, originalEvent);\n        }\n        return undefined;\n    }\n    onDragStart(data, originalEvent) {\n        this.dnd.onDragStart?.(data, originalEvent);\n    }\n    onDragOver(data, targetElement, targetIndex, targetSector, originalEvent) {\n        return this.dnd.onDragOver(data, targetElement, targetIndex, targetSector, originalEvent);\n    }\n    onDragLeave(data, targetElement, targetIndex, originalEvent) {\n        this.dnd.onDragLeave?.(data, targetElement, targetIndex, originalEvent);\n    }\n    onDragEnd(originalEvent) {\n        this.dnd.onDragEnd?.(originalEvent);\n    }\n    drop(data, targetElement, targetIndex, targetSector, originalEvent) {\n        this.dnd.drop(data, targetElement, targetIndex, targetSector, originalEvent);\n    }\n    dispose() {\n        this.dnd.dispose();\n    }\n}\n/**\n * The {@link List} is a virtual scrolling widget, built on top of the {@link ListView}\n * widget.\n *\n * Features:\n * - Customizable keyboard and mouse support\n * - Element traits: focus, selection, achor\n * - Accessibility support\n * - Touch support\n * - Performant template-based rendering\n * - Horizontal scrolling\n * - Variable element height support\n * - Dynamic element height support\n * - Drag-and-drop support\n */\nexport class List {\n    get onDidChangeFocus() {\n        return Event.map(this.eventBufferer.wrapEvent(this.focus.onChange), e => this.toListEvent(e), this.disposables);\n    }\n    get onDidChangeSelection() {\n        return Event.map(this.eventBufferer.wrapEvent(this.selection.onChange), e => this.toListEvent(e), this.disposables);\n    }\n    get domId() { return this.view.domId; }\n    get onDidScroll() { return this.view.onDidScroll; }\n    get onMouseClick() { return this.view.onMouseClick; }\n    get onMouseDblClick() { return this.view.onMouseDblClick; }\n    get onMouseMiddleClick() { return this.view.onMouseMiddleClick; }\n    get onPointer() { return this.mouseController.onPointer; }\n    get onMouseDown() { return this.view.onMouseDown; }\n    get onMouseOver() { return this.view.onMouseOver; }\n    get onMouseOut() { return this.view.onMouseOut; }\n    get onTouchStart() { return this.view.onTouchStart; }\n    get onTap() { return this.view.onTap; }\n    /**\n     * Possible context menu trigger events:\n     * - ContextMenu key\n     * - Shift F10\n     * - Ctrl Option Shift M (macOS with VoiceOver)\n     * - Mouse right click\n     */\n    get onContextMenu() {\n        let didJustPressContextMenuKey = false;\n        const fromKeyDown = Event.chain(this.disposables.add(new DomEmitter(this.view.domNode, 'keydown')).event, $ => $.map(e => new StandardKeyboardEvent(e))\n            .filter(e => didJustPressContextMenuKey = e.keyCode === 58 /* KeyCode.ContextMenu */ || (e.shiftKey && e.keyCode === 68 /* KeyCode.F10 */))\n            .map(e => EventHelper.stop(e, true))\n            .filter(() => false));\n        const fromKeyUp = Event.chain(this.disposables.add(new DomEmitter(this.view.domNode, 'keyup')).event, $ => $.forEach(() => didJustPressContextMenuKey = false)\n            .map(e => new StandardKeyboardEvent(e))\n            .filter(e => e.keyCode === 58 /* KeyCode.ContextMenu */ || (e.shiftKey && e.keyCode === 68 /* KeyCode.F10 */))\n            .map(e => EventHelper.stop(e, true))\n            .map(({ browserEvent }) => {\n            const focus = this.getFocus();\n            const index = focus.length ? focus[0] : undefined;\n            const element = typeof index !== 'undefined' ? this.view.element(index) : undefined;\n            const anchor = typeof index !== 'undefined' ? this.view.domElement(index) : this.view.domNode;\n            return { index, element, anchor, browserEvent };\n        }));\n        const fromMouse = Event.chain(this.view.onContextMenu, $ => $.filter(_ => !didJustPressContextMenuKey)\n            .map(({ element, index, browserEvent }) => ({ element, index, anchor: new StandardMouseEvent(getWindow(this.view.domNode), browserEvent), browserEvent })));\n        return Event.any(fromKeyDown, fromKeyUp, fromMouse);\n    }\n    get onKeyDown() { return this.disposables.add(new DomEmitter(this.view.domNode, 'keydown')).event; }\n    get onDidFocus() { return Event.signal(this.disposables.add(new DomEmitter(this.view.domNode, 'focus', true)).event); }\n    get onDidBlur() { return Event.signal(this.disposables.add(new DomEmitter(this.view.domNode, 'blur', true)).event); }\n    constructor(user, container, virtualDelegate, renderers, _options = DefaultOptions) {\n        this.user = user;\n        this._options = _options;\n        this.focus = new Trait('focused');\n        this.anchor = new Trait('anchor');\n        this.eventBufferer = new EventBufferer();\n        this._ariaLabel = '';\n        this.disposables = new DisposableStore();\n        this._onDidDispose = new Emitter();\n        this.onDidDispose = this._onDidDispose.event;\n        const role = this._options.accessibilityProvider && this._options.accessibilityProvider.getWidgetRole ? this._options.accessibilityProvider?.getWidgetRole() : 'list';\n        this.selection = new SelectionTrait(role !== 'listbox');\n        const baseRenderers = [this.focus.renderer, this.selection.renderer];\n        this.accessibilityProvider = _options.accessibilityProvider;\n        if (this.accessibilityProvider) {\n            baseRenderers.push(new AccessibiltyRenderer(this.accessibilityProvider));\n            this.accessibilityProvider.onDidChangeActiveDescendant?.(this.onDidChangeActiveDescendant, this, this.disposables);\n        }\n        renderers = renderers.map(r => new PipelineRenderer(r.templateId, [...baseRenderers, r]));\n        const viewOptions = {\n            ..._options,\n            dnd: _options.dnd && new ListViewDragAndDrop(this, _options.dnd)\n        };\n        this.view = this.createListView(container, virtualDelegate, renderers, viewOptions);\n        this.view.domNode.setAttribute('role', role);\n        if (_options.styleController) {\n            this.styleController = _options.styleController(this.view.domId);\n        }\n        else {\n            const styleElement = createStyleSheet(this.view.domNode);\n            this.styleController = new DefaultStyleController(styleElement, this.view.domId);\n        }\n        this.spliceable = new CombinedSpliceable([\n            new TraitSpliceable(this.focus, this.view, _options.identityProvider),\n            new TraitSpliceable(this.selection, this.view, _options.identityProvider),\n            new TraitSpliceable(this.anchor, this.view, _options.identityProvider),\n            this.view\n        ]);\n        this.disposables.add(this.focus);\n        this.disposables.add(this.selection);\n        this.disposables.add(this.anchor);\n        this.disposables.add(this.view);\n        this.disposables.add(this._onDidDispose);\n        this.disposables.add(new DOMFocusController(this, this.view));\n        if (typeof _options.keyboardSupport !== 'boolean' || _options.keyboardSupport) {\n            this.keyboardController = new KeyboardController(this, this.view, _options);\n            this.disposables.add(this.keyboardController);\n        }\n        if (_options.keyboardNavigationLabelProvider) {\n            const delegate = _options.keyboardNavigationDelegate || DefaultKeyboardNavigationDelegate;\n            this.typeNavigationController = new TypeNavigationController(this, this.view, _options.keyboardNavigationLabelProvider, _options.keyboardNavigationEventFilter ?? (() => true), delegate);\n            this.disposables.add(this.typeNavigationController);\n        }\n        this.mouseController = this.createMouseController(_options);\n        this.disposables.add(this.mouseController);\n        this.onDidChangeFocus(this._onFocusChange, this, this.disposables);\n        this.onDidChangeSelection(this._onSelectionChange, this, this.disposables);\n        if (this.accessibilityProvider) {\n            this.ariaLabel = this.accessibilityProvider.getWidgetAriaLabel();\n        }\n        if (this._options.multipleSelectionSupport !== false) {\n            this.view.domNode.setAttribute('aria-multiselectable', 'true');\n        }\n    }\n    createListView(container, virtualDelegate, renderers, viewOptions) {\n        return new ListView(container, virtualDelegate, renderers, viewOptions);\n    }\n    createMouseController(options) {\n        return new MouseController(this);\n    }\n    updateOptions(optionsUpdate = {}) {\n        this._options = { ...this._options, ...optionsUpdate };\n        this.typeNavigationController?.updateOptions(this._options);\n        if (this._options.multipleSelectionController !== undefined) {\n            if (this._options.multipleSelectionSupport) {\n                this.view.domNode.setAttribute('aria-multiselectable', 'true');\n            }\n            else {\n                this.view.domNode.removeAttribute('aria-multiselectable');\n            }\n        }\n        this.mouseController.updateOptions(optionsUpdate);\n        this.keyboardController?.updateOptions(optionsUpdate);\n        this.view.updateOptions(optionsUpdate);\n    }\n    get options() {\n        return this._options;\n    }\n    splice(start, deleteCount, elements = []) {\n        if (start < 0 || start > this.view.length) {\n            throw new ListError(this.user, `Invalid start index: ${start}`);\n        }\n        if (deleteCount < 0) {\n            throw new ListError(this.user, `Invalid delete count: ${deleteCount}`);\n        }\n        if (deleteCount === 0 && elements.length === 0) {\n            return;\n        }\n        this.eventBufferer.bufferEvents(() => this.spliceable.splice(start, deleteCount, elements));\n    }\n    rerender() {\n        this.view.rerender();\n    }\n    element(index) {\n        return this.view.element(index);\n    }\n    indexOf(element) {\n        return this.view.indexOf(element);\n    }\n    indexAt(position) {\n        return this.view.indexAt(position);\n    }\n    get length() {\n        return this.view.length;\n    }\n    get contentHeight() {\n        return this.view.contentHeight;\n    }\n    get onDidChangeContentHeight() {\n        return this.view.onDidChangeContentHeight;\n    }\n    get scrollTop() {\n        return this.view.getScrollTop();\n    }\n    set scrollTop(scrollTop) {\n        this.view.setScrollTop(scrollTop);\n    }\n    get scrollHeight() {\n        return this.view.scrollHeight;\n    }\n    get renderHeight() {\n        return this.view.renderHeight;\n    }\n    get firstVisibleIndex() {\n        return this.view.firstVisibleIndex;\n    }\n    get ariaLabel() {\n        return this._ariaLabel;\n    }\n    set ariaLabel(value) {\n        this._ariaLabel = value;\n        this.view.domNode.setAttribute('aria-label', value);\n    }\n    domFocus() {\n        this.view.domNode.focus({ preventScroll: true });\n    }\n    layout(height, width) {\n        this.view.layout(height, width);\n    }\n    setSelection(indexes, browserEvent) {\n        for (const index of indexes) {\n            if (index < 0 || index >= this.length) {\n                throw new ListError(this.user, `Invalid index ${index}`);\n            }\n        }\n        this.selection.set(indexes, browserEvent);\n    }\n    getSelection() {\n        return this.selection.get();\n    }\n    getSelectedElements() {\n        return this.getSelection().map(i => this.view.element(i));\n    }\n    setAnchor(index) {\n        if (typeof index === 'undefined') {\n            this.anchor.set([]);\n            return;\n        }\n        if (index < 0 || index >= this.length) {\n            throw new ListError(this.user, `Invalid index ${index}`);\n        }\n        this.anchor.set([index]);\n    }\n    getAnchor() {\n        return firstOrDefault(this.anchor.get(), undefined);\n    }\n    getAnchorElement() {\n        const anchor = this.getAnchor();\n        return typeof anchor === 'undefined' ? undefined : this.element(anchor);\n    }\n    setFocus(indexes, browserEvent) {\n        for (const index of indexes) {\n            if (index < 0 || index >= this.length) {\n                throw new ListError(this.user, `Invalid index ${index}`);\n            }\n        }\n        this.focus.set(indexes, browserEvent);\n    }\n    focusNext(n = 1, loop = false, browserEvent, filter) {\n        if (this.length === 0) {\n            return;\n        }\n        const focus = this.focus.get();\n        const index = this.findNextIndex(focus.length > 0 ? focus[0] + n : 0, loop, filter);\n        if (index > -1) {\n            this.setFocus([index], browserEvent);\n        }\n    }\n    focusPrevious(n = 1, loop = false, browserEvent, filter) {\n        if (this.length === 0) {\n            return;\n        }\n        const focus = this.focus.get();\n        const index = this.findPreviousIndex(focus.length > 0 ? focus[0] - n : 0, loop, filter);\n        if (index > -1) {\n            this.setFocus([index], browserEvent);\n        }\n    }\n    async focusNextPage(browserEvent, filter) {\n        let lastPageIndex = this.view.indexAt(this.view.getScrollTop() + this.view.renderHeight);\n        lastPageIndex = lastPageIndex === 0 ? 0 : lastPageIndex - 1;\n        const currentlyFocusedElementIndex = this.getFocus()[0];\n        if (currentlyFocusedElementIndex !== lastPageIndex && (currentlyFocusedElementIndex === undefined || lastPageIndex > currentlyFocusedElementIndex)) {\n            const lastGoodPageIndex = this.findPreviousIndex(lastPageIndex, false, filter);\n            if (lastGoodPageIndex > -1 && currentlyFocusedElementIndex !== lastGoodPageIndex) {\n                this.setFocus([lastGoodPageIndex], browserEvent);\n            }\n            else {\n                this.setFocus([lastPageIndex], browserEvent);\n            }\n        }\n        else {\n            const previousScrollTop = this.view.getScrollTop();\n            let nextpageScrollTop = previousScrollTop + this.view.renderHeight;\n            if (lastPageIndex > currentlyFocusedElementIndex) {\n                // scroll last page element to the top only if the last page element is below the focused element\n                nextpageScrollTop -= this.view.elementHeight(lastPageIndex);\n            }\n            this.view.setScrollTop(nextpageScrollTop);\n            if (this.view.getScrollTop() !== previousScrollTop) {\n                this.setFocus([]);\n                // Let the scroll event listener run\n                await timeout(0);\n                await this.focusNextPage(browserEvent, filter);\n            }\n        }\n    }\n    async focusPreviousPage(browserEvent, filter, getPaddingTop = () => 0) {\n        let firstPageIndex;\n        const paddingTop = getPaddingTop();\n        const scrollTop = this.view.getScrollTop() + paddingTop;\n        if (scrollTop === 0) {\n            firstPageIndex = this.view.indexAt(scrollTop);\n        }\n        else {\n            firstPageIndex = this.view.indexAfter(scrollTop - 1);\n        }\n        const currentlyFocusedElementIndex = this.getFocus()[0];\n        if (currentlyFocusedElementIndex !== firstPageIndex && (currentlyFocusedElementIndex === undefined || currentlyFocusedElementIndex >= firstPageIndex)) {\n            const firstGoodPageIndex = this.findNextIndex(firstPageIndex, false, filter);\n            if (firstGoodPageIndex > -1 && currentlyFocusedElementIndex !== firstGoodPageIndex) {\n                this.setFocus([firstGoodPageIndex], browserEvent);\n            }\n            else {\n                this.setFocus([firstPageIndex], browserEvent);\n            }\n        }\n        else {\n            const previousScrollTop = scrollTop;\n            this.view.setScrollTop(scrollTop - this.view.renderHeight - paddingTop);\n            if (this.view.getScrollTop() + getPaddingTop() !== previousScrollTop) {\n                this.setFocus([]);\n                // Let the scroll event listener run\n                await timeout(0);\n                await this.focusPreviousPage(browserEvent, filter, getPaddingTop);\n            }\n        }\n    }\n    focusLast(browserEvent, filter) {\n        if (this.length === 0) {\n            return;\n        }\n        const index = this.findPreviousIndex(this.length - 1, false, filter);\n        if (index > -1) {\n            this.setFocus([index], browserEvent);\n        }\n    }\n    focusFirst(browserEvent, filter) {\n        this.focusNth(0, browserEvent, filter);\n    }\n    focusNth(n, browserEvent, filter) {\n        if (this.length === 0) {\n            return;\n        }\n        const index = this.findNextIndex(n, false, filter);\n        if (index > -1) {\n            this.setFocus([index], browserEvent);\n        }\n    }\n    findNextIndex(index, loop = false, filter) {\n        for (let i = 0; i < this.length; i++) {\n            if (index >= this.length && !loop) {\n                return -1;\n            }\n            index = index % this.length;\n            if (!filter || filter(this.element(index))) {\n                return index;\n            }\n            index++;\n        }\n        return -1;\n    }\n    findPreviousIndex(index, loop = false, filter) {\n        for (let i = 0; i < this.length; i++) {\n            if (index < 0 && !loop) {\n                return -1;\n            }\n            index = (this.length + (index % this.length)) % this.length;\n            if (!filter || filter(this.element(index))) {\n                return index;\n            }\n            index--;\n        }\n        return -1;\n    }\n    getFocus() {\n        return this.focus.get();\n    }\n    getFocusedElements() {\n        return this.getFocus().map(i => this.view.element(i));\n    }\n    reveal(index, relativeTop, paddingTop = 0) {\n        if (index < 0 || index >= this.length) {\n            throw new ListError(this.user, `Invalid index ${index}`);\n        }\n        const scrollTop = this.view.getScrollTop();\n        const elementTop = this.view.elementTop(index);\n        const elementHeight = this.view.elementHeight(index);\n        if (isNumber(relativeTop)) {\n            // y = mx + b\n            const m = elementHeight - this.view.renderHeight + paddingTop;\n            this.view.setScrollTop(m * clamp(relativeTop, 0, 1) + elementTop - paddingTop);\n        }\n        else {\n            const viewItemBottom = elementTop + elementHeight;\n            const scrollBottom = scrollTop + this.view.renderHeight;\n            if (elementTop < scrollTop + paddingTop && viewItemBottom >= scrollBottom) {\n                // The element is already overflowing the viewport, no-op\n            }\n            else if (elementTop < scrollTop + paddingTop || (viewItemBottom >= scrollBottom && elementHeight >= this.view.renderHeight)) {\n                this.view.setScrollTop(elementTop - paddingTop);\n            }\n            else if (viewItemBottom >= scrollBottom) {\n                this.view.setScrollTop(viewItemBottom - this.view.renderHeight);\n            }\n        }\n    }\n    /**\n     * Returns the relative position of an element rendered in the list.\n     * Returns `null` if the element isn't *entirely* in the visible viewport.\n     */\n    getRelativeTop(index, paddingTop = 0) {\n        if (index < 0 || index >= this.length) {\n            throw new ListError(this.user, `Invalid index ${index}`);\n        }\n        const scrollTop = this.view.getScrollTop();\n        const elementTop = this.view.elementTop(index);\n        const elementHeight = this.view.elementHeight(index);\n        if (elementTop < scrollTop + paddingTop || elementTop + elementHeight > scrollTop + this.view.renderHeight) {\n            return null;\n        }\n        // y = mx + b\n        const m = elementHeight - this.view.renderHeight + paddingTop;\n        return Math.abs((scrollTop + paddingTop - elementTop) / m);\n    }\n    getHTMLElement() {\n        return this.view.domNode;\n    }\n    getScrollableElement() {\n        return this.view.scrollableElementDomNode;\n    }\n    getElementID(index) {\n        return this.view.getElementDomId(index);\n    }\n    getElementTop(index) {\n        return this.view.elementTop(index);\n    }\n    style(styles) {\n        this.styleController.style(styles);\n    }\n    toListEvent({ indexes, browserEvent }) {\n        return { indexes, elements: indexes.map(i => this.view.element(i)), browserEvent };\n    }\n    _onFocusChange() {\n        const focus = this.focus.get();\n        this.view.domNode.classList.toggle('element-focused', focus.length > 0);\n        this.onDidChangeActiveDescendant();\n    }\n    onDidChangeActiveDescendant() {\n        const focus = this.focus.get();\n        if (focus.length > 0) {\n            let id;\n            if (this.accessibilityProvider?.getActiveDescendantId) {\n                id = this.accessibilityProvider.getActiveDescendantId(this.view.element(focus[0]));\n            }\n            this.view.domNode.setAttribute('aria-activedescendant', id || this.view.getElementDomId(focus[0]));\n        }\n        else {\n            this.view.domNode.removeAttribute('aria-activedescendant');\n        }\n    }\n    _onSelectionChange() {\n        const selection = this.selection.get();\n        this.view.domNode.classList.toggle('selection-none', selection.length === 0);\n        this.view.domNode.classList.toggle('selection-single', selection.length === 1);\n        this.view.domNode.classList.toggle('selection-multiple', selection.length > 1);\n    }\n    dispose() {\n        this._onDidDispose.fire();\n        this.disposables.dispose();\n        this._onDidDispose.dispose();\n    }\n}\n__decorate([\n    memoize\n], List.prototype, \"onDidChangeFocus\", null);\n__decorate([\n    memoize\n], List.prototype, \"onDidChangeSelection\", null);\n__decorate([\n    memoize\n], List.prototype, \"onContextMenu\", null);\n__decorate([\n    memoize\n], List.prototype, \"onKeyDown\", null);\n__decorate([\n    memoize\n], List.prototype, \"onDidFocus\", null);\n__decorate([\n    memoize\n], List.prototype, \"onDidBlur\", null);\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}