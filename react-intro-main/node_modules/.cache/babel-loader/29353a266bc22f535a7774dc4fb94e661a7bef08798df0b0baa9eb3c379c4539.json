{"ast":null,"code":"/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n    r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n    d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = this && this.__param || function (paramIndex, decorator) {\n  return function (target, key) {\n    decorator(target, key, paramIndex);\n  };\n};\nvar InlineEditController_1;\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport { autorun, constObservable, observableFromEvent, observableSignalFromEvent, observableValue, transaction } from '../../../../base/common/observable.js';\nimport { EditOperation } from '../../../common/core/editOperation.js';\nimport { Position } from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nimport { GhostTextWidget } from './ghostTextWidget.js';\nimport { IContextKeyService, RawContextKey } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { InlineEditTriggerKind } from '../../../common/languages.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { CancellationTokenSource } from '../../../../base/common/cancellation.js';\nimport { GhostText, GhostTextPart } from '../../inlineCompletions/browser/model/ghostText.js';\nimport { ICommandService } from '../../../../platform/commands/common/commands.js';\nimport { InlineEditHintsWidget } from './inlineEditHintsWidget.js';\nimport { createStyleSheet2 } from '../../../../base/browser/dom.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nimport { onUnexpectedExternalError } from '../../../../base/common/errors.js';\nimport { derivedDisposable } from '../../../../base/common/observableInternal/derived.js';\nimport { InlineEditSideBySideWidget } from './inlineEditSideBySideWidget.js';\nimport { IDiffProviderFactoryService } from '../../../browser/widget/diffEditor/diffProviderFactoryService.js';\nimport { IModelService } from '../../../common/services/model.js';\nlet InlineEditController = class InlineEditController extends Disposable {\n  static {\n    InlineEditController_1 = this;\n  }\n  static {\n    this.ID = 'editor.contrib.inlineEditController';\n  }\n  static {\n    this.inlineEditVisibleKey = 'inlineEditVisible';\n  }\n  static {\n    this.inlineEditVisibleContext = new RawContextKey(this.inlineEditVisibleKey, false);\n  }\n  static {\n    this.cursorAtInlineEditKey = 'cursorAtInlineEdit';\n  }\n  static {\n    this.cursorAtInlineEditContext = new RawContextKey(this.cursorAtInlineEditKey, false);\n  }\n  static get(editor) {\n    return editor.getContribution(InlineEditController_1.ID);\n  }\n  constructor(editor, instantiationService, contextKeyService, languageFeaturesService, _commandService, _configurationService, _diffProviderFactoryService, _modelService) {\n    super();\n    this.editor = editor;\n    this.instantiationService = instantiationService;\n    this.contextKeyService = contextKeyService;\n    this.languageFeaturesService = languageFeaturesService;\n    this._commandService = _commandService;\n    this._configurationService = _configurationService;\n    this._diffProviderFactoryService = _diffProviderFactoryService;\n    this._modelService = _modelService;\n    this._isVisibleContext = InlineEditController_1.inlineEditVisibleContext.bindTo(this.contextKeyService);\n    this._isCursorAtInlineEditContext = InlineEditController_1.cursorAtInlineEditContext.bindTo(this.contextKeyService);\n    this._currentEdit = observableValue(this, undefined);\n    this._currentWidget = derivedDisposable(this._currentEdit, reader => {\n      const edit = this._currentEdit.read(reader);\n      if (!edit) {\n        return undefined;\n      }\n      const line = edit.range.endLineNumber;\n      const column = edit.range.endColumn;\n      const textToDisplay = edit.text.endsWith('\\n') && !(edit.range.startLineNumber === edit.range.endLineNumber && edit.range.startColumn === edit.range.endColumn) ? edit.text.slice(0, -1) : edit.text;\n      const ghostText = new GhostText(line, [new GhostTextPart(column, textToDisplay, false)]);\n      //only show ghost text for single line edits\n      //unless it is a pure removal\n      //multi line edits are shown in the side by side widget\n      const isSingleLine = edit.range.startLineNumber === edit.range.endLineNumber && ghostText.parts.length === 1 && ghostText.parts[0].lines.length === 1;\n      const isPureRemoval = edit.text === '';\n      if (!isSingleLine && !isPureRemoval) {\n        return undefined;\n      }\n      const instance = this.instantiationService.createInstance(GhostTextWidget, this.editor, {\n        ghostText: constObservable(ghostText),\n        minReservedLineCount: constObservable(0),\n        targetTextModel: constObservable(this.editor.getModel() ?? undefined),\n        range: constObservable(edit.range)\n      });\n      return instance;\n    });\n    this._isAccepting = observableValue(this, false);\n    this._enabled = observableFromEvent(this, this.editor.onDidChangeConfiguration, () => this.editor.getOption(63 /* EditorOption.inlineEdit */).enabled);\n    this._fontFamily = observableFromEvent(this, this.editor.onDidChangeConfiguration, () => this.editor.getOption(63 /* EditorOption.inlineEdit */).fontFamily);\n    //Automatically request inline edit when the content was changed\n    //Cancel the previous request if there is one\n    //Remove the previous ghost text\n    const modelChangedSignal = observableSignalFromEvent('InlineEditController.modelContentChangedSignal', editor.onDidChangeModelContent);\n    this._register(autorun(reader => {\n      /** @description InlineEditController.modelContentChanged model */\n      if (!this._enabled.read(reader)) {\n        return;\n      }\n      modelChangedSignal.read(reader);\n      if (this._isAccepting.read(reader)) {\n        return;\n      }\n      this.getInlineEdit(editor, true);\n    }));\n    //Check if the cursor is at the ghost text\n    const cursorPosition = observableFromEvent(this, editor.onDidChangeCursorPosition, () => editor.getPosition());\n    this._register(autorun(reader => {\n      /** @description InlineEditController.cursorPositionChanged model */\n      if (!this._enabled.read(reader)) {\n        return;\n      }\n      const pos = cursorPosition.read(reader);\n      if (pos) {\n        this.checkCursorPosition(pos);\n      }\n    }));\n    //Perform stuff when the current edit has changed\n    this._register(autorun(reader => {\n      /** @description InlineEditController.update model */\n      const currentEdit = this._currentEdit.read(reader);\n      this._isCursorAtInlineEditContext.set(false);\n      if (!currentEdit) {\n        this._isVisibleContext.set(false);\n        return;\n      }\n      this._isVisibleContext.set(true);\n      const pos = editor.getPosition();\n      if (pos) {\n        this.checkCursorPosition(pos);\n      }\n    }));\n    //Clear suggestions on lost focus\n    const editorBlurSingal = observableSignalFromEvent('InlineEditController.editorBlurSignal', editor.onDidBlurEditorWidget);\n    this._register(autorun(async reader => {\n      /** @description InlineEditController.editorBlur */\n      if (!this._enabled.read(reader)) {\n        return;\n      }\n      editorBlurSingal.read(reader);\n      // This is a hidden setting very useful for debugging\n      if (this._configurationService.getValue('editor.experimentalInlineEdit.keepOnBlur') || editor.getOption(63 /* EditorOption.inlineEdit */).keepOnBlur) {\n        return;\n      }\n      this._currentRequestCts?.dispose(true);\n      this._currentRequestCts = undefined;\n      await this.clear(false);\n    }));\n    //Invoke provider on focus\n    const editorFocusSignal = observableSignalFromEvent('InlineEditController.editorFocusSignal', editor.onDidFocusEditorText);\n    this._register(autorun(reader => {\n      /** @description InlineEditController.editorFocus */\n      if (!this._enabled.read(reader)) {\n        return;\n      }\n      editorFocusSignal.read(reader);\n      this.getInlineEdit(editor, true);\n    }));\n    //handle changes of font setting\n    const styleElement = this._register(createStyleSheet2());\n    this._register(autorun(reader => {\n      const fontFamily = this._fontFamily.read(reader);\n      styleElement.setStyle(fontFamily === '' || fontFamily === 'default' ? `` : `\n.monaco-editor .inline-edit-decoration,\n.monaco-editor .inline-edit-decoration-preview,\n.monaco-editor .inline-edit {\n\tfont-family: ${fontFamily};\n}`);\n    }));\n    this._register(new InlineEditHintsWidget(this.editor, this._currentWidget, this.instantiationService));\n    this._register(new InlineEditSideBySideWidget(this.editor, this._currentEdit, this.instantiationService, this._diffProviderFactoryService, this._modelService));\n  }\n  checkCursorPosition(position) {\n    if (!this._currentEdit) {\n      this._isCursorAtInlineEditContext.set(false);\n      return;\n    }\n    const gt = this._currentEdit.get();\n    if (!gt) {\n      this._isCursorAtInlineEditContext.set(false);\n      return;\n    }\n    this._isCursorAtInlineEditContext.set(Range.containsPosition(gt.range, position));\n  }\n  validateInlineEdit(editor, edit) {\n    //Multiline inline replacing edit must replace whole lines\n    if (edit.text.includes('\\n') && edit.range.startLineNumber !== edit.range.endLineNumber && edit.range.startColumn !== edit.range.endColumn) {\n      const firstColumn = edit.range.startColumn;\n      if (firstColumn !== 1) {\n        return false;\n      }\n      const lastLine = edit.range.endLineNumber;\n      const lastColumn = edit.range.endColumn;\n      const lineLength = editor.getModel()?.getLineLength(lastLine) ?? 0;\n      if (lastColumn !== lineLength + 1) {\n        return false;\n      }\n    }\n    return true;\n  }\n  async fetchInlineEdit(editor, auto) {\n    if (this._currentRequestCts) {\n      this._currentRequestCts.dispose(true);\n    }\n    const model = editor.getModel();\n    if (!model) {\n      return;\n    }\n    const modelVersion = model.getVersionId();\n    const providers = this.languageFeaturesService.inlineEditProvider.all(model);\n    if (providers.length === 0) {\n      return;\n    }\n    const provider = providers[0];\n    this._currentRequestCts = new CancellationTokenSource();\n    const token = this._currentRequestCts.token;\n    const triggerKind = auto ? InlineEditTriggerKind.Automatic : InlineEditTriggerKind.Invoke;\n    const shouldDebounce = auto;\n    if (shouldDebounce) {\n      await wait(50, token);\n    }\n    if (token.isCancellationRequested || model.isDisposed() || model.getVersionId() !== modelVersion) {\n      return;\n    }\n    const edit = await provider.provideInlineEdit(model, {\n      triggerKind\n    }, token);\n    if (!edit) {\n      return;\n    }\n    if (token.isCancellationRequested || model.isDisposed() || model.getVersionId() !== modelVersion) {\n      return;\n    }\n    if (!this.validateInlineEdit(editor, edit)) {\n      return;\n    }\n    return edit;\n  }\n  async getInlineEdit(editor, auto) {\n    this._isCursorAtInlineEditContext.set(false);\n    await this.clear();\n    const edit = await this.fetchInlineEdit(editor, auto);\n    if (!edit) {\n      return;\n    }\n    this._currentEdit.set(edit, undefined);\n  }\n  async trigger() {\n    await this.getInlineEdit(this.editor, false);\n  }\n  async jumpBack() {\n    if (!this._jumpBackPosition) {\n      return;\n    }\n    this.editor.setPosition(this._jumpBackPosition);\n    //if position is outside viewports, scroll to it\n    this.editor.revealPositionInCenterIfOutsideViewport(this._jumpBackPosition);\n  }\n  async accept() {\n    this._isAccepting.set(true, undefined);\n    const data = this._currentEdit.get();\n    if (!data) {\n      return;\n    }\n    //It should only happen in case of last line suggestion\n    let text = data.text;\n    if (data.text.startsWith('\\n')) {\n      text = data.text.substring(1);\n    }\n    this.editor.pushUndoStop();\n    this.editor.executeEdits('acceptCurrent', [EditOperation.replace(Range.lift(data.range), text)]);\n    if (data.accepted) {\n      await this._commandService.executeCommand(data.accepted.id, ...(data.accepted.arguments || [])).then(undefined, onUnexpectedExternalError);\n    }\n    this.freeEdit(data);\n    transaction(tx => {\n      this._currentEdit.set(undefined, tx);\n      this._isAccepting.set(false, tx);\n    });\n  }\n  jumpToCurrent() {\n    this._jumpBackPosition = this.editor.getSelection()?.getStartPosition();\n    const data = this._currentEdit.get();\n    if (!data) {\n      return;\n    }\n    const position = Position.lift({\n      lineNumber: data.range.startLineNumber,\n      column: data.range.startColumn\n    });\n    this.editor.setPosition(position);\n    //if position is outside viewports, scroll to it\n    this.editor.revealPositionInCenterIfOutsideViewport(position);\n  }\n  async clear(sendRejection = true) {\n    const edit = this._currentEdit.get();\n    if (edit && edit?.rejected && sendRejection) {\n      await this._commandService.executeCommand(edit.rejected.id, ...(edit.rejected.arguments || [])).then(undefined, onUnexpectedExternalError);\n    }\n    if (edit) {\n      this.freeEdit(edit);\n    }\n    this._currentEdit.set(undefined, undefined);\n  }\n  freeEdit(edit) {\n    const model = this.editor.getModel();\n    if (!model) {\n      return;\n    }\n    const providers = this.languageFeaturesService.inlineEditProvider.all(model);\n    if (providers.length === 0) {\n      return;\n    }\n    providers[0].freeInlineEdit(edit);\n  }\n};\nInlineEditController = InlineEditController_1 = __decorate([__param(1, IInstantiationService), __param(2, IContextKeyService), __param(3, ILanguageFeaturesService), __param(4, ICommandService), __param(5, IConfigurationService), __param(6, IDiffProviderFactoryService), __param(7, IModelService)], InlineEditController);\nexport { InlineEditController };\nfunction wait(ms, cancellationToken) {\n  return new Promise(resolve => {\n    let d = undefined;\n    const handle = setTimeout(() => {\n      if (d) {\n        d.dispose();\n      }\n      resolve();\n    }, ms);\n    if (cancellationToken) {\n      d = cancellationToken.onCancellationRequested(() => {\n        clearTimeout(handle);\n        if (d) {\n          d.dispose();\n        }\n        resolve();\n      });\n    }\n  });\n}","map":{"version":3,"names":["__decorate","decorators","target","key","desc","c","arguments","length","r","Object","getOwnPropertyDescriptor","d","Reflect","decorate","i","defineProperty","__param","paramIndex","decorator","InlineEditController_1","Disposable","autorun","constObservable","observableFromEvent","observableSignalFromEvent","observableValue","transaction","EditOperation","Position","Range","GhostTextWidget","IContextKeyService","RawContextKey","IInstantiationService","InlineEditTriggerKind","ILanguageFeaturesService","CancellationTokenSource","GhostText","GhostTextPart","ICommandService","InlineEditHintsWidget","createStyleSheet2","IConfigurationService","onUnexpectedExternalError","derivedDisposable","InlineEditSideBySideWidget","IDiffProviderFactoryService","IModelService","InlineEditController","ID","inlineEditVisibleKey","inlineEditVisibleContext","cursorAtInlineEditKey","cursorAtInlineEditContext","get","editor","getContribution","constructor","instantiationService","contextKeyService","languageFeaturesService","_commandService","_configurationService","_diffProviderFactoryService","_modelService","_isVisibleContext","bindTo","_isCursorAtInlineEditContext","_currentEdit","undefined","_currentWidget","reader","edit","read","line","range","endLineNumber","column","endColumn","textToDisplay","text","endsWith","startLineNumber","startColumn","slice","ghostText","isSingleLine","parts","lines","isPureRemoval","instance","createInstance","minReservedLineCount","targetTextModel","getModel","_isAccepting","_enabled","onDidChangeConfiguration","getOption","enabled","_fontFamily","fontFamily","modelChangedSignal","onDidChangeModelContent","_register","getInlineEdit","cursorPosition","onDidChangeCursorPosition","getPosition","pos","checkCursorPosition","currentEdit","set","editorBlurSingal","onDidBlurEditorWidget","getValue","keepOnBlur","_currentRequestCts","dispose","clear","editorFocusSignal","onDidFocusEditorText","styleElement","setStyle","position","gt","containsPosition","validateInlineEdit","includes","firstColumn","lastLine","lastColumn","lineLength","getLineLength","fetchInlineEdit","auto","model","modelVersion","getVersionId","providers","inlineEditProvider","all","provider","token","triggerKind","Automatic","Invoke","shouldDebounce","wait","isCancellationRequested","isDisposed","provideInlineEdit","trigger","jumpBack","_jumpBackPosition","setPosition","revealPositionInCenterIfOutsideViewport","accept","data","startsWith","substring","pushUndoStop","executeEdits","replace","lift","accepted","executeCommand","id","then","freeEdit","tx","jumpToCurrent","getSelection","getStartPosition","lineNumber","sendRejection","rejected","freeInlineEdit","ms","cancellationToken","Promise","resolve","handle","setTimeout","onCancellationRequested","clearTimeout"],"sources":["D:/OSPanel/domains/react/react-intro-main/node_modules/monaco-editor/esm/vs/editor/contrib/inlineEdit/browser/inlineEditController.js"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nvar InlineEditController_1;\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport { autorun, constObservable, observableFromEvent, observableSignalFromEvent, observableValue, transaction } from '../../../../base/common/observable.js';\nimport { EditOperation } from '../../../common/core/editOperation.js';\nimport { Position } from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nimport { GhostTextWidget } from './ghostTextWidget.js';\nimport { IContextKeyService, RawContextKey } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { InlineEditTriggerKind } from '../../../common/languages.js';\nimport { ILanguageFeaturesService } from '../../../common/services/languageFeatures.js';\nimport { CancellationTokenSource } from '../../../../base/common/cancellation.js';\nimport { GhostText, GhostTextPart } from '../../inlineCompletions/browser/model/ghostText.js';\nimport { ICommandService } from '../../../../platform/commands/common/commands.js';\nimport { InlineEditHintsWidget } from './inlineEditHintsWidget.js';\nimport { createStyleSheet2 } from '../../../../base/browser/dom.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nimport { onUnexpectedExternalError } from '../../../../base/common/errors.js';\nimport { derivedDisposable } from '../../../../base/common/observableInternal/derived.js';\nimport { InlineEditSideBySideWidget } from './inlineEditSideBySideWidget.js';\nimport { IDiffProviderFactoryService } from '../../../browser/widget/diffEditor/diffProviderFactoryService.js';\nimport { IModelService } from '../../../common/services/model.js';\nlet InlineEditController = class InlineEditController extends Disposable {\n    static { InlineEditController_1 = this; }\n    static { this.ID = 'editor.contrib.inlineEditController'; }\n    static { this.inlineEditVisibleKey = 'inlineEditVisible'; }\n    static { this.inlineEditVisibleContext = new RawContextKey(this.inlineEditVisibleKey, false); }\n    static { this.cursorAtInlineEditKey = 'cursorAtInlineEdit'; }\n    static { this.cursorAtInlineEditContext = new RawContextKey(this.cursorAtInlineEditKey, false); }\n    static get(editor) {\n        return editor.getContribution(InlineEditController_1.ID);\n    }\n    constructor(editor, instantiationService, contextKeyService, languageFeaturesService, _commandService, _configurationService, _diffProviderFactoryService, _modelService) {\n        super();\n        this.editor = editor;\n        this.instantiationService = instantiationService;\n        this.contextKeyService = contextKeyService;\n        this.languageFeaturesService = languageFeaturesService;\n        this._commandService = _commandService;\n        this._configurationService = _configurationService;\n        this._diffProviderFactoryService = _diffProviderFactoryService;\n        this._modelService = _modelService;\n        this._isVisibleContext = InlineEditController_1.inlineEditVisibleContext.bindTo(this.contextKeyService);\n        this._isCursorAtInlineEditContext = InlineEditController_1.cursorAtInlineEditContext.bindTo(this.contextKeyService);\n        this._currentEdit = observableValue(this, undefined);\n        this._currentWidget = derivedDisposable(this._currentEdit, (reader) => {\n            const edit = this._currentEdit.read(reader);\n            if (!edit) {\n                return undefined;\n            }\n            const line = edit.range.endLineNumber;\n            const column = edit.range.endColumn;\n            const textToDisplay = edit.text.endsWith('\\n') && !(edit.range.startLineNumber === edit.range.endLineNumber && edit.range.startColumn === edit.range.endColumn) ? edit.text.slice(0, -1) : edit.text;\n            const ghostText = new GhostText(line, [new GhostTextPart(column, textToDisplay, false)]);\n            //only show ghost text for single line edits\n            //unless it is a pure removal\n            //multi line edits are shown in the side by side widget\n            const isSingleLine = edit.range.startLineNumber === edit.range.endLineNumber && ghostText.parts.length === 1 && ghostText.parts[0].lines.length === 1;\n            const isPureRemoval = edit.text === '';\n            if (!isSingleLine && !isPureRemoval) {\n                return undefined;\n            }\n            const instance = this.instantiationService.createInstance(GhostTextWidget, this.editor, {\n                ghostText: constObservable(ghostText),\n                minReservedLineCount: constObservable(0),\n                targetTextModel: constObservable(this.editor.getModel() ?? undefined),\n                range: constObservable(edit.range)\n            });\n            return instance;\n        });\n        this._isAccepting = observableValue(this, false);\n        this._enabled = observableFromEvent(this, this.editor.onDidChangeConfiguration, () => this.editor.getOption(63 /* EditorOption.inlineEdit */).enabled);\n        this._fontFamily = observableFromEvent(this, this.editor.onDidChangeConfiguration, () => this.editor.getOption(63 /* EditorOption.inlineEdit */).fontFamily);\n        //Automatically request inline edit when the content was changed\n        //Cancel the previous request if there is one\n        //Remove the previous ghost text\n        const modelChangedSignal = observableSignalFromEvent('InlineEditController.modelContentChangedSignal', editor.onDidChangeModelContent);\n        this._register(autorun(reader => {\n            /** @description InlineEditController.modelContentChanged model */\n            if (!this._enabled.read(reader)) {\n                return;\n            }\n            modelChangedSignal.read(reader);\n            if (this._isAccepting.read(reader)) {\n                return;\n            }\n            this.getInlineEdit(editor, true);\n        }));\n        //Check if the cursor is at the ghost text\n        const cursorPosition = observableFromEvent(this, editor.onDidChangeCursorPosition, () => editor.getPosition());\n        this._register(autorun(reader => {\n            /** @description InlineEditController.cursorPositionChanged model */\n            if (!this._enabled.read(reader)) {\n                return;\n            }\n            const pos = cursorPosition.read(reader);\n            if (pos) {\n                this.checkCursorPosition(pos);\n            }\n        }));\n        //Perform stuff when the current edit has changed\n        this._register(autorun((reader) => {\n            /** @description InlineEditController.update model */\n            const currentEdit = this._currentEdit.read(reader);\n            this._isCursorAtInlineEditContext.set(false);\n            if (!currentEdit) {\n                this._isVisibleContext.set(false);\n                return;\n            }\n            this._isVisibleContext.set(true);\n            const pos = editor.getPosition();\n            if (pos) {\n                this.checkCursorPosition(pos);\n            }\n        }));\n        //Clear suggestions on lost focus\n        const editorBlurSingal = observableSignalFromEvent('InlineEditController.editorBlurSignal', editor.onDidBlurEditorWidget);\n        this._register(autorun(async (reader) => {\n            /** @description InlineEditController.editorBlur */\n            if (!this._enabled.read(reader)) {\n                return;\n            }\n            editorBlurSingal.read(reader);\n            // This is a hidden setting very useful for debugging\n            if (this._configurationService.getValue('editor.experimentalInlineEdit.keepOnBlur') || editor.getOption(63 /* EditorOption.inlineEdit */).keepOnBlur) {\n                return;\n            }\n            this._currentRequestCts?.dispose(true);\n            this._currentRequestCts = undefined;\n            await this.clear(false);\n        }));\n        //Invoke provider on focus\n        const editorFocusSignal = observableSignalFromEvent('InlineEditController.editorFocusSignal', editor.onDidFocusEditorText);\n        this._register(autorun(reader => {\n            /** @description InlineEditController.editorFocus */\n            if (!this._enabled.read(reader)) {\n                return;\n            }\n            editorFocusSignal.read(reader);\n            this.getInlineEdit(editor, true);\n        }));\n        //handle changes of font setting\n        const styleElement = this._register(createStyleSheet2());\n        this._register(autorun(reader => {\n            const fontFamily = this._fontFamily.read(reader);\n            styleElement.setStyle(fontFamily === '' || fontFamily === 'default' ? `` : `\n.monaco-editor .inline-edit-decoration,\n.monaco-editor .inline-edit-decoration-preview,\n.monaco-editor .inline-edit {\n\tfont-family: ${fontFamily};\n}`);\n        }));\n        this._register(new InlineEditHintsWidget(this.editor, this._currentWidget, this.instantiationService));\n        this._register(new InlineEditSideBySideWidget(this.editor, this._currentEdit, this.instantiationService, this._diffProviderFactoryService, this._modelService));\n    }\n    checkCursorPosition(position) {\n        if (!this._currentEdit) {\n            this._isCursorAtInlineEditContext.set(false);\n            return;\n        }\n        const gt = this._currentEdit.get();\n        if (!gt) {\n            this._isCursorAtInlineEditContext.set(false);\n            return;\n        }\n        this._isCursorAtInlineEditContext.set(Range.containsPosition(gt.range, position));\n    }\n    validateInlineEdit(editor, edit) {\n        //Multiline inline replacing edit must replace whole lines\n        if (edit.text.includes('\\n') && edit.range.startLineNumber !== edit.range.endLineNumber && edit.range.startColumn !== edit.range.endColumn) {\n            const firstColumn = edit.range.startColumn;\n            if (firstColumn !== 1) {\n                return false;\n            }\n            const lastLine = edit.range.endLineNumber;\n            const lastColumn = edit.range.endColumn;\n            const lineLength = editor.getModel()?.getLineLength(lastLine) ?? 0;\n            if (lastColumn !== lineLength + 1) {\n                return false;\n            }\n        }\n        return true;\n    }\n    async fetchInlineEdit(editor, auto) {\n        if (this._currentRequestCts) {\n            this._currentRequestCts.dispose(true);\n        }\n        const model = editor.getModel();\n        if (!model) {\n            return;\n        }\n        const modelVersion = model.getVersionId();\n        const providers = this.languageFeaturesService.inlineEditProvider.all(model);\n        if (providers.length === 0) {\n            return;\n        }\n        const provider = providers[0];\n        this._currentRequestCts = new CancellationTokenSource();\n        const token = this._currentRequestCts.token;\n        const triggerKind = auto ? InlineEditTriggerKind.Automatic : InlineEditTriggerKind.Invoke;\n        const shouldDebounce = auto;\n        if (shouldDebounce) {\n            await wait(50, token);\n        }\n        if (token.isCancellationRequested || model.isDisposed() || model.getVersionId() !== modelVersion) {\n            return;\n        }\n        const edit = await provider.provideInlineEdit(model, { triggerKind }, token);\n        if (!edit) {\n            return;\n        }\n        if (token.isCancellationRequested || model.isDisposed() || model.getVersionId() !== modelVersion) {\n            return;\n        }\n        if (!this.validateInlineEdit(editor, edit)) {\n            return;\n        }\n        return edit;\n    }\n    async getInlineEdit(editor, auto) {\n        this._isCursorAtInlineEditContext.set(false);\n        await this.clear();\n        const edit = await this.fetchInlineEdit(editor, auto);\n        if (!edit) {\n            return;\n        }\n        this._currentEdit.set(edit, undefined);\n    }\n    async trigger() {\n        await this.getInlineEdit(this.editor, false);\n    }\n    async jumpBack() {\n        if (!this._jumpBackPosition) {\n            return;\n        }\n        this.editor.setPosition(this._jumpBackPosition);\n        //if position is outside viewports, scroll to it\n        this.editor.revealPositionInCenterIfOutsideViewport(this._jumpBackPosition);\n    }\n    async accept() {\n        this._isAccepting.set(true, undefined);\n        const data = this._currentEdit.get();\n        if (!data) {\n            return;\n        }\n        //It should only happen in case of last line suggestion\n        let text = data.text;\n        if (data.text.startsWith('\\n')) {\n            text = data.text.substring(1);\n        }\n        this.editor.pushUndoStop();\n        this.editor.executeEdits('acceptCurrent', [EditOperation.replace(Range.lift(data.range), text)]);\n        if (data.accepted) {\n            await this._commandService\n                .executeCommand(data.accepted.id, ...(data.accepted.arguments || []))\n                .then(undefined, onUnexpectedExternalError);\n        }\n        this.freeEdit(data);\n        transaction((tx) => {\n            this._currentEdit.set(undefined, tx);\n            this._isAccepting.set(false, tx);\n        });\n    }\n    jumpToCurrent() {\n        this._jumpBackPosition = this.editor.getSelection()?.getStartPosition();\n        const data = this._currentEdit.get();\n        if (!data) {\n            return;\n        }\n        const position = Position.lift({ lineNumber: data.range.startLineNumber, column: data.range.startColumn });\n        this.editor.setPosition(position);\n        //if position is outside viewports, scroll to it\n        this.editor.revealPositionInCenterIfOutsideViewport(position);\n    }\n    async clear(sendRejection = true) {\n        const edit = this._currentEdit.get();\n        if (edit && edit?.rejected && sendRejection) {\n            await this._commandService\n                .executeCommand(edit.rejected.id, ...(edit.rejected.arguments || []))\n                .then(undefined, onUnexpectedExternalError);\n        }\n        if (edit) {\n            this.freeEdit(edit);\n        }\n        this._currentEdit.set(undefined, undefined);\n    }\n    freeEdit(edit) {\n        const model = this.editor.getModel();\n        if (!model) {\n            return;\n        }\n        const providers = this.languageFeaturesService.inlineEditProvider.all(model);\n        if (providers.length === 0) {\n            return;\n        }\n        providers[0].freeInlineEdit(edit);\n    }\n};\nInlineEditController = InlineEditController_1 = __decorate([\n    __param(1, IInstantiationService),\n    __param(2, IContextKeyService),\n    __param(3, ILanguageFeaturesService),\n    __param(4, ICommandService),\n    __param(5, IConfigurationService),\n    __param(6, IDiffProviderFactoryService),\n    __param(7, IModelService)\n], InlineEditController);\nexport { InlineEditController };\nfunction wait(ms, cancellationToken) {\n    return new Promise(resolve => {\n        let d = undefined;\n        const handle = setTimeout(() => {\n            if (d) {\n                d.dispose();\n            }\n            resolve();\n        }, ms);\n        if (cancellationToken) {\n            d = cancellationToken.onCancellationRequested(() => {\n                clearTimeout(handle);\n                if (d) {\n                    d.dispose();\n                }\n                resolve();\n            });\n        }\n    });\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}