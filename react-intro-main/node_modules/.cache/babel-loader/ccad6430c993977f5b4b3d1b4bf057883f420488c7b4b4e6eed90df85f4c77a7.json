{"ast":null,"code":"/*\nCopyright 2021-present The maxGraph project Contributors\nCopyright (c) 2006-2015, JGraph Ltd\nCopyright (c) 2006-2015, Gaudenz Alder\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n    http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n*/\nimport Rectangle from '../geometry/Rectangle';\nimport CellHighlight from '../cell/CellHighlight';\nimport { getDocumentScrollOrigin, getOffset, getScrollOrigin, setOpacity } from '../../util/styleUtils';\nimport InternalEvent from '../event/InternalEvent';\nimport Client from '../../Client';\nimport Guide from './Guide';\nimport { DROP_TARGET_COLOR } from '../../util/Constants';\nimport Point from '../geometry/Point';\nimport { getClientX, getClientY, getSource, isConsumed, isMouseEvent, isPenEvent, isTouchEvent } from '../../util/EventUtils';\n/**\n * @class DragSource\n *\n * Wrapper to create a drag source from a DOM element so that the element can\n * be dragged over a graph and dropped into the graph as a new cell.\n *\n * Problem is that in the dropHandler the current preview location is not\n * available, so the preview and the dropHandler must match.\n *\n */\nclass DragSource {\n  constructor(element, dropHandler) {\n    /**\n     * {@link Point} that specifies the offset of the {@link dragElement}. Default is null.\n     */\n    this.dragOffset = null;\n    /**\n     * Holds the DOM node that is used to represent the drag preview. If this is\n     * null then the source element will be cloned and used for the drag preview.\n     */\n    this.dragElement = null;\n    /**\n     * TODO - wrong description\n     * Optional {@link Rectangle} that specifies the unscaled size of the preview.\n     */\n    this.previewElement = null;\n    /**\n     * Optional {@link Point} that specifies the offset of the preview in pixels.\n     */\n    this.previewOffset = null;\n    /**\n     * Specifies if this drag source is enabled. Default is true.\n     */\n    this.enabled = true;\n    /**\n     * Reference to the {@link mxGraph} that is the current drop target.\n     */\n    this.currentGraph = null;\n    /**\n     * Holds the current drop target under the mouse.\n     */\n    this.currentDropTarget = null;\n    /**\n     * Holds the current drop location.\n     */\n    this.currentPoint = null;\n    /**\n     * Holds an {@link mxGuide} for the {@link currentGraph} if {@link dragPreview} is not null.\n     */\n    this.currentGuide = null;\n    /**\n     * Holds an {@link mxGuide} for the {@link currentGraph} if {@link dragPreview} is not null.\n     * @note wrong doc\n     */\n    this.currentHighlight = null;\n    /**\n     * Specifies if the graph should scroll automatically. Default is true.\n     */\n    this.autoscroll = true;\n    /**\n     * Specifies if {@link mxGuide} should be enabled. Default is true.\n     */\n    this.guidesEnabled = true;\n    /**\n     * Specifies if the grid should be allowed. Default is true.\n     */\n    this.gridEnabled = true;\n    /**\n     * Specifies if drop targets should be highlighted. Default is true.\n     */\n    this.highlightDropTargets = true;\n    /**\n     * ZIndex for the drag element. Default is 100.\n     */\n    this.dragElementZIndex = 100;\n    /**\n     * Opacity of the drag element in %. Default is 70.\n     */\n    this.dragElementOpacity = 70;\n    /**\n     * Whether the event source should be checked in {@link graphContainerEvent}. Default\n     * is true.\n     */\n    this.checkEventSource = true;\n    this.mouseMoveHandler = null;\n    this.mouseUpHandler = null;\n    this.eventSource = null;\n    this.element = element;\n    this.dropHandler = dropHandler;\n    // Handles a drag gesture on the element\n    InternalEvent.addGestureListeners(element, evt => {\n      this.mouseDown(evt);\n    });\n    // Prevents native drag and drop\n    InternalEvent.addListener(element, 'dragstart', evt => {\n      InternalEvent.consume(evt);\n    });\n    this.eventConsumer = (sender, evt) => {\n      const evtName = evt.getProperty('eventName');\n      const me = evt.getProperty('event');\n      if (evtName !== InternalEvent.MOUSE_DOWN) {\n        me.consume();\n      }\n    };\n  }\n  /**\n   * Returns {@link enabled}.\n   */\n  isEnabled() {\n    return this.enabled;\n  }\n  /**\n   * Sets {@link enabled}.\n   */\n  setEnabled(value) {\n    this.enabled = value;\n  }\n  /**\n   * Returns {@link guidesEnabled}.\n   */\n  isGuidesEnabled() {\n    return this.guidesEnabled;\n  }\n  /**\n   * Sets {@link guidesEnabled}.\n   */\n  setGuidesEnabled(value) {\n    this.guidesEnabled = value;\n  }\n  /**\n   * Returns {@link gridEnabled}.\n   */\n  isGridEnabled() {\n    return this.gridEnabled;\n  }\n  /**\n   * Sets {@link gridEnabled}.\n   */\n  setGridEnabled(value) {\n    this.gridEnabled = value;\n  }\n  /**\n   * Returns the graph for the given mouse event. This implementation returns\n   * null.\n   */\n  getGraphForEvent(evt) {\n    return null;\n  }\n  /**\n   * Returns the drop target for the given graph and coordinates. This\n   * implementation uses {@link mxGraph.getCellAt}.\n   */\n  getDropTarget(graph, x, y, evt) {\n    return graph.getCellAt(x, y);\n  }\n  /**\n   * Creates and returns a clone of the {@link dragElementPrototype} or the {@link element}\n   * if the former is not defined.\n   */\n  createDragElement(evt) {\n    return this.element.cloneNode(true);\n  }\n  /**\n   * Creates and returns an element which can be used as a preview in the given\n   * graph.\n   */\n  createPreviewElement(graph) {\n    return null;\n  }\n  /**\n   * Returns true if this drag source is active.\n   */\n  isActive() {\n    return !!this.mouseMoveHandler;\n  }\n  /**\n   * Stops and removes everything and restores the state of the object.\n   */\n  reset() {\n    if (this.currentGraph) {\n      this.dragExit(this.currentGraph);\n      this.currentGraph = null;\n    }\n    this.removeDragElement();\n    this.removeListeners();\n    this.stopDrag();\n  }\n  /**\n   * Returns the drop target for the given graph and coordinates. This\n   * implementation uses {@link mxGraph.getCellAt}.\n   *\n   * To ignore popup menu events for a drag source, this function can be\n   * overridden as follows.\n   *\n   * @example\n   * ```javascript\n   * var mouseDown = dragSource.mouseDown;\n   *\n   * dragSource.mouseDown(evt)\n   * {\n   *   if (!mxEvent.isPopupTrigger(evt))\n   *   {\n   *     mouseDown.apply(this, arguments);\n   *   }\n   * };\n   * ```\n   */\n  mouseDown(evt) {\n    if (this.enabled && !isConsumed(evt) && this.mouseMoveHandler == null) {\n      this.startDrag(evt);\n      this.mouseMoveHandler = this.mouseMove.bind(this);\n      this.mouseUpHandler = this.mouseUp.bind(this);\n      InternalEvent.addGestureListeners(document, null, this.mouseMoveHandler, this.mouseUpHandler);\n      if (Client.IS_TOUCH && !isMouseEvent(evt)) {\n        this.eventSource = getSource(evt);\n        if (this.eventSource) {\n          InternalEvent.addGestureListeners(this.eventSource, null, this.mouseMoveHandler, this.mouseUpHandler);\n        }\n      }\n    }\n  }\n  /**\n   * Creates the {@link dragElement} using {@link createDragElement}.\n   */\n  startDrag(evt) {\n    this.dragElement = this.createDragElement(evt);\n    this.dragElement.style.position = 'absolute';\n    this.dragElement.style.zIndex = String(this.dragElementZIndex);\n    setOpacity(this.dragElement, this.dragElementOpacity);\n    if (this.checkEventSource && Client.IS_SVG) {\n      this.dragElement.style.pointerEvents = 'none';\n    }\n  }\n  /**\n   * Invokes {@link removeDragElement}.\n   */\n  stopDrag() {\n    // LATER: This used to have a mouse event. If that is still needed we need to add another\n    // final call to the DnD protocol to add a cleanup step in the case of escape press, which\n    // is not associated with a mouse event and which currently calles this method.\n    this.removeDragElement();\n  }\n  /**\n   * Removes and destroys the {@link dragElement}.\n   */\n  removeDragElement() {\n    if (this.dragElement) {\n      if (this.dragElement.parentNode) {\n        this.dragElement.parentNode.removeChild(this.dragElement);\n      }\n      this.dragElement = null;\n    }\n  }\n  /**\n   * Returns the topmost element under the given event.\n   */\n  getElementForEvent(evt) {\n    return isTouchEvent(evt) || isPenEvent(evt) ? document.elementFromPoint(getClientX(evt), getClientY(evt)) : getSource(evt);\n  }\n  /**\n   * Returns true if the given graph contains the given event.\n   */\n  graphContainsEvent(graph, evt) {\n    const x = getClientX(evt);\n    const y = getClientY(evt);\n    const offset = getOffset(graph.container);\n    const origin = getScrollOrigin();\n    let elt = this.getElementForEvent(evt);\n    if (this.checkEventSource) {\n      while (elt && elt !== graph.container) {\n        // @ts-ignore parentNode may exist\n        elt = elt.parentNode;\n      }\n    }\n    // Checks if event is inside the bounds of the graph container\n    return !!elt && x >= offset.x - origin.x && y >= offset.y - origin.y && x <= offset.x - origin.x + graph.container.offsetWidth && y <= offset.y - origin.y + graph.container.offsetHeight;\n  }\n  /**\n   * Gets the graph for the given event using {@link getGraphForEvent}, updates the\n   * {@link currentGraph}, calling {@link dragEnter} and {@link dragExit} on the new and old graph,\n   * respectively, and invokes {@link dragOver} if {@link currentGraph} is not null.\n   */\n  mouseMove(evt) {\n    let graph = this.getGraphForEvent(evt);\n    // Checks if event is inside the bounds of the graph container\n    if (graph && !this.graphContainsEvent(graph, evt)) {\n      graph = null;\n    }\n    if (graph !== this.currentGraph) {\n      if (this.currentGraph) {\n        this.dragExit(this.currentGraph, evt);\n      }\n      this.currentGraph = graph;\n      if (this.currentGraph) {\n        this.dragEnter(this.currentGraph, evt);\n      }\n    }\n    if (this.currentGraph) {\n      this.dragOver(this.currentGraph, evt);\n    }\n    if (this.dragElement && (!this.previewElement || this.previewElement.style.visibility !== 'visible')) {\n      let x = getClientX(evt);\n      let y = getClientY(evt);\n      if (this.dragElement.parentNode == null) {\n        document.body.appendChild(this.dragElement);\n      }\n      this.dragElement.style.visibility = 'visible';\n      if (this.dragOffset) {\n        x += this.dragOffset.x;\n        y += this.dragOffset.y;\n      }\n      const offset = getDocumentScrollOrigin(document);\n      this.dragElement.style.left = \"\".concat(x + offset.x, \"px\");\n      this.dragElement.style.top = \"\".concat(y + offset.y, \"px\");\n    } else if (this.dragElement) {\n      this.dragElement.style.visibility = 'hidden';\n    }\n    InternalEvent.consume(evt);\n  }\n  /**\n   * Processes the mouse up event and invokes {@link drop}, {@link dragExit} and {@link stopDrag}\n   * as required.\n   */\n  mouseUp(evt) {\n    if (this.currentGraph) {\n      if (this.currentPoint && (!this.previewElement || this.previewElement.style.visibility !== 'hidden')) {\n        const {\n          scale\n        } = this.currentGraph.view;\n        const tr = this.currentGraph.view.translate;\n        const x = this.currentPoint.x / scale - tr.x;\n        const y = this.currentPoint.y / scale - tr.y;\n        this.drop(this.currentGraph, evt, this.currentDropTarget, x, y);\n      }\n      this.dragExit(this.currentGraph);\n      this.currentGraph = null;\n    }\n    this.stopDrag();\n    this.removeListeners();\n    InternalEvent.consume(evt);\n  }\n  /**\n   * Actives the given graph as a drop target.\n   */\n  // removeListeners(): void;\n  removeListeners() {\n    if (this.eventSource) {\n      InternalEvent.removeGestureListeners(this.eventSource, null, this.mouseMoveHandler, this.mouseUpHandler);\n      this.eventSource = null;\n    }\n    InternalEvent.removeGestureListeners(document, null, this.mouseMoveHandler, this.mouseUpHandler);\n    this.mouseMoveHandler = null;\n    this.mouseUpHandler = null;\n  }\n  /**\n   * Actives the given graph as a drop target.\n   */\n  dragEnter(graph, evt) {\n    graph.isMouseDown = true;\n    graph.isMouseTrigger = isMouseEvent(evt);\n    this.previewElement = this.createPreviewElement(graph);\n    if (this.previewElement && this.checkEventSource && Client.IS_SVG) {\n      this.previewElement.style.pointerEvents = 'none';\n    }\n    // Guide is only needed if preview element is used\n    if (this.isGuidesEnabled() && this.previewElement) {\n      const selectionHandler = graph.getPlugin('SelectionHandler');\n      this.currentGuide = new Guide(graph, selectionHandler === null || selectionHandler === void 0 ? void 0 : selectionHandler.getGuideStates());\n    }\n    if (this.highlightDropTargets) {\n      this.currentHighlight = new CellHighlight(graph, DROP_TARGET_COLOR);\n    }\n    // Consumes all events in the current graph before they are fired\n    graph.addListener(InternalEvent.FIRE_MOUSE_EVENT, this.eventConsumer);\n  }\n  /**\n   * Deactivates the given graph as a drop target.\n   */\n  dragExit(graph, evt) {\n    this.currentDropTarget = null;\n    this.currentPoint = null;\n    graph.isMouseDown = false;\n    // Consumes all events in the current graph before they are fired\n    graph.removeListener(this.eventConsumer);\n    if (this.previewElement) {\n      if (this.previewElement.parentNode) {\n        this.previewElement.parentNode.removeChild(this.previewElement);\n      }\n      this.previewElement = null;\n    }\n    if (this.currentGuide) {\n      this.currentGuide.destroy();\n      this.currentGuide = null;\n    }\n    if (this.currentHighlight) {\n      this.currentHighlight.destroy();\n      this.currentHighlight = null;\n    }\n  }\n  /**\n   * Implements autoscroll, updates the {@link currentPoint}, highlights any drop\n   * targets and updates the preview.\n   */\n  dragOver(graph, evt) {\n    const offset = getOffset(graph.container);\n    const origin = getScrollOrigin(graph.container);\n    let x = getClientX(evt) - offset.x + origin.x - graph.getPanDx();\n    let y = getClientY(evt) - offset.y + origin.y - graph.getPanDy();\n    if (graph.isAutoScroll() && (!this.autoscroll || this.autoscroll)) {\n      graph.scrollPointToVisible(x, y, graph.isAutoExtend());\n    }\n    // Highlights the drop target under the mouse\n    if (this.currentHighlight && graph.isDropEnabled()) {\n      this.currentDropTarget = this.getDropTarget(graph, x, y, evt);\n      if (this.currentDropTarget) {\n        const state = graph.getView().getState(this.currentDropTarget);\n        this.currentHighlight.highlight(state);\n      }\n    }\n    // Updates the location of the preview\n    if (this.previewElement) {\n      if (!this.previewElement.parentNode) {\n        graph.container.appendChild(this.previewElement);\n        this.previewElement.style.zIndex = '3';\n        this.previewElement.style.position = 'absolute';\n      }\n      const gridEnabled = this.isGridEnabled() && graph.isGridEnabledEvent(evt);\n      let hideGuide = true;\n      // Grid and guides\n      if (this.currentGuide && this.currentGuide.isEnabledForEvent(evt)) {\n        // LATER: HTML preview appears smaller than SVG preview\n        const w = parseInt(this.previewElement.style.width);\n        const h = parseInt(this.previewElement.style.height);\n        const bounds = new Rectangle(0, 0, w, h);\n        let delta = new Point(x, y);\n        delta = this.currentGuide.move(bounds, delta, gridEnabled, true);\n        hideGuide = false;\n        x = delta.x;\n        y = delta.y;\n      } else if (gridEnabled) {\n        const {\n          scale\n        } = graph.view;\n        const tr = graph.view.translate;\n        const off = graph.getGridSize() / 2;\n        x = (graph.snap(x / scale - tr.x - off) + tr.x) * scale;\n        y = (graph.snap(y / scale - tr.y - off) + tr.y) * scale;\n      }\n      if (this.currentGuide && hideGuide) {\n        this.currentGuide.hide();\n      }\n      if (this.previewOffset) {\n        x += this.previewOffset.x;\n        y += this.previewOffset.y;\n      }\n      this.previewElement.style.left = \"\".concat(Math.round(x), \"px\");\n      this.previewElement.style.top = \"\".concat(Math.round(y), \"px\");\n      this.previewElement.style.visibility = 'visible';\n    }\n    this.currentPoint = new Point(x, y);\n  }\n  /**\n   * Returns the drop target for the given graph and coordinates. This\n   * implementation uses {@link mxGraph.getCellAt}.\n   */\n  drop(graph, evt) {\n    let dropTarget = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n    let x = arguments.length > 3 ? arguments[3] : undefined;\n    let y = arguments.length > 4 ? arguments[4] : undefined;\n    this.dropHandler(graph, evt, dropTarget, x, y);\n    // Had to move this to after the insert because it will\n    // affect the scrollbars of the window in IE to try and\n    // make the complete container visible.\n    // LATER: Should be made optional.\n    if (graph.container.style.visibility !== 'hidden') {\n      graph.container.focus();\n    }\n  }\n}\nexport default DragSource;","map":{"version":3,"names":["Rectangle","CellHighlight","getDocumentScrollOrigin","getOffset","getScrollOrigin","setOpacity","InternalEvent","Client","Guide","DROP_TARGET_COLOR","Point","getClientX","getClientY","getSource","isConsumed","isMouseEvent","isPenEvent","isTouchEvent","DragSource","constructor","element","dropHandler","dragOffset","dragElement","previewElement","previewOffset","enabled","currentGraph","currentDropTarget","currentPoint","currentGuide","currentHighlight","autoscroll","guidesEnabled","gridEnabled","highlightDropTargets","dragElementZIndex","dragElementOpacity","checkEventSource","mouseMoveHandler","mouseUpHandler","eventSource","addGestureListeners","evt","mouseDown","addListener","consume","eventConsumer","sender","evtName","getProperty","me","MOUSE_DOWN","isEnabled","setEnabled","value","isGuidesEnabled","setGuidesEnabled","isGridEnabled","setGridEnabled","getGraphForEvent","getDropTarget","graph","x","y","getCellAt","createDragElement","cloneNode","createPreviewElement","isActive","reset","dragExit","removeDragElement","removeListeners","stopDrag","startDrag","mouseMove","bind","mouseUp","document","IS_TOUCH","style","position","zIndex","String","IS_SVG","pointerEvents","parentNode","removeChild","getElementForEvent","elementFromPoint","graphContainsEvent","offset","container","origin","elt","offsetWidth","offsetHeight","dragEnter","dragOver","visibility","body","appendChild","left","concat","top","scale","view","tr","translate","drop","removeGestureListeners","isMouseDown","isMouseTrigger","selectionHandler","getPlugin","getGuideStates","FIRE_MOUSE_EVENT","removeListener","destroy","getPanDx","getPanDy","isAutoScroll","scrollPointToVisible","isAutoExtend","isDropEnabled","state","getView","getState","highlight","isGridEnabledEvent","hideGuide","isEnabledForEvent","w","parseInt","width","h","height","bounds","delta","move","off","getGridSize","snap","hide","Math","round","dropTarget","arguments","length","undefined","focus"],"sources":["D:/ospanel/domains/проекты open server/old/react/react-intro-main/node_modules/@maxgraph/core/dist/view/other/DragSource.js"],"sourcesContent":["/*\nCopyright 2021-present The maxGraph project Contributors\nCopyright (c) 2006-2015, JGraph Ltd\nCopyright (c) 2006-2015, Gaudenz Alder\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n    http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n*/\nimport Rectangle from '../geometry/Rectangle';\nimport CellHighlight from '../cell/CellHighlight';\nimport { getDocumentScrollOrigin, getOffset, getScrollOrigin, setOpacity, } from '../../util/styleUtils';\nimport InternalEvent from '../event/InternalEvent';\nimport Client from '../../Client';\nimport Guide from './Guide';\nimport { DROP_TARGET_COLOR } from '../../util/Constants';\nimport Point from '../geometry/Point';\nimport { getClientX, getClientY, getSource, isConsumed, isMouseEvent, isPenEvent, isTouchEvent, } from '../../util/EventUtils';\n/**\n * @class DragSource\n *\n * Wrapper to create a drag source from a DOM element so that the element can\n * be dragged over a graph and dropped into the graph as a new cell.\n *\n * Problem is that in the dropHandler the current preview location is not\n * available, so the preview and the dropHandler must match.\n *\n */\nclass DragSource {\n    constructor(element, dropHandler) {\n        /**\n         * {@link Point} that specifies the offset of the {@link dragElement}. Default is null.\n         */\n        this.dragOffset = null;\n        /**\n         * Holds the DOM node that is used to represent the drag preview. If this is\n         * null then the source element will be cloned and used for the drag preview.\n         */\n        this.dragElement = null;\n        /**\n         * TODO - wrong description\n         * Optional {@link Rectangle} that specifies the unscaled size of the preview.\n         */\n        this.previewElement = null;\n        /**\n         * Optional {@link Point} that specifies the offset of the preview in pixels.\n         */\n        this.previewOffset = null;\n        /**\n         * Specifies if this drag source is enabled. Default is true.\n         */\n        this.enabled = true;\n        /**\n         * Reference to the {@link mxGraph} that is the current drop target.\n         */\n        this.currentGraph = null;\n        /**\n         * Holds the current drop target under the mouse.\n         */\n        this.currentDropTarget = null;\n        /**\n         * Holds the current drop location.\n         */\n        this.currentPoint = null;\n        /**\n         * Holds an {@link mxGuide} for the {@link currentGraph} if {@link dragPreview} is not null.\n         */\n        this.currentGuide = null;\n        /**\n         * Holds an {@link mxGuide} for the {@link currentGraph} if {@link dragPreview} is not null.\n         * @note wrong doc\n         */\n        this.currentHighlight = null;\n        /**\n         * Specifies if the graph should scroll automatically. Default is true.\n         */\n        this.autoscroll = true;\n        /**\n         * Specifies if {@link mxGuide} should be enabled. Default is true.\n         */\n        this.guidesEnabled = true;\n        /**\n         * Specifies if the grid should be allowed. Default is true.\n         */\n        this.gridEnabled = true;\n        /**\n         * Specifies if drop targets should be highlighted. Default is true.\n         */\n        this.highlightDropTargets = true;\n        /**\n         * ZIndex for the drag element. Default is 100.\n         */\n        this.dragElementZIndex = 100;\n        /**\n         * Opacity of the drag element in %. Default is 70.\n         */\n        this.dragElementOpacity = 70;\n        /**\n         * Whether the event source should be checked in {@link graphContainerEvent}. Default\n         * is true.\n         */\n        this.checkEventSource = true;\n        this.mouseMoveHandler = null;\n        this.mouseUpHandler = null;\n        this.eventSource = null;\n        this.element = element;\n        this.dropHandler = dropHandler;\n        // Handles a drag gesture on the element\n        InternalEvent.addGestureListeners(element, (evt) => {\n            this.mouseDown(evt);\n        });\n        // Prevents native drag and drop\n        InternalEvent.addListener(element, 'dragstart', (evt) => {\n            InternalEvent.consume(evt);\n        });\n        this.eventConsumer = (sender, evt) => {\n            const evtName = evt.getProperty('eventName');\n            const me = evt.getProperty('event');\n            if (evtName !== InternalEvent.MOUSE_DOWN) {\n                me.consume();\n            }\n        };\n    }\n    /**\n     * Returns {@link enabled}.\n     */\n    isEnabled() {\n        return this.enabled;\n    }\n    /**\n     * Sets {@link enabled}.\n     */\n    setEnabled(value) {\n        this.enabled = value;\n    }\n    /**\n     * Returns {@link guidesEnabled}.\n     */\n    isGuidesEnabled() {\n        return this.guidesEnabled;\n    }\n    /**\n     * Sets {@link guidesEnabled}.\n     */\n    setGuidesEnabled(value) {\n        this.guidesEnabled = value;\n    }\n    /**\n     * Returns {@link gridEnabled}.\n     */\n    isGridEnabled() {\n        return this.gridEnabled;\n    }\n    /**\n     * Sets {@link gridEnabled}.\n     */\n    setGridEnabled(value) {\n        this.gridEnabled = value;\n    }\n    /**\n     * Returns the graph for the given mouse event. This implementation returns\n     * null.\n     */\n    getGraphForEvent(evt) {\n        return null;\n    }\n    /**\n     * Returns the drop target for the given graph and coordinates. This\n     * implementation uses {@link mxGraph.getCellAt}.\n     */\n    getDropTarget(graph, x, y, evt) {\n        return graph.getCellAt(x, y);\n    }\n    /**\n     * Creates and returns a clone of the {@link dragElementPrototype} or the {@link element}\n     * if the former is not defined.\n     */\n    createDragElement(evt) {\n        return this.element.cloneNode(true);\n    }\n    /**\n     * Creates and returns an element which can be used as a preview in the given\n     * graph.\n     */\n    createPreviewElement(graph) {\n        return null;\n    }\n    /**\n     * Returns true if this drag source is active.\n     */\n    isActive() {\n        return !!this.mouseMoveHandler;\n    }\n    /**\n     * Stops and removes everything and restores the state of the object.\n     */\n    reset() {\n        if (this.currentGraph) {\n            this.dragExit(this.currentGraph);\n            this.currentGraph = null;\n        }\n        this.removeDragElement();\n        this.removeListeners();\n        this.stopDrag();\n    }\n    /**\n     * Returns the drop target for the given graph and coordinates. This\n     * implementation uses {@link mxGraph.getCellAt}.\n     *\n     * To ignore popup menu events for a drag source, this function can be\n     * overridden as follows.\n     *\n     * @example\n     * ```javascript\n     * var mouseDown = dragSource.mouseDown;\n     *\n     * dragSource.mouseDown(evt)\n     * {\n     *   if (!mxEvent.isPopupTrigger(evt))\n     *   {\n     *     mouseDown.apply(this, arguments);\n     *   }\n     * };\n     * ```\n     */\n    mouseDown(evt) {\n        if (this.enabled && !isConsumed(evt) && this.mouseMoveHandler == null) {\n            this.startDrag(evt);\n            this.mouseMoveHandler = this.mouseMove.bind(this);\n            this.mouseUpHandler = this.mouseUp.bind(this);\n            InternalEvent.addGestureListeners(document, null, this.mouseMoveHandler, this.mouseUpHandler);\n            if (Client.IS_TOUCH && !isMouseEvent(evt)) {\n                this.eventSource = getSource(evt);\n                if (this.eventSource) {\n                    InternalEvent.addGestureListeners(this.eventSource, null, this.mouseMoveHandler, this.mouseUpHandler);\n                }\n            }\n        }\n    }\n    /**\n     * Creates the {@link dragElement} using {@link createDragElement}.\n     */\n    startDrag(evt) {\n        this.dragElement = this.createDragElement(evt);\n        this.dragElement.style.position = 'absolute';\n        this.dragElement.style.zIndex = String(this.dragElementZIndex);\n        setOpacity(this.dragElement, this.dragElementOpacity);\n        if (this.checkEventSource && Client.IS_SVG) {\n            this.dragElement.style.pointerEvents = 'none';\n        }\n    }\n    /**\n     * Invokes {@link removeDragElement}.\n     */\n    stopDrag() {\n        // LATER: This used to have a mouse event. If that is still needed we need to add another\n        // final call to the DnD protocol to add a cleanup step in the case of escape press, which\n        // is not associated with a mouse event and which currently calles this method.\n        this.removeDragElement();\n    }\n    /**\n     * Removes and destroys the {@link dragElement}.\n     */\n    removeDragElement() {\n        if (this.dragElement) {\n            if (this.dragElement.parentNode) {\n                this.dragElement.parentNode.removeChild(this.dragElement);\n            }\n            this.dragElement = null;\n        }\n    }\n    /**\n     * Returns the topmost element under the given event.\n     */\n    getElementForEvent(evt) {\n        return isTouchEvent(evt) || isPenEvent(evt)\n            ? document.elementFromPoint(getClientX(evt), getClientY(evt))\n            : getSource(evt);\n    }\n    /**\n     * Returns true if the given graph contains the given event.\n     */\n    graphContainsEvent(graph, evt) {\n        const x = getClientX(evt);\n        const y = getClientY(evt);\n        const offset = getOffset(graph.container);\n        const origin = getScrollOrigin();\n        let elt = this.getElementForEvent(evt);\n        if (this.checkEventSource) {\n            while (elt && elt !== graph.container) {\n                // @ts-ignore parentNode may exist\n                elt = elt.parentNode;\n            }\n        }\n        // Checks if event is inside the bounds of the graph container\n        return (!!elt &&\n            x >= offset.x - origin.x &&\n            y >= offset.y - origin.y &&\n            x <= offset.x - origin.x + graph.container.offsetWidth &&\n            y <= offset.y - origin.y + graph.container.offsetHeight);\n    }\n    /**\n     * Gets the graph for the given event using {@link getGraphForEvent}, updates the\n     * {@link currentGraph}, calling {@link dragEnter} and {@link dragExit} on the new and old graph,\n     * respectively, and invokes {@link dragOver} if {@link currentGraph} is not null.\n     */\n    mouseMove(evt) {\n        let graph = this.getGraphForEvent(evt);\n        // Checks if event is inside the bounds of the graph container\n        if (graph && !this.graphContainsEvent(graph, evt)) {\n            graph = null;\n        }\n        if (graph !== this.currentGraph) {\n            if (this.currentGraph) {\n                this.dragExit(this.currentGraph, evt);\n            }\n            this.currentGraph = graph;\n            if (this.currentGraph) {\n                this.dragEnter(this.currentGraph, evt);\n            }\n        }\n        if (this.currentGraph) {\n            this.dragOver(this.currentGraph, evt);\n        }\n        if (this.dragElement &&\n            (!this.previewElement || this.previewElement.style.visibility !== 'visible')) {\n            let x = getClientX(evt);\n            let y = getClientY(evt);\n            if (this.dragElement.parentNode == null) {\n                document.body.appendChild(this.dragElement);\n            }\n            this.dragElement.style.visibility = 'visible';\n            if (this.dragOffset) {\n                x += this.dragOffset.x;\n                y += this.dragOffset.y;\n            }\n            const offset = getDocumentScrollOrigin(document);\n            this.dragElement.style.left = `${x + offset.x}px`;\n            this.dragElement.style.top = `${y + offset.y}px`;\n        }\n        else if (this.dragElement) {\n            this.dragElement.style.visibility = 'hidden';\n        }\n        InternalEvent.consume(evt);\n    }\n    /**\n     * Processes the mouse up event and invokes {@link drop}, {@link dragExit} and {@link stopDrag}\n     * as required.\n     */\n    mouseUp(evt) {\n        if (this.currentGraph) {\n            if (this.currentPoint &&\n                (!this.previewElement || this.previewElement.style.visibility !== 'hidden')) {\n                const { scale } = this.currentGraph.view;\n                const tr = this.currentGraph.view.translate;\n                const x = this.currentPoint.x / scale - tr.x;\n                const y = this.currentPoint.y / scale - tr.y;\n                this.drop(this.currentGraph, evt, this.currentDropTarget, x, y);\n            }\n            this.dragExit(this.currentGraph);\n            this.currentGraph = null;\n        }\n        this.stopDrag();\n        this.removeListeners();\n        InternalEvent.consume(evt);\n    }\n    /**\n     * Actives the given graph as a drop target.\n     */\n    // removeListeners(): void;\n    removeListeners() {\n        if (this.eventSource) {\n            InternalEvent.removeGestureListeners(this.eventSource, null, this.mouseMoveHandler, this.mouseUpHandler);\n            this.eventSource = null;\n        }\n        InternalEvent.removeGestureListeners(document, null, this.mouseMoveHandler, this.mouseUpHandler);\n        this.mouseMoveHandler = null;\n        this.mouseUpHandler = null;\n    }\n    /**\n     * Actives the given graph as a drop target.\n     */\n    dragEnter(graph, evt) {\n        graph.isMouseDown = true;\n        graph.isMouseTrigger = isMouseEvent(evt);\n        this.previewElement = this.createPreviewElement(graph);\n        if (this.previewElement && this.checkEventSource && Client.IS_SVG) {\n            this.previewElement.style.pointerEvents = 'none';\n        }\n        // Guide is only needed if preview element is used\n        if (this.isGuidesEnabled() && this.previewElement) {\n            const selectionHandler = graph.getPlugin('SelectionHandler');\n            this.currentGuide = new Guide(graph, selectionHandler?.getGuideStates());\n        }\n        if (this.highlightDropTargets) {\n            this.currentHighlight = new CellHighlight(graph, DROP_TARGET_COLOR);\n        }\n        // Consumes all events in the current graph before they are fired\n        graph.addListener(InternalEvent.FIRE_MOUSE_EVENT, this.eventConsumer);\n    }\n    /**\n     * Deactivates the given graph as a drop target.\n     */\n    dragExit(graph, evt) {\n        this.currentDropTarget = null;\n        this.currentPoint = null;\n        graph.isMouseDown = false;\n        // Consumes all events in the current graph before they are fired\n        graph.removeListener(this.eventConsumer);\n        if (this.previewElement) {\n            if (this.previewElement.parentNode) {\n                this.previewElement.parentNode.removeChild(this.previewElement);\n            }\n            this.previewElement = null;\n        }\n        if (this.currentGuide) {\n            this.currentGuide.destroy();\n            this.currentGuide = null;\n        }\n        if (this.currentHighlight) {\n            this.currentHighlight.destroy();\n            this.currentHighlight = null;\n        }\n    }\n    /**\n     * Implements autoscroll, updates the {@link currentPoint}, highlights any drop\n     * targets and updates the preview.\n     */\n    dragOver(graph, evt) {\n        const offset = getOffset(graph.container);\n        const origin = getScrollOrigin(graph.container);\n        let x = getClientX(evt) - offset.x + origin.x - graph.getPanDx();\n        let y = getClientY(evt) - offset.y + origin.y - graph.getPanDy();\n        if (graph.isAutoScroll() && (!this.autoscroll || this.autoscroll)) {\n            graph.scrollPointToVisible(x, y, graph.isAutoExtend());\n        }\n        // Highlights the drop target under the mouse\n        if (this.currentHighlight && graph.isDropEnabled()) {\n            this.currentDropTarget = this.getDropTarget(graph, x, y, evt);\n            if (this.currentDropTarget) {\n                const state = graph.getView().getState(this.currentDropTarget);\n                this.currentHighlight.highlight(state);\n            }\n        }\n        // Updates the location of the preview\n        if (this.previewElement) {\n            if (!this.previewElement.parentNode) {\n                graph.container.appendChild(this.previewElement);\n                this.previewElement.style.zIndex = '3';\n                this.previewElement.style.position = 'absolute';\n            }\n            const gridEnabled = this.isGridEnabled() && graph.isGridEnabledEvent(evt);\n            let hideGuide = true;\n            // Grid and guides\n            if (this.currentGuide && this.currentGuide.isEnabledForEvent(evt)) {\n                // LATER: HTML preview appears smaller than SVG preview\n                const w = parseInt(this.previewElement.style.width);\n                const h = parseInt(this.previewElement.style.height);\n                const bounds = new Rectangle(0, 0, w, h);\n                let delta = new Point(x, y);\n                delta = this.currentGuide.move(bounds, delta, gridEnabled, true);\n                hideGuide = false;\n                x = delta.x;\n                y = delta.y;\n            }\n            else if (gridEnabled) {\n                const { scale } = graph.view;\n                const tr = graph.view.translate;\n                const off = graph.getGridSize() / 2;\n                x = (graph.snap(x / scale - tr.x - off) + tr.x) * scale;\n                y = (graph.snap(y / scale - tr.y - off) + tr.y) * scale;\n            }\n            if (this.currentGuide && hideGuide) {\n                this.currentGuide.hide();\n            }\n            if (this.previewOffset) {\n                x += this.previewOffset.x;\n                y += this.previewOffset.y;\n            }\n            this.previewElement.style.left = `${Math.round(x)}px`;\n            this.previewElement.style.top = `${Math.round(y)}px`;\n            this.previewElement.style.visibility = 'visible';\n        }\n        this.currentPoint = new Point(x, y);\n    }\n    /**\n     * Returns the drop target for the given graph and coordinates. This\n     * implementation uses {@link mxGraph.getCellAt}.\n     */\n    drop(graph, evt, dropTarget = null, x, y) {\n        this.dropHandler(graph, evt, dropTarget, x, y);\n        // Had to move this to after the insert because it will\n        // affect the scrollbars of the window in IE to try and\n        // make the complete container visible.\n        // LATER: Should be made optional.\n        if (graph.container.style.visibility !== 'hidden') {\n            graph.container.focus();\n        }\n    }\n}\nexport default DragSource;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}